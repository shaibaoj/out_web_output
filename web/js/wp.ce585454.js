(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["wp"],{f923:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1,title:"公众号管理"}},[a("div",{staticClass:"table-page-search-wrapper"},[e.page.auth<0?[a("div",{staticClass:"login"},[a("p",[a("a",{staticClass:"btn",attrs:{target:"_blank",href:e.authUrl},on:{click:e.open_taoke}},[e._v("授权公众号")])]),a("p",[e._v("授权公众号之前，请先前往微信公众号平台创建好公众号,"),a("a",{attrs:{href:"https://mp.weixin.qq.com/",target:"_blank"}},[e._v("》》微信公众号平台")])])])]:e._e(),e.page.auth>0?a("a-form",[a("a-form-item",{attrs:{label:"授权时间:",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("span",{staticClass:"expire"},[e._v(e._s(e.page.user_wp.auth_date))]),a("p",[a("a-button",{attrs:{type:"primary",target:"_blank",href:e.authUrl},on:{click:e.open_taoke}},[e._v("重新授权")]),e._v("\n          (如误删公众号授权，请重新授权)\n        ")],1)]),a("a-form-item",{attrs:{label:"公众号:",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("span",{staticClass:"expire"},[e._v(e._s(e.page.user_wp.nick_name))])]),a("a-form-item",{attrs:{label:"user_name:",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("span",{staticClass:"expire"},[e._v(e._s(e.page.user_wp.user_name))])]),a("a-form-item",{attrs:{label:"appid:",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("span",{staticClass:"expire"},[e._v(e._s(e.page.user_wp.authorizer_appid))])]),a("a-form-item",{attrs:{label:"头像:",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("div",{staticStyle:{padding:"20px 0"}},[a("div",{staticClass:"app-icon"},[a("img",{staticStyle:{"max-width":"100px"},attrs:{src:e.page.user_wp.head_img}})])])]),a("a-form-item",{attrs:{label:"帐号类型:",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("span",{staticClass:"expire"},[e._v(e._s(e.service_type_info_name))])]),a("a-form-item",{attrs:{label:"主体:",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("span",{staticClass:"expire"},[e._v(e._s(e.page.user_wp.principal_name))])])],1):e._e()],2),a("a-modal",{attrs:{title:"授权",visible:e.page.modal.auth},on:{cancel:e.handleAuthCancel}},[a("div",{staticStyle:{"text-align":"center"}},[a("p",[e._v("确认已经完成授权")])]),a("template",{slot:"footer"},[a("a-button",{attrs:{type:"primary",block:""},on:{click:e.handleAUth}},[e._v("刷新")])],1)],2)],1)},r=[],s=a("c32d"),o=a.n(s),n=a("2af9"),p=a("b775"),l={getBroadcasting:"/api/user/broadcasting/sends",getView:"/api/user/wp/view",authorize:"/api/user/wp/authorize"};function u(e){return Object(p["b"])({baseURL:"https://weapi.youdanhui.com",url:l.authorize,method:"post",data:e})}function c(e){return Object(p["b"])({baseURL:"https://weapi.youdanhui.com",url:l.getBroadcasting,method:"post",data:e})}function h(e){return Object(p["b"])({baseURL:"https://weapi.youdanhui.com",url:l.getView,method:"post",data:e})}var _=n["c"].Item,d={name:"Page",components:{DescriptionList:n["c"],DescriptionListItem:_,STable:n["o"],Ellipsis:n["f"]},computed:{authUrl:function(){return"https://weapi.youdanhui.com/api/open/auth/redirect?url="+this.httpUrl+"/user/wp/dashboard"},httpUrl:function(){return window.location.protocol+"//"+window.location.host},service_type_info_name:function(){if(this.page.user_wp.service_type_info){if("0"===this.page.user_wp.service_type_info)return"订阅号";if("1"===this.page.user_wp.service_type_info)return"老订阅号";if("2"===this.page.user_wp.service_type_info)return"服务号"}return""}},data:function(){return{labelCol:{xs:{span:24},sm:{span:2}},wrapperCol:{xs:{span:24},sm:{span:22}},form:this.$form.createForm(this),page:{user_wp:{},modal:{auth:!1},weixin:{auth_code:"",expires_in:"",authorize:!1},auth:0}}},created:function(){this.$route.query.auth_code&&(this.page.weixin.auth_code=this.$route.query.auth_code,this.page.weixin.authorize=!0),this.$route.query.expires_in&&(this.page.weixin.expires_in=this.$route.query.expires_in),this.init()},methods:{init:function(){this.query(),this.page.weixin.authorize&&this.authorizeSubmit()},query:function(){var e=this;h({}).then((function(t){t.data.item?(e.page.user_wp=t.data.item,e.page.auth=1):e.page.auth=-1,t.info.status_err&&e.$message.success(t.info.status_err)})),this.queryBroadcasting()},queryBroadcasting:function(){c({}).then((function(e){}))},authorizeSubmit:function(){var e=this;u({auth_code:this.page.weixin.auth_code,expires_in:this.page.weixin.expires_in}).then((function(t){t.data.item?(e.page.user_wp=t.data.item,e.page.modal.auth=!0):e.$message.success(t.info.status_err)}))},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},toggleAdvanced:function(){this.advanced=!this.advanced},resetSearchForm:function(){this.queryParam={date:o()(new Date)}},open_taoke:function(){this.page.modal.auth=!0},handleAuthCancel:function(){this.page.modal.auth=!1},handleAUth:function(){this.page.modal.auth=!1,this.query()}}},m=d,w=a("2877"),f=Object(w["a"])(m,i,r,!1,null,null,null);t["default"]=f.exports}}]);