(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["weapp"],{6567:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1,title:"小程序授权"}},[a("div",{staticClass:"table-page-search-wrapper"},[e.page.auth<0?[a("div",{staticClass:"login"},[a("p",[a("a",{staticClass:"btn",attrs:{target:"_blank",href:e.authUrl},on:{click:e.open_taoke}},[e._v("授权小程序")])]),a("p",[e._v("授权小程序之前，请先前往微信公众号平台创建好小程序,"),a("a",{attrs:{href:"https://mp.weixin.qq.com/",target:"_blank"}},[e._v("》》微信公众号平台")])])])]:e._e(),e.page.auth>0?a("a-form",[a("a-form-item",{attrs:{label:"授权时间:",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("span",{staticClass:"expire"},[e._v(e._s(e.page.user_wp.auth_date))]),a("p",[a("a-button",{attrs:{type:"primary",target:"_blank",href:e.authUrl},on:{click:e.open_taoke}},[e._v("重新授权")]),e._v("\n          (如误删小程序授权，请重新授权)\n        ")],1)]),a("a-form-item",{attrs:{label:"小程序:",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("span",{staticClass:"expire"},[e._v(e._s(e.page.user_wp.nick_name))])]),a("a-form-item",{attrs:{label:"user_name:",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("span",{staticClass:"expire"},[e._v(e._s(e.page.user_wp.user_name))])]),a("a-form-item",{attrs:{label:"appid:",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("span",{staticClass:"expire"},[e._v(e._s(e.page.user_wp.authorizer_appid))])]),a("a-form-item",{attrs:{label:"头像:",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("div",{staticStyle:{padding:"20px 0"}},[a("div",{staticClass:"app-icon"},[a("img",{staticStyle:{"max-width":"100px"},attrs:{src:e.page.user_wp.head_img}})])])]),a("a-form-item",{attrs:{label:"帐号类型:",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("span",{staticClass:"expire"},[e._v(e._s(e.service_type_info_name))])]),a("a-form-item",{attrs:{label:"主体:",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("span",{staticClass:"expire"},[e._v(e._s(e.page.user_wp.principal_name))])])],1):e._e()],2),a("a-modal",{attrs:{title:"授权",visible:e.page.modal.auth},on:{cancel:e.handleAuthCancel}},[a("div",{staticStyle:{"text-align":"center"}},[a("p",[e._v("确认已经完成授权")])]),a("template",{slot:"footer"},[a("a-button",{attrs:{type:"primary",block:""},on:{click:e.handleAUth}},[e._v("刷新")])],1)],2)],1)},n=[],i=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),s=a("c32d"),o=a.n(s),l=a("2af9"),p=a("8a2b"),u=a("5880");function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var h=l["c"].Item,m={name:"Page",components:{DescriptionList:l["c"],DescriptionListItem:h,STable:l["o"],Ellipsis:l["f"]},computed:d({},Object(u["mapGetters"])(["funWeapp"]),{authUrl:function(){return"https://weapi.youdanhui.com/api/open/auth/redirect?auth_type=2&url="+this.httpUrl+"/user/weapp/dashboard"},httpUrl:function(){return window.location.protocol+"//"+window.location.host},service_type_info_name:function(){if(this.page.user_wp.service_type_info){if("0"===this.page.user_wp.service_type_info)return"订阅号";if("1"===this.page.user_wp.service_type_info)return"老订阅号";if("2"===this.page.user_wp.service_type_info)return"服务号"}return""}}),data:function(){return{labelCol:{xs:{span:24},sm:{span:2}},wrapperCol:{xs:{span:24},sm:{span:22}},form:this.$form.createForm(this),page:{user_wp:{},modal:{auth:!1},weixin:{auth_code:"",expires_in:"",authorize:!1},auth:0}}},created:function(){1!==this.funWeapp&&this.$router.push({name:"vipWeapp"}),this.$route.query.auth_code&&(this.page.weixin.auth_code=this.$route.query.auth_code,this.page.weixin.authorize=!0),this.$route.query.expires_in&&(this.page.weixin.expires_in=this.$route.query.expires_in),this.init()},methods:{init:function(){this.query(),this.page.weixin.authorize&&this.authorizeSubmit()},query:function(){var e=this;Object(p["d"])({}).then((function(t){t.data.item?(e.page.user_wp=t.data.item,e.page.auth=1):e.page.auth=-1,t.info.status_err&&e.$message.success(t.info.status_err)}))},authorizeSubmit:function(){var e=this;Object(p["a"])({auth_code:this.page.weixin.auth_code,expires_in:this.page.weixin.expires_in}).then((function(t){t.data.item?(e.page.user_wp=t.data.item,e.page.modal.auth=!0):e.$message.success(t.info.status_err)}))},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},toggleAdvanced:function(){this.advanced=!this.advanced},resetSearchForm:function(){this.queryParam={date:o()(new Date)}},open_taoke:function(){this.page.modal.auth=!0},handleAuthCancel:function(){this.page.modal.auth=!1},handleAUth:function(){this.page.modal.auth=!1,this.query()}}},f=m,_=a("2877"),g=Object(_["a"])(f,r,n,!1,null,null,null);t["default"]=g.exports},"88bc":function(e,t,a){(function(t){var a=1/0,r=9007199254740991,n="[object Arguments]",i="[object Function]",s="[object GeneratorFunction]",o="[object Symbol]",l="object"==typeof t&&t&&t.Object===Object&&t,p="object"==typeof self&&self&&self.Object===Object&&self,u=l||p||Function("return this")();function c(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}function d(e,t){var a=-1,r=e?e.length:0,n=Array(r);while(++a<r)n[a]=t(e[a],a,e);return n}function h(e,t){var a=-1,r=t.length,n=e.length;while(++a<r)e[n+a]=t[a];return e}var m=Object.prototype,f=m.hasOwnProperty,_=m.toString,g=u.Symbol,b=m.propertyIsEnumerable,w=g?g.isConcatSpreadable:void 0,v=Math.max;function y(e,t,a,r,n){var i=-1,s=e.length;a||(a=x),n||(n=[]);while(++i<s){var o=e[i];t>0&&a(o)?t>1?y(o,t-1,a,r,n):h(n,o):r||(n[n.length]=o)}return n}function C(e,t){return e=Object(e),O(e,t,(function(t,a){return a in e}))}function O(e,t,a){var r=-1,n=t.length,i={};while(++r<n){var s=t[r],o=e[s];a(o,s)&&(i[s]=o)}return i}function j(e,t){return t=v(void 0===t?e.length-1:t,0),function(){var a=arguments,r=-1,n=v(a.length-t,0),i=Array(n);while(++r<n)i[r]=a[t+r];r=-1;var s=Array(t+1);while(++r<t)s[r]=a[r];return s[t]=i,c(e,this,s)}}function x(e){return L(e)||S(e)||!!(w&&e&&e[w])}function k(e){if("string"==typeof e||A(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}function S(e){return q(e)&&f.call(e,"callee")&&(!b.call(e,"callee")||_.call(e)==n)}var L=Array.isArray;function P(e){return null!=e&&$(e.length)&&!U(e)}function q(e){return R(e)&&P(e)}function U(e){var t=I(e)?_.call(e):"";return t==i||t==s}function $(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}function I(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function R(e){return!!e&&"object"==typeof e}function A(e){return"symbol"==typeof e||R(e)&&_.call(e)==o}var D=j((function(e,t){return null==e?{}:C(e,d(y(t,1),k))}));e.exports=D}).call(this,a("c8ba"))},"8a2b":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return s})),a.d(t,"e",(function(){return o})),a.d(t,"d",(function(){return l})),a.d(t,"b",(function(){return p}));var r=a("b775"),n={getItems:"/api/user/weapp/template/list",getView:"/api/user/weapp/view",getData:"/api/user/weapp/template/data",selectUpdate:"/api/user/weapp/template/select",getRelease:"/api/user/weapp/template/release",authorize:"/api/user/weapp/authorize"};function i(e){return Object(r["b"])({baseURL:"https://weapi.youdanhui.com",url:n.authorize,method:"post",data:e})}function s(e){return Object(r["b"])({baseURL:"https://weapi.youdanhui.com",url:n.getRelease,method:"post",data:e})}function o(e){return Object(r["b"])({baseURL:"https://weapi.youdanhui.com",url:n.selectUpdate,method:"post",data:e})}function l(e){return Object(r["b"])({baseURL:"https://weapi.youdanhui.com",url:n.getView,method:"post",data:e})}function p(e){return Object(r["b"])({baseURL:"https://weapi.youdanhui.com",url:n.getItems,method:"post",data:e})}},d052:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1,title:"模版设置"}},[a("s-table",{ref:"table",attrs:{size:"default",rowKey:function(e){return e.template_id},columns:e.columns,data:e.loadData,showPagination:"auto",bordered:""},scopedSlots:e._u([{key:"goodslink",fn:function(t,r){return[a("a",{attrs:{target:"_blank",href:"https://detail.tmall.com/item.htm?id="+r.num_iid}},[e._v(e._s(t))])]}},{key:"money",fn:function(t,r){return[a("a",{attrs:{target:"_blank",href:"https://uland.taobao.com/quan/detail?sellerId="+r.user_num_id+"&activityId="+r.activity_id}},[e._v("查看")])]}},{key:"price",fn:function(t,r){return[a("a",{attrs:{target:"_blank",href:"https://www.haopintui.net/?coupon=1&q="+encodeURIComponent("https://detail.tmall.com/item.htm?id="+r.num_iid)}},[e._v(e._s(t))])]}},{key:"image",fn:function(e,t){return[a("a",{attrs:{target:"_blank",href:"https://detail.tmall.com/item.htm?id="+t.num_iid}},[a("img",{staticStyle:{"max-width":"80px"},attrs:{src:t.pic_url}})])]}},{key:"status",fn:function(t){return a("span",{},[a("a-badge",{attrs:{status:e._f("statusTypeFilter")(t),text:e._f("statusFilter")(t)}})],1)}},{key:"income",fn:function(t){return a("span",{},[a("ellipsis",{attrs:{length:4,tooltip:""}},[e._v(e._s(t))])],1)}},{key:"action",fn:function(t,r){return a("span",{},[[a("a",{on:{click:function(t){return e.handleSelect(r)}}},[e._v("选择")])]],2)}}])}),a("a-modal",{attrs:{title:"确认是否选择该版本",visible:e.page.modal.visible,confirmLoading:e.page.modal.confirmLoading},on:{ok:e.handleSelectOk,cancel:e.handleSelectCancel}},[a("p",[e._v(e._s(e.page.modal.template.user_version)+" "+e._s(e.page.modal.template.user_desc))])]),a("a-modal",{attrs:{title:"提醒",visible:e.page.modal.error,confirmLoading:e.page.modal.confirmLoading},on:{cancel:e.handleErrCancel}},[a("div",{staticStyle:{"text-align":"center"}},[a("p",[e._v(e._s(e.page.submit.error))]),a("a",{staticClass:"btn",attrs:{target:"_blank",href:"https://mp.weixin.qq.com/cgi-bin/loginpage?t=wxm2-login&lang=zh_CN"}},[e._v("前往微信公众号完全配置")])]),a("template",{slot:"footer"},[a("a-button",{attrs:{type:"primary",block:""},on:{click:e.handleErrCancel}},[e._v("关闭")])],1)],2),a("a-modal",{attrs:{title:"操作结果",visible:e.page.modal.status,confirmLoading:e.page.modal.confirmLoading,width:800},on:{cancel:e.handleStatusCancel}},[a("a-steps",{attrs:{size:"small",current:e.showStatusStep,direction:"vertical"}},[a("a-step",{attrs:{title:"模板提交",content:"选择模板提交审核"}}),a("a-step",{attrs:{title:e.showStatusTitle,content:"待微信审核通过，即可发布上线"}},[e._v(e._s(e.showStatusMsg))]),a("a-step",{attrs:{title:"审核通过",content:"审核通过的模板，立即发布"}},[1==e.page.api_weapp_user.status?a("Button",{attrs:{type:"primary",size:"small"},on:{click:e.btnPublish}},[e._v("立即模板上线")]):e._e()],1)],1),a("template",{slot:"footer"},[a("p",[e._v("最近提交审核记录")]),a("a-table",{ref:"tableLog",attrs:{size:"default",rowKey:function(e){return e.id},columns:e.columnsLog,dataSource:e.dataLog,bordered:""},scopedSlots:e._u([{key:"action",fn:function(t,r){return a("span",{},[[a("a",{on:{click:function(t){return e.handleSelect(r)}}},[e._v("选择")])]],2)}}])})],1)],2),a("template-modal",{ref:"modal",on:{ok:e.query}})],1)},n=[],i=a("c32d"),s=a.n(i),o=a("2af9"),l=a("8a2b"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"充值",width:388,visible:e.visible,confirmLoading:e.confirmLoading},on:{cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-form",{attrs:{form:e.form}},[a("div",[a("a-form-item",{attrs:{label:"金额",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["pay_money",{initialValue:100,rules:[{required:!1,message:"不能为空"}]}],expression:"['pay_money', {initialValue: 100,rules: [{required: false, message: '不能为空'}]}]"}],on:{change:e.changeMoney}},[a("span",{attrs:{slot:"addonAfter"},slot:"addonAfter"},[e._v("充值金额")])])],1)],1)])],1),a("template",{slot:"footer"},[a("a-button",{attrs:{type:"primary",target:"_blank",href:e.payUrl,block:""},on:{click:function(t){return e.handleSubmit()}}},[e._v("购买")])],1)],2)},u=[],c=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),d=a("88bc"),h=a.n(d),m=a("5880");function f(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?f(Object(a),!0).forEach((function(t){Object(c["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var g={name:"EditModal",components:{},computed:_({},Object(m["mapGetters"])(["token"]),{payUrl:function(){return"https://www.haopintui.net/pay/pay_html?money="+this.page.pay_money+"&member_token="+this.token}}),data:function(){return{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}},visible:!1,confirmLoading:!1,mdl:{},form:this.$form.createForm(this),content:"",page:{pay_money:0}}},methods:{edit:function(e){var t=this;this.visible=!0;var a=this.form.setFieldsValue;this.$nextTick((function(){e.id?a(h()(e,[])):t.form.resetFields()}))},handleSubmit:function(){var e=this,t=this.form.validateFields;this.confirmLoading=!0,t((function(t,a){t?e.confirmLoading=!1:(e.confirmLoading=!1,e.$emit("ok",a),e.visible=!1)}))},handleCancel:function(){this.visible=!1},changeMoney:function(e){var t=e.target.value;this.page.pay_money=t}}},b=g,w=a("2877"),v=Object(w["a"])(b,p,u,!1,null,null,null),y=v.exports,C={name:"Page",components:{STable:o["o"],TemplateModal:y,Ellipsis:o["f"]},computed:{templateStatus:function(){return-2===this.page.api_weapp_user.status?"未提交":-1===this.page.api_weapp_user.status?"拒绝":0===this.page.api_weapp_user.status?"审核中":1===this.page.api_weapp_user.status?"模板审核通过":2===this.page.api_weapp_user.status?"发布成功":""},showStatusStep:function(){if(this.page.api_weapp_user.id){if(1===this.page.api_weapp_user.status||2===this.page.api_weapp_user.status)return 2;if(0===this.page.api_weapp_user.status||-1===this.page.api_weapp_user.status)return 1}return 0},showStatusMsg:function(){return this.page.api_weapp_user.id&&this.page.api_weapp_user.status_reason&&-1===this.page.api_weapp_user.status?this.page.api_weapp_user.status_reason:"待微信审核通过，即可发布上线"},showStatusTitle:function(){if(this.page.api_weapp_user.id){if(-1===this.page.api_weapp_user.status)return"审核拒绝";if(0===this.page.api_weapp_user.status)return"审核中";if(1===this.page.api_weapp_user.status)return"模板审核通过"}return"等待审核"}},data:function(){var e=this;return{mdl:{},advanced:!1,queryParam:{},columns:[{title:"编号",width:"100",dataIndex:"template_id"},{title:"版本",width:"100",dataIndex:"user_version"},{title:"备注",dataIndex:"user_desc"},{title:"操作",dataIndex:"action",width:"120px",align:"center",scopedSlots:{customRender:"action"}}],loadData:function(t){return Object(l["b"])(Object.assign(t,e.queryParam)).then((function(t){return t.data.api_weapp_user&&t.data.api_weapp_user.id&&(t.data.api_weapp_user.status>-2&&(e.page.modal.status=!0),e.page.api_weapp_user=t.data.api_weapp_user),t.data.logs&&(e.dataLog=t.data.logs),{items:t.data.items.template_list.reverse(),pager:{ipage:1,count:20}}}))},columnsLog:[{title:"时间",dataIndex:"create_date",align:"center",width:200},{title:"模板编号",dataIndex:"template_id",align:"center",width:100},{title:"状态",dataIndex:"",align:"center",width:120,customRender:function(e,t){return 0===t.status?"审核中":-1===t.status?"拒绝":"审核通过"}},{title:"备注",dataIndex:"user_desc"}],dataLog:[],selectedRowKeys:[],selectedRows:[],optionAlertShow:!1,page:{modal:{template:{},ModalText:"",visible:!1,confirmLoading:!1,error:!1,status:!1},submit:{error:""},api_weapp_user:{}}}},created:function(){},methods:{handleSelect:function(e){this.page.modal.visible=!0,this.page.modal.template=e},query:function(){this.$refs.table.refresh(!0)},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},toggleAdvanced:function(){this.advanced=!this.advanced},resetSearchForm:function(){this.queryParam={date:s()(new Date)}},handleSelectOk:function(e){var t=this;this.page.modal.confirmLoading=!0,Object(l["e"])({template_id:this.page.modal.template.template_id,user_version:this.page.modal.template.user_version,user_desc:this.page.modal.template.user_desc}).then((function(e){t.page.modal.confirmLoading=!1,t.page.modal.visible=!1,e.info.status>0?(t.page.submit.error=e.info.status_err,t.page.modal.error=!0):t.$message.success(e.info.status_err),t.query()}))},handleSelectCancel:function(e){this.page.modal.visible=!1},handleErrCancel:function(){this.page.modal.error=!1},btnPublish:function(){var e=this;Object(l["c"])({}).then((function(t){e.page.modal.confirmLoading=!1,e.page.modal.visible=!1,t.info.status>0?(e.page.submit.error=t.info.status_err,e.page.modal.error=!0):e.$message.success(t.info.status_err),e.query()}))},handleStatusCancel:function(){this.page.modal.status=!1}}},O=C,j=Object(w["a"])(O,r,n,!1,null,null,null);t["default"]=j.exports}}]);