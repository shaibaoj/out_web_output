import{Z as H,r as C,h as R,j as $,l as x,a as c,b as P,w as v,q as h,e as f,m as t,c as d,F as j,K as T,n as i,M as V,s as z,v as G,_ as I,G as M,aB as N,u as B,C as S,H as K,p as Z}from"./index.53559b39.js";import{C as J}from"./confirm.20ab318d.js";const E=H(),A={getView:"/api/user/open/miniprogram/view",list:"/api/user/open/miniprogram/list",templateList:"/api/user/open/template/list",logsList:"/api/user/open/template/logs",selectUpdate:"/api/user/open/template/select",getRelease:"/api/user/open/template/release"};function Q(l){return C({baseURL:E.miniProgramUrl,url:A.list,method:"post",data:l})}function W(l){return C({baseURL:E.miniProgramUrl,url:A.getRelease,method:"post",data:l})}function X(l){return C({baseURL:E.miniProgramUrl,url:A.selectUpdate,method:"post",data:l})}function Y(l){return C({baseURL:E.miniProgramUrl,url:A.getView,method:"post",data:l})}function tt(l){return C({baseURL:E.miniProgramUrl,url:A.templateList,method:"post",data:l})}function et(l){return C({baseURL:E.miniProgramUrl,url:A.logsList,method:"post",data:l})}const st={class:"col-span-12 overflow-auto intro-y lg:overflow-visible"},at={class:"table -mt-2 table-report"},it=t("thead",null,[t("tr",null,[t("th",{class:"whitespace-nowrap"},"\u6A21\u677F\u7F16\u53F7"),t("th",{class:"text-center whitespace-nowrap"},"\u7248\u672C"),t("th",{class:"whitespace-nowrap"},"\u5907\u6CE8"),t("th",{class:"text-center whitespace-nowrap"})])],-1),ot={class:"w-20 text-center"},nt={class:"text-center"},rt={class:""},ut={class:"w-20"},lt={class:"flex items-center justify-center"},ct=["onClick"],mt=R({__name:"template",emits:["ok","submit"],setup(l,{expose:s,emit:F}){const e=$({visible:!1,confirmLoading:!1,name:"",items:[]}),n=$({authorizer_appid:"",platform_type:0}),g=()=>{e.confirmLoading=!0,tt({authorizer_appid:n.authorizer_appid,platform_type:n.platform_type}).then(u=>{e.confirmLoading=!1,u.data.items&&G(()=>{e.items=u.data.items})})},D=()=>{e.visible=!1},_=u=>{e.visible=!0,n.platform_type=u.platform_type,n.authorizer_appid=u.authorizer_appid,e.name=u.nick,g()},w=u=>{e.confirmLoading=!0,X({platform_type:n.platform_type,authorizer_appid:n.authorizer_appid,template_id:u.template_id,user_version:u.user_version,user_desc:u.user_desc}).then(a=>{const{code:m}=a||{};m===0?(z.success("\u4FDD\u5B58\u6210\u529F"),y()):z.error(a.message),F("submit","")})},y=()=>{e.visible=!1};return s({show:_,hideModel:y}),(u,a)=>{var b;const m=x("h-spin"),r=x("h-modal");return c(),P(r,{title:"\u6A21\u7248\u66F4\u65B0\u8BB0\u5F55 ("+((b=e.name)!=null?b:"")+")",size:"modal-xl",visible:e.visible,"confirm-loading":e.confirmLoading,onCancel:D},{footer:v(()=>[]),default:v(()=>[h(m,{spinning:e.confirmLoading},{default:v(()=>[f(" BEGIN: Data List "),t("div",st,[t("table",at,[it,t("tbody",null,[(c(!0),d(j,null,T(e.items,(p,o)=>(c(),d("tr",{key:o,class:"intro-x"},[t("td",ot,i(p.template_id),1),t("td",nt,i(p.user_version),1),t("td",rt,i(p.user_desc),1),t("td",ut,[t("div",lt,[t("a",{class:"flex items-center mr-3 hover:text-red-500",href:"javascript:0",onClick:V(k=>w(p),["stop"])}," \u9009\u62E9 ",8,ct)])])]))),128))])])]),f(" END: Data List ")]),_:1},8,["spinning"])]),_:1},8,["title","visible","confirm-loading"])}}}),dt=I(mt,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/miniprogram/modal/template.vue"]]),_t={class:"py-10"},pt={class:"flex justify-center"},ht={class:"px-5 mt-10"},ft={class:"text-lg font-medium text-center"},gt={class:"mt-2 text-center text-slate-500"},wt={key:0,class:"ml-3 text-base text-slate-600 dark:text-slate-400 lg:mx-auto lg:mt-3 lg:w-32"},bt={class:"col-span-12 overflow-auto intro-y lg:overflow-visible"},xt={class:"table -mt-2 table-report"},vt=t("thead",null,[t("tr",null,[t("th",{class:"whitespace-nowrap"},"\u65F6\u95F4"),t("th",{class:"text-center whitespace-nowrap"},"\u6A21\u677F\u7F16\u53F7"),t("th",{class:"text-center whitespace-nowrap"},"\u72B6\u6001"),t("th",{class:"whitespace-nowrap"},"\u5907\u6CE8")])],-1),Ft={class:"w-48 text-center"},yt={class:"w-20 text-center"},Bt={class:"text-center w-36"},Ct={class:""},Et=R({__name:"log",emits:["ok"],setup(l,{expose:s,emit:F}){const e=$({visible:!1,confirmLoading:!1,name:"",items:[],mini:{}}),n=$({authorizer_appid:"",platform_type:0}),g=M(()=>{if(e.mini.id){if(e.mini.status===1||e.mini.status===2)return 2;if(e.mini.status===0||e.mini.status===-1)return 1}return 0}),D=M(()=>{if(e.mini.id){if(e.mini.status===-1)return"\u5BA1\u6838\u62D2\u7EDD";if(e.mini.status===0)return"\u5BA1\u6838\u4E2D";if(e.mini.status===1)return"\u6A21\u677F\u5BA1\u6838\u901A\u8FC7"}return"\u7B49\u5F85\u5BA1\u6838"}),_=M(()=>e.mini.id&&e.mini.status_reason&&e.mini.status===-1?e.mini.status_reason:"\u5F85\u5FAE\u4FE1\u5BA1\u6838\u901A\u8FC7\uFF0C\u5373\u53EF\u53D1\u5E03\u4E0A\u7EBF"),w=()=>{e.confirmLoading=!0,et({authorizer_appid:n.authorizer_appid,platform_type:n.platform_type}).then(r=>{e.confirmLoading=!1,r.data.items&&G(()=>{e.items=r.data.items})})},y=()=>{e.visible=!1},u=r=>{e.visible=!0,n.platform_type=r.platform_type,n.authorizer_appid=r.authorizer_appid,e.name=r.nick,e.mini=r,w()},a=()=>{e.confirmLoading=!0,W({platform_type:n.platform_type,authorizer_appid:n.authorizer_appid}).then(r=>{const{code:b}=r||{};b===0?z.success(r.message):z.error(r.message),w(),F("ok","")})};return s({show:u,hideModel:()=>{e.visible=!1}}),(r,b)=>{var k;const p=x("h-spin"),o=x("h-modal");return c(),P(o,{title:"\u5BA1\u6838\u8BB0\u5F55 ("+((k=e.name)!=null?k:"")+")",size:"modal-xl",visible:e.visible,"confirm-loading":e.confirmLoading,onCancel:y},{footer:v(()=>[]),default:v(()=>[h(p,{spinning:e.confirmLoading},{default:v(()=>{var U,q;return[t("div",_t,[t("div",pt,[t("button",{class:N(["w-10 h-10 mx-2 rounded-full intro-y btn",{"btn-primary":B(g)==0}])}," 1 ",2),t("button",{class:N(["w-10 h-10 mx-2 rounded-full intro-y btn bg-slate-100 text-slate-500 dark:border-darkmode-400 dark:bg-darkmode-400",{"btn-primary":B(g)==1}])}," 2 ",2),t("button",{class:N(["w-10 h-10 mx-2 rounded-full intro-y btn bg-slate-100 text-slate-500 dark:border-darkmode-400 dark:bg-darkmode-400",{"btn-primary":B(g)==2}])}," 3 ",2)]),t("div",ht,[t("div",ft,i((U=B(D))!=null?U:""),1),t("div",gt,i((q=B(_))!=null?q:""),1),e.mini.status==1?(c(),d("div",wt,[t("button",{onClick:a},"\u7ACB\u5373\u6A21\u677F\u4E0A\u7EBF")])):f("v-if",!0)])]),f(" BEGIN: Data List "),t("div",bt,[t("table",xt,[vt,t("tbody",null,[(c(!0),d(j,null,T(e.items,(L,O)=>(c(),d("tr",{key:O,class:"intro-x"},[t("td",Ft,i(L.created_at),1),t("td",yt,i(L.template_id),1),t("td",Bt,i(L.status===0?"\u5BA1\u6838\u4E2D":L.status===-1?"\u62D2\u7EDD":"\u5BA1\u6838\u901A\u8FC7"),1),t("td",Ct,i(L.user_desc),1)]))),128))])])]),f(" END: Data List ")]}),_:1},8,["spinning"])]),_:1},8,["title","visible","confirm-loading"])}}}),At=I(Et,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/miniprogram/modal/log.vue"]]),Dt={class:"py-10 mt-5 intro-y box sm:py-20"},kt={class:"flex justify-center"},Lt={class:"flex flex-col items-center justify-center gap-y-3"},$t=["href"],zt=t("p",null,[Z(" \u6388\u6743\u5C0F\u7A0B\u5E8F\u4E4B\u524D\uFF0C\u8BF7\u5148\u524D\u5F80\u5FAE\u4FE1\u516C\u4F17\u53F7\u5E73\u53F0\u521B\u5EFA\u597D\u5C0F\u7A0B\u5E8F,"),t("a",{href:"https://mp.weixin.qq.com/",class:"",target:"_blank"},"\u300B\u300B\u5FAE\u4FE1\u516C\u4F17\u53F7\u5E73\u53F0 ")],-1),Ut={key:0,class:"px-5 pt-5 mt-5 intro-y box"},Mt={class:"flex flex-col pb-5 -mx-5 border-b border-slate-200/60 dark:border-darkmode-400 lg:flex-row"},jt={class:"flex items-center justify-center flex-1 px-5 lg:justify-start"},Nt={class:"relative flex-none w-20 h-20 image-fit sm:h-24 sm:w-24 lg:h-32 lg:w-32"},St=["alt","src"],Rt={class:"absolute bottom-0 right-0 flex items-center justify-center p-2 mb-1 mr-1 rounded-full bg-primary"},Tt={class:"ml-5"},It={class:"w-24 text-lg font-medium truncate sm:w-40 sm:whitespace-normal"},qt={class:"text-slate-500"},Pt={class:"flex-1 px-5 pt-5 mt-6 border-t border-l border-r border-slate-200/60 dark:border-darkmode-400 lg:mt-0 lg:border-t-0 lg:pt-0"},Vt=t("div",{class:"font-medium text-center lg:mt-3 lg:text-left"}," \u8BE6\u60C5 ",-1),Gt={class:"flex flex-col items-center justify-center mt-4 lg:items-start"},Ot={class:"flex items-center truncate sm:whitespace-normal"},Ht={class:"flex items-center mt-3 truncate sm:whitespace-normal"},Kt={class:"flex items-center mt-3 truncate sm:whitespace-normal"},Zt={class:"flex items-center mt-3 truncate sm:whitespace-normal"},Jt={class:"flex-1 px-5 pt-5 mt-6 border-t border-slate-200/60 dark:border-darkmode-400 lg:mt-0 lg:border-0 lg:pt-0"},Qt=t("div",{class:"font-medium text-center lg:mt-5 lg:text-left"}," \u4ECB\u7ECD ",-1),Wt={class:"flex items-center justify-center mt-2 lg:justify-start"},Xt={class:"flex mr-2"},Yt=t("h2",{class:"mt-10 text-lg font-medium intro-y"},"\u6388\u6743\u5217\u8868",-1),te={class:"col-span-12 overflow-auto intro-y lg:overflow-visible"},ee={class:"table -mt-2 table-report"},se=t("thead",null,[t("tr",null,[t("th",{class:"whitespace-nowrap"},"\u5934\u50CF"),t("th",{class:"whitespace-nowrap"},"\u540D\u79F0"),t("th",{class:"text-center whitespace-nowrap"},"\u5B9E\u540D\u8BA4\u8BC1"),t("th",{class:"text-center whitespace-nowrap"},"\u6388\u6743\u65F6\u95F4"),t("th",{class:"text-center whitespace-nowrap"},"\u8D26\u53F7\u7C7B\u578B"),t("th",{class:"text-center whitespace-nowrap"})])],-1),ae={class:"w-20"},ie={class:"flex"},oe={class:"w-10 h-10 image-fit zoom-in"},ne={href:"",class:"font-medium whitespace-nowrap"},re={class:"mt-0.5 whitespace-nowrap text-xs text-slate-500"},ue={class:"text-center"},le={class:"text-center"},ce={class:"w-40"},me={class:"flex items-center justify-center text-success"},de={class:"w-56 table-report__action"},_e={class:"flex items-center justify-center"},pe=["onClick"],he=["href"],fe=R({__name:"dashboard",setup(l){const s=$({miniprogram:{authorizer_appid:"",account_type:"",principal_type:"",auth_date:"",nick:"",head_img:"",principal_name:"",realname_status:"",signature:""},authorize_url:"",items:[],templates:[],logs:[],modal:{template:!1},template:{authorizer_appid:""},confirmLoading:!1}),F=S(),e=S(),n=S(),g=M(()=>{if(s.miniprogram.account_type){if(s.miniprogram.account_type==="0")return"\u8BA2\u9605\u53F7";if(s.miniprogram.account_type==="1")return"\u8001\u8BA2\u9605\u53F7";if(s.miniprogram.account_type==="2")return"\u670D\u52A1\u53F7";if(s.miniprogram.account_type==="3")return"\u5C0F\u7A0B\u5E8F"}return""});K(()=>{D()});const D=()=>{_()},_=()=>{Y({platform_type:100}).then(a=>{a.data.item&&(s.miniprogram=a.data.item),a.data.authorize_url&&(s.authorize_url=a.data.authorize_url),a.message&&z.success(a.message)}),Q({platform_type:100}).then(a=>{a.data.items&&(s.items=a.data.items)})},w=a=>{F.value.show(a)},y=a=>{e.value.show(a)},u=a=>{n.value.show(a)};return(a,m)=>{const r=x("CameraIcon"),b=x("Tippy"),p=x("h-card");return c(),d(j,null,[h(p,{bordered:!1,title:"\u5C0F\u7A0B\u5E8F\u6388\u6743"},{default:v(()=>[t("div",Dt,[t("div",kt,[t("div",Lt,[t("a",{class:"btn btn-primary",target:"_blank",href:s.authorize_url,onClick:m[0]||(m[0]=o=>w({title:"\u6388\u6743\u786E\u8BA4",content:"\u786E\u8BA4\u6388\u6743\u5B8C\u6210"}))}," \u6388\u6743\u516C\u4F17\u53F7\\\u5C0F\u7A0B\u5E8F ",8,$t),zt])])]),s.miniprogram.authorizer_appid.length>0?(c(),d("div",Ut,[t("div",Mt,[t("div",jt,[t("div",Nt,[t("img",{alt:s.miniprogram.nick,class:"rounded-full",src:s.miniprogram.head_img},null,8,St),t("div",Rt,[h(r,{class:"w-4 h-4 text-white"})])]),t("div",Tt,[t("div",It,i(s.miniprogram.nick),1),t("div",qt,i(s.miniprogram.authorizer_appid),1)])]),t("div",Pt,[Vt,t("div",Gt,[t("div",Ot," \u4E3B\u4F53\u540D\u79F0:"+i(s.miniprogram.principal_name),1),t("div",Ht," \u5B9E\u540D\u8BA4\u8BC1: "+i(s.miniprogram.realname_status=="1"?"\u662F":"\u5426"),1),t("div",Kt," \u6388\u6743\u65F6\u95F4: "+i(s.miniprogram.auth_date),1),t("div",Zt," \u8D26\u53F7\u7C7B\u578B: "+i(B(g)),1)])]),t("div",Jt,[Qt,t("div",Wt,[t("div",Xt,i(s.miniprogram.signature),1)])])])])):f("v-if",!0),Yt,f(" BEGIN: Data List "),t("div",te,[t("table",ee,[se,t("tbody",null,[(c(!0),d(j,null,T(s.items,(o,k)=>(c(),d("tr",{key:k,class:"intro-x"},[t("td",ae,[t("div",ie,[t("div",oe,[h(b,{tag:"img",alt:o.nick,class:"rounded-full",src:o.head_img,content:`${o.nick}`},null,8,["alt","src","content"])])])]),t("td",null,[t("a",ne,i(o.nick),1),t("div",re,i(o.principal_name),1)]),t("td",ue,i(o.realname_status=="1"?"\u662F":"\u5426"),1),t("td",le,i(o.auth_date),1),t("td",ce,[t("div",me,i(o.account_type==="0"?"\u8BA2\u9605\u53F7":o.account_type==="1"?"\u8001\u8BA2\u9605\u53F7":o.account_type==="2"?"\u670D\u52A1\u53F7":o.account_type==="3"?"\u5C0F\u7A0B\u5E8F":""),1)]),t("td",de,[t("div",_e,[t("a",{class:"flex items-center mr-3 hover:text-red-500",href:"javascript:void(0)",onClick:V(U=>y(o),["stop"])}," \u6A21\u7248\u4E0A\u67B6 ",8,pe),t("a",{class:"flex items-center hover:text-red-500",target:"_blank",href:s.authorize_url,onClick:m[1]||(m[1]=U=>w({title:"\u6388\u6743\u786E\u8BA4",content:"\u786E\u8BA4\u6388\u6743\u5B8C\u6210"}))}," \u6388\u6743 ",8,he)])])]))),128))])])]),f(" END: Data List ")]),_:1}),h(J,{ref_key:"confirmModal",ref:F,onOk:_},null,512),h(dt,{ref_key:"templateModal",ref:e,onOk:_,onSubmit:u},null,512),h(At,{ref_key:"logModal",ref:n,onOk:_},null,512)],64)}}}),be=I(fe,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/miniprogram/dashboard.vue"]]);export{be as default};
