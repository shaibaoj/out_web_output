import{r as S,h as j,Y as P,j as F,k as W,t as G,a as B,b as T,w as n,l as o,n as z,e as H,p as t,x as g,y as b,u as k,v as Z,q as M,s as r,D as O,Z as q,C as U,c as I,F as N,d as Y,a1 as R,$ as J}from"./index.68db354d.js";import{p as K}from"./pick.3bd8489a.js";const E={getItems:"/api/user/member/points/list",getView:"/api/user/member/points/view",updateItem:"/api/user/member/points/update",list_gift:"/api/user/member/points/list_gift",view_gift:"/api/user/member/points/view_gift",update_gift_status:"/api/user/member/points/update_gift_status",update_gift:"/api/user/member/points/update_gift"};function Q(h){return S({url:E.update_gift_status,method:"post",data:h})}function X(h){return S({url:E.update_gift,method:"post",data:h})}const ee={class:"w-32 mt-1 mb-2 mr-2 btn btn-outline-success btn-sm"},te={class:"input-group"},ne=o("div",{class:"input-group-text"},"\u4E2A",-1),oe=o("div",{class:"form-help"},null,-1),le={class:"input-group"},ae=o("div",{class:"input-group-text"},"\u4E2A",-1),se=o("div",{class:"form-help"},null,-1),ie=j({__name:"liwu",emits:["ok"],setup(h,{expose:v,emit:w}){const C=P().uploadUrl,e=F({id:0,pic_url:"",title:"",content:"",points:0,number:0}),f={},s=F({visible:!1,confirmLoading:!1}),d=()=>{s.visible=!1},p=c=>{e.pic_url=c.data.item.img},m=W(f,G(e)),y=c=>{s.visible=!0,Z(()=>{Object.assign(e,{id:0,pic_url:"",title:"",content:"",points:0,number:0}),Object.assign(e,K(c,["id","title","pic_url","content","points","number"]))})},x=()=>{if(s.confirmLoading=!0,m.value.$touch(),m.value.$invalid)m.value.$errors,s.confirmLoading=!1;else{const c=k(e);X(c).then(l=>{const{code:a}=l||{};a===0?M.success("\u4FDD\u5B58\u6210\u529F"):M.error(l.message),s.confirmLoading=!1,w("ok",c),s.visible=!1})}};return v({edit:y}),(c,l)=>{const a=r("h-form-item"),i=r("UploadIcon"),_=r("h-upload"),V=r("h-form"),A=r("h-spin"),$=r("LoadingIcon"),L=r("h-modal");return B(),T(L,{title:"\u793C\u7269\u53D1\u5E03",size:"modal-lg",visible:s.visible,"confirm-loading":s.confirmLoading,onCancel:d},{footer:n(()=>[o("button",{class:"w-24 mb-2 mr-1 btn btn-primary",onClick:l[6]||(l[6]=u=>x())},[z(" \u4FDD\u5B58 "),s.confirmLoading?(B(),T($,{key:0,icon:"oval",color:"white",class:"w-4 h-4 ml-2"})):H("",!0)])]),default:n(()=>[t(A,{spinning:s.confirmLoading},{default:n(()=>[t(V,{layout:"small"},{default:n(()=>[g(o("input",{"onUpdate:modelValue":l[0]||(l[0]=u=>e.id=u),type:"hidden"},null,512),[[b,e.id]]),t(a,{label:"\u540D\u79F0",content:"",layout:"small"},{default:n(()=>[g(o("input",{type:"text",class:"form-control","onUpdate:modelValue":l[1]||(l[1]=u=>e.title=u)},null,512),[[b,e.title]])]),_:1}),t(a,{label:"\u56FE\u7247",content:"",layout:"small"},{default:n(()=>[g(o("input",{type:"text",class:"form-control","onUpdate:modelValue":l[2]||(l[2]=u=>e.pic_url=u),placeholder:""},null,512),[[b,e.pic_url]]),t(_,{name:"file",multiple:!0,action:k(C),onChange:p},{default:n(()=>[o("button",ee,[t(i,{class:"w-4 h-4 mr-2"}),z("\u4E0A\u4F20 ")])]),_:1},8,["action"])]),_:1}),t(a,{label:"\u63CF\u8FF0",content:"",layout:"small"},{default:n(()=>[g(o("textarea",{class:"form-control","onUpdate:modelValue":l[3]||(l[3]=u=>e.content=u),rows:2},null,512),[[b,e.content]])]),_:1}),t(a,{label:"\u79EF\u5206",content:"",layout:"small"},{default:n(()=>[o("div",te,[g(o("input",{type:"text",class:"form-control","onUpdate:modelValue":l[4]||(l[4]=u=>e.points=u)},null,512),[[b,e.points]]),ne]),oe]),_:1}),t(a,{label:"\u5E93\u5B58",content:"",layout:"small"},{default:n(()=>[o("div",le,[g(o("input",{type:"text",class:"form-control","onUpdate:modelValue":l[5]||(l[5]=u=>e.number=u)},null,512),[[b,e.number]]),ae]),se]),_:1})]),_:1})]),_:1},8,["spinning"])]),_:1},8,["visible","confirm-loading"])}}}),ue=j({__name:"liwu",setup(h,{expose:v}){const w=P(),D=O(()=>`${w.urlPrefix}${w.apiUrl}${E.list_gift}`),C=q({}),e=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"\u540D\u79F0",field:"title"},{title:"\u79EF\u5206",hozAlign:"center",field:"points",width:120},{title:"\u5E93\u5B58",hozAlign:"center",field:"number",width:120},{title:"\u72B6\u6001",hozAlign:"center",field:"status",width:80},{title:"\u64CD\u4F5C",field:"action",width:120,formatter(a){const i=Y(`    <div class="flex items-center lg:justify-center">
                <a class="flex items-center mr-3 action-uponline" href="javascript:;">
                  <i data-lucide="check-square" class="w-4 h-4 mr-1"></i> ${a.getData().status===0?"\u4E0A\u67B6":"\u4E0B\u67B6"}
                </a>
                <a class="flex items-center text-danger action-edit" href="javascript:;">
                  <i data-lucide="trash-2" class="w-4 h-4 mr-1"></i> \u7F16\u8F91
                </a>
                </div>`);return Y(i).find(".action-uponline").on("click",function(_){_.target,a.getData().status===0?x(a.getData(),1):x(a.getData(),0)}),Y(i).find(".action-edit").on("click",function(){y(a.getData())}),i[0]}}],f=F({rangePicker:"",username:"",status:0,startTime:"",endTime:""}),s=U(),d=F({visible:!1,confirmLoading:!1}),p=U(),m=()=>{s.value.reload(!0)},y=a=>{p.value.edit(a)},x=(a,i)=>{Q({id:a.id,status:i}).then(_=>{M.success(_.message),s.value.reload()})},c=()=>{d.visible=!1};return v({show:()=>{d.visible=!0}}),(a,i)=>{const _=r("Litepicker"),V=r("h-form-item"),A=r("h-form"),$=R,L=r("h-drawer");return B(),I(N,null,[t(L,{title:"\u793C\u7269\u7BA1\u7406",size:"modal-xl",visible:d.visible,"confirm-loading":d.confirmLoading,onCancel:c},{header:n(()=>[o("button",{class:"btn btn-primary mb-2 mr-1 w-24",icon:"add",onClick:i[0]||(i[0]=u=>p.value.edit({}))},"\u6DFB\u52A0\u793C\u7269")]),default:n(()=>[t($,{ref_key:"tableRef",ref:s,columns:e,ajaxUrl:k(D),config:k(C),queryParam:f},{search:n(()=>[t(A,{layout:"inline"},{default:n(()=>[t(V,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:n(()=>[t(_,{modelValue:f.rangePicker,"onUpdate:modelValue":i[1]||(i[1]=u=>f.rangePicker=u),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"form-control mt-2 sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),o("div",{class:"mt-2 xl:mt-0"},[o("button",{type:"button",class:"btn btn-primary w-full sm:w-16",onClick:m}," \u67E5\u8BE2 ")])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1},8,["visible","confirm-loading"]),t(ie,{ref_key:"modal",ref:p,onOk:m},null,512)],64)}}}),ce=j({__name:"points",setup(h){const v=P(),w=O(()=>`${v.urlPrefix}${v.apiUrl}${E.getItems}`),D=q({}),C=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"\u7528\u6237\u540D",field:"user.user_name",width:150},{title:"\u79EF\u5206",field:"points",width:80},{title:"\u73B0\u91D1",field:"money",width:120},{title:"\u793C\u54C1",field:"user_cms_gift_id"},{title:"\u5151\u6362\u65F6\u95F4",hozAlign:"center",field:"created_at",formatter(p){return J(p.getData().created_at,"YY-MM-DD HH:mm")},width:160},{title:"\u72B6\u6001",hozAlign:"center",field:"status_name",width:80}],e=F({rangePicker:"",username:"",status:0,startTime:"",endTime:""}),f=U(),s=U(),d=()=>{f.value.reload(!0)};return(p,m)=>{const y=r("h-form-item"),x=r("Litepicker"),c=r("h-form"),l=R,a=r("h-card");return B(),I(N,null,[t(a,{bordered:!1,title:"\u5151\u6362\u8BB0\u5F55"},{header:n(()=>[o("button",{class:"btn btn-primary mr-2 shadow-md",onClick:m[0]||(m[0]=i=>s.value.show({}))},"\u793C\u7269\u7BA1\u7406 ")]),default:n(()=>[t(l,{ref_key:"tableRef",ref:f,columns:C,ajaxUrl:k(w),config:k(D),queryParam:e},{search:n(()=>[t(c,{layout:"inline"},{default:n(()=>[t(y,{label:"\u7528\u6237\u540D",content:"",layout:"inline"},{default:n(()=>[g(o("input",{"onUpdate:modelValue":m[1]||(m[1]=i=>e.username=i),type:"text",class:"form-control mt-2 sm:mt-0 sm:w-40 2xl:w-full"},null,512),[[b,e.username]])]),_:1}),t(y,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:n(()=>[t(x,{modelValue:e.rangePicker,"onUpdate:modelValue":m[2]||(m[2]=i=>e.rangePicker=i),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"form-control mt-2 sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),o("div",{class:"mt-2 xl:mt-0"},[o("button",{type:"button",class:"btn btn-primary w-full sm:w-16",onClick:d}," \u67E5\u8BE2 ")])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1}),t(ue,{ref_key:"liwuModal",ref:s,onOk:d},null,512)],64)}}});export{ce as default};
