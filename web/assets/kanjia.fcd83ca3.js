import{h as U,j as x,o as J,k as z,t as R,v as q,a as E,b as T,w as a,l as e,p as o,x as g,z as K,y as v,a0 as Q,c as V,F as $,u as B,q as Y,s as d,n as P,e as X,Y as I,D as W,Z as G,C,d as w}from"./index.9c437169.js";import{g as ee,u as te,c as oe,b as H}from"./market.4bfb2255.js";import{p as Z}from"./pick.40b27695.js";import{a as S,b as N,f as O}from"./dateUtil.cd140771.js";const ae={class:"form-check form-switch"},ne=e("div",{class:"form-help"},"\u65B9\u4FBF\u7528\u6237\u8054\u7CFB\u7684\u5FAE\u4FE1\u5BA2\u670D\u5E10\u53F7",-1),le=e("option",{value:0},"\u4F63\u91D1\u5956\u52B1",-1),ue=e("option",{value:1},"\u514D\u5355\u6A21\u5F0F",-1),se=[le,ue],ie={class:"input-group"},re=e("div",{class:"input-group-text"},"\u4EBA",-1),me=e("div",{class:"form-help"},"\u6BCF\u4E2A\u5546\u54C1\u9700\u8981\u780D\u4EF7\u4EBA\u6570",-1),de={class:"input-group"},ce=e("div",{class:"input-group-text"},"%",-1),fe=e("div",{class:"form-help"},"\u6BCF\u780D\u4E00\u6B21\u780D\u6389\u7684\u4F63\u91D1\u767E\u5206\u6BD4",-1),pe={class:"input-group"},_e=e("div",{class:"input-group-text"},"\u5143",-1),be=e("div",{class:"form-help"},"\u6BCF\u780D\u4E00\u6B21\u780D\u6389\u7684\u6700\u5C0F\u91D1\u989D",-1),ge={class:"input-group"},De=e("div",{class:"input-group-text"},"\u5143",-1),he=e("div",{class:"form-help"},"\u6BCF\u780D\u4E00\u6B21\u780D\u6389\u7684\u6700\u5927\u91D1\u989D",-1),ve=U({__name:"data",setup(M,{expose:k}){const u=x({weixin:"",mode:0,members:0,commission_rate:0,money1:0,money2:0,status:!1}),r={},h=x({visible:!1,confirmLoading:!1});J(()=>{_()});const i=z(r,R(u)),_=()=>{p()},p=()=>{ee({market_code:"kanjia"}).then(t=>{t.data.item&&q(()=>{const l=Z(t.data.item,["weixin","mode","members","commission_rate","money1","money2"]);Object.assign(u,l),l.status=t.data.item.status===1})})},y=t=>{if(t.preventDefault(),i.value.$touch(),i.value.$invalid)i.value.$errors;else{const l=B(u);te(Object.assign(l,{market_code:"kanjia",status:u.status?1:0})).then(f=>{const{code:s}=f||{};s===0?Y.success("\u4FDD\u5B58\u6210\u529F"):Y.error(f.message)})}},D=()=>{h.visible=!1};return k({edit:()=>{h.visible=!0}}),(t,l)=>{const f=d("h-form-item"),s=d("h-form"),c=d("h-drawer");return E(),T(c,{title:"\u8BBE\u7F6E",visible:h.visible,"confirm-loading":h.confirmLoading,onCancel:D},{footer:a(()=>[e("button",{class:"w-24 mb-2 mr-1 btn btn-primary",onClick:y},"\u4FDD\u5B58")]),default:a(()=>[o(s,{layout:"small"},{default:a(()=>[o(f,{label:"\u5168\u573A\u6D3B\u52A8",content:"",layout:"small"},{default:a(()=>[e("div",ae,[g(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":l[0]||(l[0]=m=>u.status=m)},null,512),[[K,u.status]])])]),_:1}),o(f,{label:"\u5BA2\u670D\u5FAE\u4FE1",content:"",layout:"small"},{default:a(()=>[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[1]||(l[1]=m=>u.weixin=m)},null,512),[[v,u.weixin]]),ne]),_:1}),o(f,{label:"\u780D\u4EF7\u6A21\u5F0F",content:"",layout:"small"},{default:a(()=>[g(e("select",{class:"form-select","onUpdate:modelValue":l[2]||(l[2]=m=>u.mode=m)},se,512),[[Q,u.mode]])]),_:1}),u.mode==0?(E(),V($,{key:0},[o(f,{label:"\u780D\u4EF7\u4EBA\u6570",content:"",layout:"small"},{default:a(()=>[e("div",ie,[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[3]||(l[3]=m=>u.members=m)},null,512),[[v,u.members]]),re]),me]),_:1}),o(f,{label:"\u780D\u4E00\u6B21\u91D1\u989D",content:"",layout:"small"},{default:a(()=>[e("div",de,[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[4]||(l[4]=m=>u.commission_rate=m)},null,512),[[v,u.commission_rate]]),ce]),fe]),_:1})],64)):(E(),V($,{key:1},[o(f,{label:"\u6700\u5C0F\u91D1\u989D",content:"",layout:"small"},{default:a(()=>[e("div",pe,[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[5]||(l[5]=m=>u.money1=m)},null,512),[[v,u.money1]]),_e]),be]),_:1}),o(f,{label:"\u6700\u5927\u91D1\u989D",content:"",layout:"small"},{default:a(()=>[e("div",ge,[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[6]||(l[6]=m=>u.money2=m)},null,512),[[v,u.money2]]),De]),he]),_:1})],64))]),_:1})]),_:1},8,["visible","confirm-loading"])}}}),ye=U({__name:"kanjia",emits:["ok"],setup(M,{expose:k,emit:u}){const r=x({item_id:"",commission_rate:0,members:0,start_time:"",end_time:""}),h={},i=x({visible:!1,confirmLoading:!1}),_=()=>{i.visible=!1},p=z(h,R(r)),y=n=>{i.visible=!0,q(()=>{const t=Z(n,["item_id","commission_rate","members"]);Object.assign(r,t),r.start_time=S(n.start_time),r.end_time=S(n.end_time)})},D=()=>{if(i.confirmLoading=!0,p.value.$touch(),p.value.$invalid)p.value.$errors,i.confirmLoading=!1;else{let n=B(r);n.start_time&&(n=Object.assign(n,{start_time:N(n.start_time)})),n.end_time&&(n=Object.assign(n,{end_time:N(n.end_time)})),oe(Object.assign(n,{type:"kanjia"})).then(t=>{const{code:l}=t||{};l===0?Y.success("\u4FDD\u5B58\u6210\u529F"):Y.error(t.message),i.confirmLoading=!1,u("ok",n),i.visible=!1})}};return k({edit:y}),(n,t)=>{const l=d("AlertCircleIcon"),f=d("Alert"),s=d("h-form-item"),c=d("Litepicker"),m=d("h-form"),F=d("h-spin"),j=d("LoadingIcon"),L=d("h-modal");return E(),T(L,{title:"\u53D1\u5E03\u5546\u54C1",size:"modal-lg",visible:i.visible,"confirm-loading":i.confirmLoading,onCancel:_},{footer:a(()=>[e("button",{class:"w-24 mb-2 mr-1 btn btn-primary",onClick:t[5]||(t[5]=b=>D())},[P(" \u63D0\u4EA4\u53D1\u5E03 "),i.confirmLoading?(E(),T(j,{key:0,icon:"oval",color:"white",class:"w-4 h-4 ml-2"})):X("",!0)])]),default:a(()=>[o(F,{spinning:i.confirmLoading},{default:a(()=>[o(m,{layout:"small"},{default:a(()=>[o(f,{class:"flex items-center mb-2 alert-outline-primary"},{default:a(()=>[o(l,{class:"w-6 h-6 mr-2"}),P(" \u6CE8\u610F\u63D0\u793A\uFF1A \u7528\u6237\u83B7\u53D6\u7684\u603B\u780D\u4EF7=\u4F63\u91D1*\u5355\u6B21\u780D\u4EF7\u4F63\u91D1\u6BD4\u4F8B*\u780D\u4EF7\u6B21\u6570 ")]),_:1}),o(s,{label:"\u5546\u54C1id",content:"",layout:"small"},{default:a(()=>[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=b=>r.item_id=b)},null,512),[[v,r.item_id]])]),_:1}),o(s,{label:"\u5355\u6B21\u780D\u4EF7\u4F63\u91D1\u6BD4\u4F8B",content:"",layout:"small"},{default:a(()=>[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=b=>r.commission_rate=b)},null,512),[[v,r.commission_rate]])]),_:1}),o(s,{label:"\u780D\u4EF7\u4EBA\u6570",content:"",layout:"small"},{default:a(()=>[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=b=>r.members=b)},null,512),[[v,r.members]])]),_:1}),o(s,{label:"\u5F00\u59CB\u65F6\u95F4",content:"",layout:"small"},{default:a(()=>[o(c,{modelValue:r.start_time,"onUpdate:modelValue":t[3]||(t[3]=b=>r.start_time=b),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"block w-56 mx-auto form-control"},null,8,["modelValue"])]),_:1}),o(s,{label:"\u7ED3\u675F\u65F6\u95F4",content:"",layout:"small"},{default:a(()=>[o(c,{modelValue:r.end_time,"onUpdate:modelValue":t[4]||(t[4]=b=>r.end_time=b),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"block w-56 mx-auto form-control"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["spinning"])]),_:1},8,["visible","confirm-loading"])}}}),Fe=U({__name:"items",setup(M,{expose:k}){const u=I(),r=W(()=>`${u.urlPrefix}${u.apiUrl}${H.getItems}`),h=G({}),i=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"\u6807\u9898",field:"goods.title",formatter(s){return w(`<a target="_blank" href="${s.getData().goods.item_url}">
          ${s.getData().goods.title}
        </a>`)[0]}},{title:"\u4EF7\u683C",field:"goods.price",width:50},{title:"\u56FE\u7247",field:"pic_url",width:100,formatter(s){return w(`<a target="_blank" href="${s.getData().item_url}">
          <img src="${s.getData().goods.pic_url}" />
        </a>`)[0]}},{title:"\u9500\u91CF",field:"goods.volume",width:50},{title:"\u5355\u6B21\u780D\u6BD4\u4F8B",field:"commission_rate",width:100},{title:"\u780D\u4EF7\u4EBA\u6570",field:"members",width:80},{title:"\u65F6\u95F4",field:"",width:140,formatter(s){return w(`<p>${O(s.getData().start_time)}</p>
        <p>${O(s.getData().end_time)}</p>`)[0]}},{title:"\u64CD\u4F5C",field:"action",width:120,formatter(s){const c=w('<a class="flex items-center" href="javascript:;">\u7F16\u8F91</a>');return w(c).on("click",function(m){t(s.getData())}),c[0]}}],_=x({type:"kanjia",rangePicker:"",username:"",status:0,startTime:"",endTime:""}),p=x({visible:!1,confirmLoading:!1}),y=C(),D=C(),n=()=>{y.value.reload(!0)},t=s=>{D.value.edit(s)},l=()=>{p.visible=!1};return k({show:()=>{p.visible=!0}}),(s,c)=>{const m=d("h-form-item"),F=d("Litepicker"),j=d("h-form"),L=d("Tablepage"),b=d("h-drawer");return E(),V($,null,[o(b,{title:"\u4E13\u4EAB\u4EA7\u54C1",size:"modal-xl",visible:p.visible,"confirm-loading":p.confirmLoading,onCancel:l},{header:a(()=>[e("button",{class:"mr-2 shadow-md btn btn-primary",onClick:c[0]||(c[0]=A=>D.value.edit({}))},"\u53D1\u5E03\u780D\u4EF7\u5546\u54C1 ")]),default:a(()=>[o(L,{ref_key:"tableRef",ref:y,columns:i,ajaxUrl:B(r),config:B(h),queryParam:_},{search:a(()=>[o(j,{layout:"inline"},{default:a(()=>[o(m,{label:"\u7528\u6237\u540D",content:"",layout:"inline"},{default:a(()=>[g(e("input",{"onUpdate:modelValue":c[1]||(c[1]=A=>_.username=A),type:"text",class:"mt-2 form-control sm:mt-0 sm:w-40 2xl:w-full"},null,512),[[v,_.username]])]),_:1}),o(m,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:a(()=>[o(F,{modelValue:_.rangePicker,"onUpdate:modelValue":c[2]||(c[2]=A=>_.rangePicker=A),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"mt-2 form-control sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),e("div",{class:"mt-2 xl:mt-0"},[e("button",{type:"button",class:"w-full btn btn-primary sm:w-16",onClick:n}," \u67E5\u8BE2 ")])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1},8,["visible","confirm-loading"]),o(ye,{ref_key:"modal",ref:D,onOk:n},null,512)],64)}}}),Be=U({__name:"kanjia",setup(M){const k=I(),u=W(()=>`${k.urlPrefix}${k.apiUrl}${H.shares}`),r=G({}),h=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"\u6807\u9898",field:"goods.title",formatter(n){return w(`<a target="_blank" href="${n.getData().goods.item_url}">
          ${n.getData().goods.title}
        </a>`)[0]}},{title:"\u4EF7\u683C",field:"goods.price",width:100},{title:"\u56FE\u7247",field:"pic_url",width:100,formatter(n){return w(`<a target="_blank" href="${n.getData().item_url}">
          <img src="${n.getData().goods.pic_url}" />
        </a>`)[0]}},{title:"\u5206\u4EAB\u4EBA",field:"member.user_name",width:100},{title:"\u53C2\u4E0E\u4EBA\u6B21",field:"invites",width:100},{title:"\u65F6\u95F4",field:"created_at",formatter(n){return O(n.getData().created_at,"YY-MM-DD HH:mm")},width:140}],i=x({market_code:"kanjia",rangePicker:"",username:"",status:0,startTime:"",endTime:""}),_=C(),p=C(),y=C(),D=()=>{_.value.reload(!0)};return(n,t)=>{const l=d("h-form-item"),f=d("Litepicker"),s=d("h-form"),c=d("Tablepage"),m=d("h-card");return E(),V($,null,[o(m,{bordered:!1,title:"\u4E13\u9898"},{header:a(()=>[e("button",{class:"btn btn-primary mr-2 shadow-md",onClick:t[0]||(t[0]=F=>y.value.show({}))},"\u63A8\u8350\u4EA7\u54C1 "),e("button",{class:"btn btn-primary mr-2 shadow-md",onClick:t[1]||(t[1]=F=>p.value.edit({}))},"\u8BBE\u7F6E ")]),default:a(()=>[o(c,{ref_key:"tableRef",ref:_,columns:h,ajaxUrl:B(u),config:B(r),queryParam:i},{search:a(()=>[o(s,{layout:"inline"},{default:a(()=>[o(l,{label:"\u7528\u6237\u540D",content:"",layout:"inline"},{default:a(()=>[g(e("input",{"onUpdate:modelValue":t[2]||(t[2]=F=>i.username=F),type:"text",class:"form-control mt-2 sm:mt-0 sm:w-40 2xl:w-full"},null,512),[[v,i.username]])]),_:1}),o(l,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:a(()=>[o(f,{modelValue:i.rangePicker,"onUpdate:modelValue":t[3]||(t[3]=F=>i.rangePicker=F),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"form-control mt-2 sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),e("div",{class:"mt-2 xl:mt-0"},[e("button",{type:"button",class:"btn btn-primary w-full sm:w-16",onClick:D}," \u67E5\u8BE2 ")])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1}),o(ve,{ref_key:"dataModal",ref:p,onOk:D},null,512),o(Fe,{ref_key:"itemsModal",ref:y,onOk:D},null,512)],64)}}});export{Be as default};
