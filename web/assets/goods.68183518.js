import{h as Z,Y as J,j as Y,D as K,E as st,k as it,t as rt,am as P,a as _,b as L,w as r,l as a,n as G,e as F,p as i,c as h,x as d,y as m,F as U,u as $,I as O,a2 as Q,m as y,v as B,q as S,s as v,Z as dt,o as mt,C as X,d as f,an as H,$ as ct,a1 as pt}from"./index.19049599.js";import{u as ft,f as _t,a as gt,b as ht,c as vt,g as Dt,d as yt,e as Ft}from"./goods.bcbe2695.js";import{g as wt,i as bt}from"./common.617ea512.js";import{p as j}from"./pick.cfc4a81b.js";const Et={class:"input-group"},Ct={class:"input-group"},Bt=a("div",{class:"form-help"},"\u8FD8\u53EF\u4EE5\u8F93\u5165 16 \u4E2A\u5B57",-1),kt={class:"w-32 mt-1 mb-2 mr-2 btn btn-outline-success btn-sm"},xt=["src"],Vt={key:1},Ut=a("p",null,"\u4E3B\u56FE\u53C2\u8003",-1),$t={class:"flex flex-row flex-wrap"},At=["onClick"],qt=["src"],Pt=a("div",{class:"form-help"},"\u963F\u91CC\u5988\u5988\u4F18\u60E0\u5238\u5EFA\u8BAE\u65F6\u95F47\u5929\u5DE6\u53F3",-1),jt=a("option",{value:0},"--\u9009\u62E9--",-1),Lt=["value"],Yt={key:0},St=a("p",null,"\u5907\u9009\u6587\u6848",-1),Mt={class:"flex flex-col gap-y-3"},Nt=["onClick"],It=["className"],Tt=Z({__name:"goods",emits:["ok"],setup(tt,{expose:A,emit:M}){const N=J().uploadUrl,t=Y({href:"",qq_video_url:"",coupon_url:"",money:0,id:0,num_iid:"",user_num_id:"",ori_price:0,user_type:0,volume:0,condition:0,title:"",price:0,qq_pic_url:"",comment:"",cid1:0,d_title:"",pic_url:"",create_time:"",end_time:""}),g={},n=Y({visible:!1,confirmLoading:!1,data:{hrefPreview:"",contentPreview:"",step:0,cats:[],wen_items:[],pic_urls:[]}}),q=K(()=>!bt(t.pic_url));st(()=>{k()});const k=()=>{wt({}).then(l=>{l.data.items&&(n.data.cats=l.data.items)})},w=it(g,rt(t)),b=l=>{n.data.step=0,n.data.contentPreview="",n.data.hrefPreview="",n.visible=!0,B(()=>{Object.assign(t,{href:"",qq_video_url:"",coupon_url:"",money:0,id:0,num_iid:"",user_num_id:"",ori_price:0,user_type:0,volume:0,condition:0,title:"",price:0,qq_pic_url:"",comment:"",cid1:0,d_title:"",pic_url:"",create_time:"",end_time:""}),n.data.pic_urls=[],n.data.wen_items=[],l.id&&(n.data.step=1);const u=j(l,["id","cid1","coupon_url","href","num_iid","title","d_title","price","pic_url","user_num_id","ori_price","user_type","volume","comment","create_time","end_time","money","condition"]);Object.assign(t,u),p()})},x=l=>{if(n.confirmLoading=!0,w.value.$touch(),w.value.$invalid)w.value.$errors,n.confirmLoading=!1;else{const u=$(t);ft(Object.assign(u,{submitStatus:l})).then(c=>{c.code===0&&(l===1?S.success("\u63D0\u4EA4\u6210\u529F"):S.success("\u4FDD\u5B58\u6210\u529F"),M("ok",u),n.visible=!1),n.confirmLoading=!1})}},e=l=>{t.pic_url=l.data.item.img},s=()=>{_t({href:t.href}).then(l=>{l.data.goods&&(B(()=>{Object.assign(t,j(l.data.goods,["id","cid1","coupon_url","href","num_iid","title","d_title","price","pic_url","user_num_id","ori_price","user_type","volume","comment"]))}),n.data.wen_items=l.data.goods.wen_items||[],n.data.pic_urls=l.data.goods.pic_urls||[]),n.confirmLoading=!1})},p=()=>{gt({href:t.href}).then(l=>{l.data.goods&&(n.data.wen_items=l.data.goods.wen_items||[],n.data.pic_urls=l.data.goods.pic_urls||[])})},E=()=>{vt({href:t.href,coupon_url:t.coupon_url}).then(l=>{l.data.coupon&&B(()=>{const u=j(l.data.coupon,["create_time","end_time","money","condition"]);Object.assign(t,u)})})},I=()=>{n.visible=!1},T=l=>{B(()=>{Object.assign(t,{comment:l.content})})},D=l=>{B(()=>{t.pic_url=l})},V=()=>{ht({href:n.data.hrefPreview,content:n.data.contentPreview}).then(l=>{l.data.item&&B(()=>{const u=j(l.data.item,["href","coupon_url"]);Object.assign(t,u),n.data.step=1,s(),E()})})};return P(()=>t.href,(l,u)=>{p()},{immediate:!0}),P(()=>t.coupon_url,(l,u)=>{E()},{immediate:!0}),P(()=>n.data.hrefPreview,(l,u)=>{V()},{immediate:!0}),P(()=>n.data.contentPreview,(l,u)=>{V()},{immediate:!0}),A({edit:b}),(l,u)=>{const c=v("h-form-item"),et=v("UploadIcon"),ut=v("h-upload"),z=v("Litepicker"),ot=v("h-form"),at=v("h-spin"),W=v("LoadingIcon"),nt=v("h-modal");return _(),L(nt,{title:"\u53D1\u5E03\u5546\u54C1",size:"modal-xl",visible:n.visible,"confirm-loading":n.confirmLoading,onCancel:I},{footer:r(()=>[a("div",{className:n.data.step===0?"hidden":""},[a("button",{class:"w-24 mb-2 mr-1 btn btn-primary",onClick:u[22]||(u[22]=o=>x(1))},[G(" \u63D0\u4EA4\u5BA1\u6838 "),n.confirmLoading?(_(),L(W,{key:0,icon:"oval",color:"white",class:"w-4 h-4 ml-2"})):F("",!0)]),a("button",{class:"w-24 mb-2 mr-1 btn btn-primary",onClick:u[23]||(u[23]=o=>x(0))},[G("\u4FDD\u5B58\u8349\u7A3F "),n.confirmLoading?(_(),L(W,{key:0,icon:"oval",color:"white",class:"w-4 ml-2"})):F("",!0)])],8,It)]),default:r(()=>[i(at,{spinning:n.confirmLoading},{default:r(()=>[i(ot,{layout:"small"},{default:r(()=>[n.data.step==0?(_(),h(U,{key:0},[i(c,{label:"\u5546\u54C1\u94FE\u63A5",content:"",layout:"small"},{default:r(()=>[a("div",Et,[d(a("input",{type:"text",class:"form-control","onUpdate:modelValue":u[0]||(u[0]=o=>n.data.hrefPreview=o),onChange:V},null,544),[[m,n.data.hrefPreview]]),a("div",{class:"input-group-text"},[a("button",{class:"w-24",onClick:V},"\u83B7\u53D6")])])]),_:1}),i(c,{label:"\u5546\u54C1\u6587\u6848",content:"",layout:"small"},{default:r(()=>[d(a("textarea",{class:"form-control","onUpdate:modelValue":u[1]||(u[1]=o=>n.data.contentPreview=o),rows:4,placeholder:"\u8BF7\u5728\u6B64\u7C98\u8D34\u63A8\u5E7F\u6587\u6848\uFF0C\u672C\u529F\u80FD\u53EF\u8BC6\u522B\u5927\u591A\u7B26\u5408\u89C4\u5219\u7684\u6587\u6848",onChange:V},null,544),[[m,n.data.contentPreview]])]),_:1})],64)):F("",!0),n.data.step!==0?(_(),h(U,{key:1},[d(a("input",{"onUpdate:modelValue":u[2]||(u[2]=o=>t.id=o),type:"hidden"},null,512),[[m,t.id]]),d(a("input",{"onUpdate:modelValue":u[3]||(u[3]=o=>t.num_iid=o),type:"hidden"},null,512),[[m,t.num_iid]]),d(a("input",{"onUpdate:modelValue":u[4]||(u[4]=o=>t.user_num_id=o),type:"hidden"},null,512),[[m,t.user_num_id]]),d(a("input",{"onUpdate:modelValue":u[5]||(u[5]=o=>t.ori_price=o),type:"hidden"},null,512),[[m,t.ori_price]]),d(a("input",{"onUpdate:modelValue":u[6]||(u[6]=o=>t.user_type=o),type:"hidden"},null,512),[[m,t.user_type]]),d(a("input",{"onUpdate:modelValue":u[7]||(u[7]=o=>t.volume=o),type:"hidden"},null,512),[[m,t.volume]]),d(a("input",{"onUpdate:modelValue":u[8]||(u[8]=o=>t.condition=o),type:"hidden"},null,512),[[m,t.condition]]),d(a("input",{"onUpdate:modelValue":u[9]||(u[9]=o=>t.money=o),type:"hidden"},null,512),[[m,t.money]]),i(c,{label:"\u5546\u54C1\u5730\u5740",content:"",layout:"small"},{default:r(()=>[a("div",Ct,[d(a("input",{type:"text",class:"form-control","onUpdate:modelValue":u[10]||(u[10]=o=>t.href=o)},null,512),[[m,t.href]]),a("div",{class:"input-group-text"},[a("button",{class:"w-24",onClick:s},"\u83B7\u53D6")])])]),_:1}),i(c,{label:"\u5546\u54C1\u6807\u9898",content:"",layout:"small"},{default:r(()=>[d(a("input",{type:"text",class:"form-control","onUpdate:modelValue":u[11]||(u[11]=o=>t.title=o)},null,512),[[m,t.title]])]),_:1}),i(c,{label:"\u63A8\u5E7F\u77ED\u6807\u9898",content:"",layout:"small"},{default:r(()=>[d(a("input",{type:"text",class:"form-control","onUpdate:modelValue":u[12]||(u[12]=o=>t.d_title=o)},null,512),[[m,t.d_title]]),Bt]),_:1}),i(c,{label:"\u539F\u4EF7\u683C",content:"",layout:"small"},{default:r(()=>[d(a("input",{type:"text",class:"form-control","onUpdate:modelValue":u[13]||(u[13]=o=>t.price=o)},null,512),[[m,t.price]])]),_:1}),i(c,{label:"\u56FE\u7247",content:"",layout:"small"},{default:r(()=>[d(a("input",{type:"text",class:"form-control","onUpdate:modelValue":u[14]||(u[14]=o=>t.pic_url=o),placeholder:"\u4F8B\uFF1Ahttps://img.alicdn.com/imgextra/i1/2454060579/TB2fakMdl0lpuFjSszdXXcdxFXa_!!2454060579.jpg"},null,512),[[m,t.pic_url]]),i(ut,{name:"file",multiple:!0,action:$(N),onChange:e},{default:r(()=>[a("button",kt,[i(et,{class:"w-4 h-4 mr-2"}),G("\u4E0A\u4F20 ")])]),_:1},8,["action"]),$(q)?(_(),h("img",{key:0,class:"w-48 h-48",src:t.pic_url},null,8,xt)):F("",!0),n.data.pic_urls&&n.data.pic_urls.length>0?(_(),h("div",Vt,[Ut,a("ul",$t,[(_(!0),h(U,null,O(n.data.pic_urls,(o,C)=>(_(),h("li",{key:C,onClick:lt=>D(o),class:"w-48 h-48"},[a("img",{src:o,class:"w-48 h-48"},null,8,qt)],8,At))),128))])])):F("",!0)]),_:1}),i(c,{label:"\u4F18\u60E0\u5238\u8FDE\u63A5",content:"",layout:"small"},{default:r(()=>[d(a("input",{type:"text",class:"form-control","onUpdate:modelValue":u[15]||(u[15]=o=>t.coupon_url=o)},null,512),[[m,t.coupon_url]]),Pt]),_:1}),i(c,{label:"\u5206\u7C7B",content:"",layout:"small"},{default:r(()=>[d(a("select",{class:"form-select","onUpdate:modelValue":u[16]||(u[16]=o=>t.cid1=o)},[jt,(_(!0),h(U,null,O(n.data.cats,(o,C)=>(_(),h("option",{key:C,value:o.c_id},y(o.short_name),9,Lt))),128))],512),[[Q,t.cid1]])]),_:1}),i(c,{label:"\u5F00\u59CB\u65F6\u95F4",content:"",layout:"small"},{default:r(()=>[i(z,{modelValue:t.create_time,"onUpdate:modelValue":u[17]||(u[17]=o=>t.create_time=o),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"block w-56 form-control"},null,8,["modelValue"])]),_:1}),i(c,{label:"\u7ED3\u675F\u65F6\u95F4",content:"",layout:"small"},{default:r(()=>[i(z,{modelValue:t.end_time,"onUpdate:modelValue":u[18]||(u[18]=o=>t.end_time=o),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"block w-56 form-control"},null,8,["modelValue"])]),_:1}),i(c,{label:"\u5FAE\u4FE1\u7FA4\u4E13\u7528\u56FE",content:"",layout:"small"},{default:r(()=>[d(a("input",{type:"text",class:"form-control","onUpdate:modelValue":u[19]||(u[19]=o=>t.qq_pic_url=o)},null,512),[[m,t.qq_pic_url]])]),_:1}),i(c,{label:"\u5BFC\u8D2D\u6587\u6848",content:"",layout:"small"},{default:r(()=>[d(a("textarea",{class:"form-control","onUpdate:modelValue":u[20]||(u[20]=o=>t.comment=o),rows:4,placeholder:"\u8BF7\u8F93\u516520-100\u5B57\u5BFC\u8D2D\u6587\u6848\u4ECB\u7ECD"},null,512),[[m,t.comment]]),n.data.wen_items&&n.data.wen_items.length>0?(_(),h("div",Yt,[St,a("ul",Mt,[(_(!0),h(U,null,O(n.data.wen_items,(o,C)=>(_(),h("li",{key:C,onClick:lt=>T(o)},y(C+1)+"."+y(o.content),9,Nt))),128))])])):F("",!0)]),_:1}),i(c,{label:"\u89C6\u9891\u6587\u4EF6",content:"",layout:"small"},{default:r(()=>[d(a("input",{type:"text",class:"form-control","onUpdate:modelValue":u[21]||(u[21]=o=>t.qq_video_url=o)},null,512),[[m,t.qq_video_url]])]),_:1})],64)):F("",!0)]),_:1})]),_:1},8,["spinning"])]),_:1},8,["visible","confirm-loading"])}}}),Gt=a("option",{value:""},"\u5168\u90E8",-1),Ot={value:"2"},Rt={value:"1"},zt={value:"0"},Wt={value:"-1"},Xt={value:"-2"},Qt=Z({__name:"goods",setup(tt){const A=J(),M=K(()=>`${A.urlPrefix}${A.apiUrl}${yt.list}`),R=dt({}),N=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"\u4E3B\u56FE",width:50,field:"pic_url",formatter(e){return f(`<a target="_blank" href="${e.getData().item_url}">
          <img src="${e.getData().pic_url}" />
        </a>`)[0]}},{title:"\u77ED\u6807\u9898",className:"common",field:"title",formatter(e){return f(`<a target="_blank" href="https://www.haowulm.com/?coupon=1&q=${encodeURIComponent(e.getData().item_url)}">
          ${e.getData().title}
        </a>`)[0]}},{title:"\u539F\u4EF7/\u5238\u540E\u4EF7	",width:120,field:"price",sorter:!0,formatter(e){return f(`<a target="_blank" href="${e.getData().item_url}">
          ${e.getData().price}
        </a>`)[0]}},{title:"\u4F63\u91D1\u6BD4\u4F8B",width:80,field:"coupon.commission_rate",formatter(e){return e.getData().coupon.commission_rate+"%"}},{title:"\u4F18\u60E0\u5238",width:80,field:"money",formatter(e){return f(`<a target="_blank" href="${e.getData().coupon_url}">
        \u67E5\u770B
        </a>`)[0]}},{title:"\u8D77\u6B62\u65E5\u671F",field:"",width:100,formatter(e){return f(`
        ${e.getData().create_time?`<span>${H(e.getData().create_time)}</span>`:""}
        ${e.getData().end_time?`<p>${H(e.getData().end_time)}</p>`:""}
        `)[0]}},{title:"\u9500\u91CF",width:50,field:"volume"},{title:"\u72B6\u6001",width:80,field:"",sorter:!0,formatter(e){return e.getData().status===0?"\u8349\u7A3F":e.getData().status===1?"\u5F85\u5BA1\u6838":e.getData().status===2?"\u4E0A\u67B6":e.getData().status===-1?"\u5DF2\u62D2\u7EDD":e.getData().status===-2?"\u5DF2\u4E0B\u67B6":""}},{title:"\u680F\u76EE",field:"category.short_name",width:60},{title:"\u5E97\u94FA",field:"user_type",width:80,formatter(e){return e.getData().user_type==="B"?"\u5929\u732B":"\u6DD8\u5B9D"}},{title:"\u66F4\u65B0\u65F6\u95F4",width:160,field:"updated_at",formatter(e){return ct(e.getData().created_at,"YY-MM-DD HH:mm")}},{title:"\u64CD\u4F5C",field:"action",width:120,hozAlign:"center",formatter(e){if(e.getData().status===-2){const s=f('<a class="flex items-center" href="javascript:;">\u6362\u5238</a>');return f(s).on("click",function(p){k(e.getData())}),s[0]}else if(e.getData().status===-1){const s=f('<a class="flex items-center" href="javascript:;">\u6362\u5238</a>');return f(s).on("click",function(p){k(e.getData())}),s[0]}else if(e.getData().status===0){const s=f('<a class="flex items-center" href="javascript:;">\u7F16\u8F91</a>');return f(s).on("click",function(p){k(e.getData())}),s[0]}else if(e.getData().status===1){const s=f('<a class="flex items-center" href="javascript:;">\u64A4\u9500\u5BA1\u6838</a>');return f(s).on("click",function(p){q(e.getData(),0)}),s[0]}else if(e.getData().status===2){const s=f('<a class="flex items-center" href="javascript:;">\u4E0B\u67B6</a>');return f(s).on("click",function(p){q(e.getData(),-2)}),s[0]}return""}}],t=Y({num_iid:"",status:"",url:""}),g=Y({report:{status0:0,status1:0,status2:0,status01:0,status02:0}});mt(()=>{x()});const n=X(),q=(e,s)=>{Ft({id:e.id,status:s}).then(p=>{const{code:E}=p||{};E===0?S.success(p.message):S.error(p.message),b(!1)})},k=e=>{e.item_url&&(e.href=e.item_url),n.value.edit(e)},w=X(),b=e=>{w.value.reload(e),x()},x=()=>{Dt({}).then(e=>{e.data.item&&(g.report.status0=e.data.item[0]?e.data.item[0]:0,g.report.status1=e.data.item[1]?e.data.item[1]:0,g.report.status2=e.data.item[2]?e.data.item[2]:0,g.report.status01=e.data.item[-1]?e.data.item[-1]:0,g.report.status02=e.data.item[-2]?e.data.item[-2]:0)})};return(e,s)=>{const p=v("h-form-item"),E=v("h-form"),I=pt,T=v("h-card");return _(),L(T,{bordered:!1,title:"\u5546\u54C1\u53D1\u5E03"},{header:r(()=>[a("button",{class:"btn btn-primary mr-2 shadow-md",onClick:s[0]||(s[0]=D=>n.value.edit({}))},"\u53D1\u5E03\u5546\u54C1 ")]),default:r(()=>[i(I,{ref_key:"tableRef",ref:w,columns:N,ajaxUrl:$(M),config:$(R),queryParam:t},{search:r(()=>[i(E,{layout:"inline"},{default:r(()=>[i(p,{label:"\u72B6\u6001",content:"",layout:"inline"},{default:r(()=>[d(a("select",{"onUpdate:modelValue":s[1]||(s[1]=D=>t.status=D),class:"form-select mt-2 w-full sm:mt-0 sm:w-auto",onChange:b},[Gt,a("option",Ot,"\u901A\u8FC7 ("+y(g.report.status2)+")",1),a("option",Rt,"\u5BA1\u6838\u4E2D ("+y(g.report.status1)+")",1),a("option",zt,"\u8349\u7A3F ("+y(g.report.status0)+")",1),a("option",Wt,"\u62D2\u7EDD ("+y(g.report.status01)+")",1),a("option",Xt,"\u4E0B\u67B6 ("+y(g.report.status02)+")",1)],544),[[Q,t.status]])]),_:1}),i(p,{label:"\u5546\u54C1\u7F16\u53F7",content:"",layout:"inline"},{default:r(()=>[d(a("input",{"onUpdate:modelValue":s[2]||(s[2]=D=>t.num_iid=D),type:"text",class:"form-control mt-2 sm:mt-0 sm:w-40 2xl:w-full"},null,512),[[m,t.num_iid]])]),_:1}),i(p,{label:"\u5546\u54C1\u5730\u5740",content:"",layout:"inline"},{default:r(()=>[d(a("input",{"onUpdate:modelValue":s[3]||(s[3]=D=>t.url=D),type:"text",class:"form-control mt-2 sm:mt-0 sm:w-40 2xl:w-full"},null,512),[[m,t.url]])]),_:1}),a("div",{class:"mt-2 xl:mt-0"},[a("button",{type:"button",class:"btn btn-primary w-full sm:w-16",onClick:b}," \u67E5\u8BE2 ")])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"]),i(Tt,{ref_key:"modal",ref:n,onOk:s[4]||(s[4]=D=>b(!1))},null,512)]),_:1})}}});export{Qt as default};
