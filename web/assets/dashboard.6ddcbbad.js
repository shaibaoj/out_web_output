import{Z as W,r as A,h as S,j as z,l as F,a as r,b as G,w as y,q as f,e as p,m as t,c,F as M,K as R,n as a,M as O,s as v,v as H,_ as q,G as j,aB as T,u as b,C as N,H as X,a0 as Y,p as tt}from"./index.178b6464.js";import{C as et}from"./confirm.2f4b7ee3.js";const C=W(),D={getView:"/api/user/open/miniprogram/view",list:"/api/user/open/miniprogram/list",templateList:"/api/user/open/template/list",logsList:"/api/user/open/template/logs",selectUpdate:"/api/user/open/template/select",getRelease:"/api/user/open/template/release"};function st(d){return A({baseURL:C.miniProgramUrl,url:D.list,method:"post",data:d})}function it(d){return A({baseURL:C.miniProgramUrl,url:D.getRelease,method:"post",data:d})}function K(d){return A({baseURL:C.miniProgramUrl,url:D.selectUpdate,method:"post",data:d})}function Z(d){return A({baseURL:C.miniProgramUrl,url:D.getView,method:"post",data:d})}function J(d){return A({baseURL:C.miniProgramUrl,url:D.templateList,method:"post",data:d})}function at(d){return A({baseURL:C.miniProgramUrl,url:D.logsList,method:"post",data:d})}const ot={class:"col-span-12 overflow-auto intro-y lg:overflow-visible"},ut={class:"table -mt-2 table-report"},nt=t("thead",null,[t("tr",null,[t("th",{class:"whitespace-nowrap"},"\u6A21\u677F\u7F16\u53F7"),t("th",{class:"text-center whitespace-nowrap"},"\u7248\u672C"),t("th",{class:"whitespace-nowrap"},"\u5907\u6CE8"),t("th",{class:"text-center whitespace-nowrap"})])],-1),rt={class:"w-20 text-center"},lt={class:"text-center"},ct={class:""},mt={class:"w-20"},dt={class:"flex items-center justify-center"},_t=["onClick"],pt=S({__name:"template",emits:["ok","submit"],setup(d,{expose:s,emit:g}){const e=z({visible:!1,confirmLoading:!1,name:"",items:[]}),i=z({authorizer_appid:"",platform_type:0}),w=()=>{e.confirmLoading=!0,J({authorizer_appid:i.authorizer_appid,platform_type:i.platform_type}).then(l=>{e.confirmLoading=!1,l.data.items&&H(()=>{e.items=l.data.items})})},k=()=>{e.visible=!1},h=l=>{e.visible=!0,i.platform_type=l.platform_type,i.authorizer_appid=l.authorizer_appid,e.name=l.nick,w()},E=l=>{e.confirmLoading=!0,K({platform_type:i.platform_type,authorizer_appid:i.authorizer_appid,template_id:l.template_id,user_version:l.user_version,user_desc:l.user_desc}).then(o=>{const{code:_}=o||{};_===0?(v.success("\u4FDD\u5B58\u6210\u529F"),x()):v.error(o.message),g("submit","")})},x=()=>{e.visible=!1};return s({show:h,hideModel:x}),(l,o)=>{var n;const _=F("h-spin"),B=F("h-modal");return r(),G(B,{title:"\u6A21\u7248\u66F4\u65B0\u8BB0\u5F55 ("+((n=e.name)!=null?n:"")+")",size:"modal-xl",visible:e.visible,"confirm-loading":e.confirmLoading,onCancel:k},{footer:y(()=>[]),default:y(()=>[f(_,{spinning:e.confirmLoading},{default:y(()=>[p(" BEGIN: Data List "),t("div",ot,[t("table",ut,[nt,t("tbody",null,[(r(!0),c(M,null,R(e.items,(m,u)=>(r(),c("tr",{key:u,class:"intro-x"},[t("td",rt,a(m.template_id),1),t("td",lt,a(m.user_version),1),t("td",ct,a(m.user_desc),1),t("td",mt,[t("div",dt,[t("a",{class:"flex items-center mr-3 hover:text-red-500",href:"javascript:0",onClick:O($=>E(m),["stop"])}," \u9009\u62E9 ",8,_t)])])]))),128))])])]),p(" END: Data List ")]),_:1},8,["spinning"])]),_:1},8,["title","visible","confirm-loading"])}}}),ht=q(pt,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/miniprogram/modal/template.vue"]]),ft={class:"py-10"},gt={class:"flex justify-center"},wt={class:"px-5 mt-10"},xt={class:"text-lg font-medium text-center"},bt={key:0,class:"mt-2 text-center text-slate-500"},vt={class:"mt-2 text-center text-slate-500"},Ft={key:1,class:"ml-3 text-base text-slate-600 dark:text-slate-400 lg:mx-auto lg:mt-3 lg:w-32"},yt={key:2,class:"ml-3 text-base text-center text-slate-600 dark:text-slate-400 lg:mx-auto lg:mt-3 lg:w-48"},Et={class:"col-span-12 overflow-auto intro-y lg:overflow-visible"},Bt={class:"table -mt-2 table-report"},At=t("thead",null,[t("tr",null,[t("th",{class:"whitespace-nowrap"},"\u65F6\u95F4"),t("th",{class:"text-center whitespace-nowrap"},"\u6A21\u677F\u7F16\u53F7"),t("th",{class:"text-center whitespace-nowrap"},"\u72B6\u6001"),t("th",{class:"whitespace-nowrap"},"\u5907\u6CE8")])],-1),Ct={class:"w-48 text-center"},Dt={class:"w-20 text-center"},kt={class:"text-center w-36"},Lt={class:""},zt=S({__name:"log",emits:["ok"],setup(d,{expose:s,emit:g}){const e=z({visible:!1,confirmLoading:!1,name:"",items:[],mini:{}}),i=z({app_mini_id:0,authorizer_appid:"",platform_type:0,template_id:0,user_version:"",user_desc:""}),w=j(()=>{if(e.mini.id){if(e.mini.status===2||e.mini.status===3||e.mini.status===-1)return 2;if(e.mini.status===1)return 1}return 0}),k=j(()=>{if(e.mini.id){if(e.mini.status===-1)return"\u5BA1\u6838\u62D2\u7EDD";if(e.mini.status===0)return"\u672A\u4E0A\u7EBF";if(e.mini.status===1)return"\u5BA1\u6838\u4E2D";if(e.mini.status===2)return"\u6A21\u677F\u5BA1\u6838\u901A\u8FC7";if(e.mini.status===3)return"\u5DF2\u4E0A\u7EBF"}return""}),h=j(()=>e.mini.id&&e.mini.status_reason&&e.mini.status===-1?e.mini.status_reason:e.mini.status===0?"\u8BF7\u5148\u63D0\u4EA4\u6A21\u7248\u81F3\u5FAE\u4FE1\u5BA1\u6838":e.mini.status===1?"\u5F85\u5FAE\u4FE1\u5BA1\u6838\u901A\u8FC7\uFF0C\u5373\u53EF\u53D1\u5E03\u4E0A\u7EBF":e.mini.status===2?"\u6A21\u7248\u5DF2\u7ECF\u5BA1\u6838\u901A\u8FC7\u4E86\uFF0C\u53EF\u4EE5\u53D1\u5E03\u4E0A\u7EBF\u4E86":e.mini.status===3?"\u6A21\u7248\u5DF2\u7ECF\u4E0A\u7EBF":""),E=()=>{e.confirmLoading=!0,at({app_mini_id:i.app_mini_id,authorizer_appid:i.authorizer_appid,platform_type:i.platform_type}).then(n=>{e.confirmLoading=!1,n.data.items&&H(()=>{e.items=n.data.items})}),Z({platform_type:100,authorizer_appid:i.authorizer_appid}).then(n=>{n.data.item&&(e.mini=n.data.item)})},x=()=>{e.visible=!1},l=(n,m)=>{e.visible=!0,i.app_mini_id=n.id,i.platform_type=n.platform_type,i.authorizer_appid=n.authorizer_appid,i.template_id=m.template_id,i.user_version=m.user_version,i.user_desc=m.user_desc,e.name=n.nick,e.mini=n,E()},o=()=>{e.confirmLoading=!0,it({app_mini_id:i.app_mini_id,platform_type:i.platform_type,authorizer_appid:i.authorizer_appid}).then(n=>{const{code:m}=n||{};m===0?v.success(n.message):v.error(n.message),E(),g("ok","")})},_=()=>{e.confirmLoading=!0,K({platform_type:i.platform_type,authorizer_appid:i.authorizer_appid,template_id:i.template_id,user_version:i.user_version,user_desc:i.user_desc}).then(n=>{const{code:m}=n||{};m===0?(v.success("\u4FDD\u5B58\u6210\u529F"),B()):v.error(n.message),g("ok","")})},B=()=>{e.visible=!1};return s({show:l,hideModel:B}),(n,m)=>{var U;const u=F("h-spin"),$=F("h-modal");return r(),G($,{title:"\u5BA1\u6838\u8BB0\u5F55 ("+((U=e.name)!=null?U:"")+")",size:"modal-xl",visible:e.visible,"confirm-loading":e.confirmLoading,onCancel:x},{footer:y(()=>[]),default:y(()=>[f(u,{spinning:e.confirmLoading},{default:y(()=>{var I,P,V;return[t("div",ft,[t("div",gt,[t("button",{class:T(["w-10 h-10 mx-2 rounded-full intro-y btn",{"btn-primary":b(w)==0}])}," 1 ",2),t("button",{class:T(["w-10 h-10 mx-2 rounded-full intro-y btn bg-slate-100 text-slate-500 dark:border-darkmode-400 dark:bg-darkmode-400",{"btn-primary":b(w)==1}])}," 2 ",2),t("button",{class:T(["w-10 h-10 mx-2 rounded-full intro-y btn bg-slate-100 text-slate-500 dark:border-darkmode-400 dark:bg-darkmode-400",{"btn-primary":b(w)==2}])}," 3 ",2)]),t("div",wt,[t("div",xt,a((I=b(k))!=null?I:""),1),e.mini.template_id>0?(r(),c("div",bt," \u5F53\u524D\u7248\u672C:"+a((P=e.mini.version)!=null?P:""),1)):p("v-if",!0),t("div",vt,a((V=b(h))!=null?V:""),1),e.mini.status==2?(r(),c("div",Ft,[t("button",{class:"w-full btn btn-primary",onClick:o},"\u7ACB\u5373\u6A21\u677F\u4E0A\u7EBF")])):p("v-if",!0),e.mini.status==0||e.mini.status==3||e.mini.status==-1?(r(),c("div",yt,[e.mini.status==0?(r(),c("button",{key:0,class:"w-full btn btn-primary",onClick:_},"\u4E00\u952E\u63D0\u4EA4\u6A21\u7248")):e.mini.status==3?(r(),c("button",{key:1,class:"w-full btn btn-primary",onClick:_},"\u4E00\u952E\u63D0\u4EA4\u65B0\u6A21\u7248")):(r(),c("button",{key:2,class:"w-full btn btn-primary",onClick:_},"\u4E00\u952E\u91CD\u65B0\u63D0\u4EA4\u6A21\u7248"))])):p("v-if",!0)])]),p(" BEGIN: Data List "),t("div",Et,[t("table",Bt,[At,t("tbody",null,[(r(!0),c(M,null,R(e.items,(L,Q)=>(r(),c("tr",{key:Q,class:"intro-x"},[t("td",Ct,a(L.created_at),1),t("td",Dt,a(L.template_id),1),t("td",kt,a(L.status===0?"\u5BA1\u6838\u4E2D":L.status===-1?"\u62D2\u7EDD":"\u5BA1\u6838\u901A\u8FC7"),1),t("td",Lt,a(L.user_desc),1)]))),128))])])]),p(" END: Data List ")]}),_:1},8,["spinning"])]),_:1},8,["title","visible","confirm-loading"])}}}),$t=q(zt,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/miniprogram/modal/log.vue"]]),Ut={class:"py-10 mt-5 intro-y box sm:py-20"},jt={class:"flex justify-center"},Mt={class:"flex flex-col items-center justify-center gap-y-3"},Tt=["href"],Nt=t("p",null,[tt(" \u6388\u6743\u5C0F\u7A0B\u5E8F\u4E4B\u524D\uFF0C\u8BF7\u5148\u524D\u5F80\u5FAE\u4FE1\u516C\u4F17\u53F7\u5E73\u53F0\u521B\u5EFA\u597D\u5C0F\u7A0B\u5E8F,"),t("a",{href:"https://mp.weixin.qq.com/",class:"",target:"_blank"},"\u300B\u300B\u5FAE\u4FE1\u516C\u4F17\u53F7\u5E73\u53F0 ")],-1),St={key:0,class:"px-5 pt-5 mt-5 intro-y box"},Rt={class:"flex flex-col pb-5 -mx-5 border-b border-slate-200/60 dark:border-darkmode-400 lg:flex-row"},qt={class:"flex items-center justify-center flex-1 px-5 lg:justify-start"},It={class:"relative flex-none w-20 h-20 image-fit sm:h-24 sm:w-24 lg:h-32 lg:w-32"},Pt=["alt","src"],Vt={class:"absolute bottom-0 right-0 flex items-center justify-center p-2 mb-1 mr-1 rounded-full bg-primary"},Gt={class:"ml-5"},Ot={class:"w-24 text-lg font-medium truncate sm:w-40 sm:whitespace-normal"},Ht={class:"text-slate-500"},Kt={class:"flex-1 px-5 pt-5 mt-6 border-t border-l border-r border-slate-200/60 dark:border-darkmode-400 lg:mt-0 lg:border-t-0 lg:pt-0"},Zt=t("div",{class:"font-medium text-center lg:mt-3 lg:text-left"}," \u8BE6\u60C5 ",-1),Jt={class:"flex flex-col items-center justify-center mt-4 lg:items-start"},Qt={class:"flex items-center truncate sm:whitespace-normal"},Wt={class:"flex items-center mt-3 truncate sm:whitespace-normal"},Xt={class:"flex items-center mt-3 truncate sm:whitespace-normal"},Yt={class:"flex items-center mt-3 truncate sm:whitespace-normal"},te={class:"flex-1 px-5 pt-5 mt-6 border-t border-slate-200/60 dark:border-darkmode-400 lg:mt-0 lg:border-0 lg:pt-0"},ee=t("div",{class:"font-medium text-center lg:mt-5 lg:text-left"}," \u4ECB\u7ECD ",-1),se={class:"flex items-center justify-center mt-2 lg:justify-start"},ie={class:"flex mr-2"},ae=t("h2",{class:"mt-10 text-lg font-medium intro-y"},"\u6388\u6743\u5217\u8868",-1),oe={class:"col-span-12 overflow-auto intro-y lg:overflow-visible"},ue={class:"table -mt-2 table-report"},ne=t("thead",null,[t("tr",null,[t("th",{class:"whitespace-nowrap"},"\u5934\u50CF"),t("th",{class:"whitespace-nowrap"},"\u540D\u79F0"),t("th",{class:"text-center whitespace-nowrap"},"\u5B9E\u540D\u8BA4\u8BC1"),t("th",{class:"text-center whitespace-nowrap"},"\u6388\u6743\u65F6\u95F4"),t("th",{class:"text-center whitespace-nowrap"},"\u8D26\u53F7\u7C7B\u578B"),t("th",{class:"text-center whitespace-nowrap"},"\u5F53\u524D\u7248\u672C"),t("th",{class:"text-center whitespace-nowrap"},"\u72B6\u6001"),t("th",{class:"text-center whitespace-nowrap"}),t("th",{class:"text-center whitespace-nowrap"})])],-1),re={class:"w-20"},le={class:"flex"},ce={class:"w-10 h-10 image-fit zoom-in"},me={href:"",class:"font-medium whitespace-nowrap"},de={class:"mt-0.5 whitespace-nowrap text-xs text-slate-500"},_e={class:"mt-0.5 whitespace-nowrap text-xs text-slate-400"},pe={class:"text-center"},he={class:"text-center w-60"},fe={class:"w-40"},ge={class:"flex items-center justify-center text-success"},we={class:"text-center"},xe={class:"w-40"},be={class:"flex items-center justify-center"},ve={class:"w-36 table-report__action"},Fe={key:0,class:"flex flex-col items-center justify-center"},ye=["onClick"],Ee={key:0,class:"text-[9px] text-red-500"},Be={class:"w-24 table-report__action"},Ae={class:"flex items-center justify-center"},Ce=["href"],De=S({__name:"dashboard",setup(d){const s=z({miniprogram:{authorizer_appid:"",account_type:0,principal_type:"",auth_date:"",nick:"",head_img:"",principal_name:"",realname_status:"",signature:""},authorize_url:"",items:[],templates:[],logs:[],modal:{template:!1},template:{template_id:0,user_version:""},confirmLoading:!1}),g=N(),e=N(),i=N(),w=j(()=>{if(s.miniprogram.account_type){if(s.miniprogram.account_type===0)return"\u8BA2\u9605\u53F7";if(s.miniprogram.account_type===1)return"\u8001\u8BA2\u9605\u53F7";if(s.miniprogram.account_type===2)return"\u670D\u52A1\u53F7";if(s.miniprogram.account_type===3)return"\u5C0F\u7A0B\u5E8F"}return""});X(()=>{k()});const k=()=>{h()},h=()=>{Z({platform_type:100}).then(o=>{o.data.item&&(s.miniprogram=o.data.item),o.data.authorize_url&&(s.authorize_url=o.data.authorize_url),o.message&&v.success(o.message)}),st({platform_type:100}).then(o=>{o.data.items&&(s.items=o.data.items)}),E()},E=()=>{J({platform_type:100}).then(o=>{o.data.items&&(s.templates=o.data.items),o.data.template&&(s.template=o.data.template)})},x=o=>{g.value.show(o)},l=(o,_)=>{i.value.show(o,_)};return(o,_)=>{const B=F("CameraIcon"),n=F("Tippy"),m=F("h-card");return r(),c(M,null,[f(m,{bordered:!1,title:"\u5C0F\u7A0B\u5E8F\u6388\u6743"},{default:y(()=>[t("div",Ut,[t("div",jt,[t("div",Mt,[t("a",{class:"btn btn-primary",target:"_blank",href:s.authorize_url,onClick:_[0]||(_[0]=u=>x({title:"\u6388\u6743\u786E\u8BA4",content:"\u786E\u8BA4\u6388\u6743\u5B8C\u6210"}))}," \u6388\u6743\u516C\u4F17\u53F7\\\u5C0F\u7A0B\u5E8F ",8,Tt),Nt])])]),s.miniprogram.authorizer_appid.length>0?(r(),c("div",St,[t("div",Rt,[t("div",qt,[t("div",It,[t("img",{alt:s.miniprogram.nick,class:"rounded-full",src:s.miniprogram.head_img},null,8,Pt),t("div",Vt,[f(B,{class:"w-4 h-4 text-white"})])]),t("div",Gt,[t("div",Ot,a(s.miniprogram.nick),1),t("div",Ht,a(s.miniprogram.authorizer_appid),1)])]),t("div",Kt,[Zt,t("div",Jt,[t("div",Qt," \u4E3B\u4F53\u540D\u79F0:"+a(s.miniprogram.principal_name),1),t("div",Wt," \u5B9E\u540D\u8BA4\u8BC1: "+a(s.miniprogram.realname_status=="1"?"\u662F":"\u5426"),1),t("div",Xt," \u6388\u6743\u65F6\u95F4: "+a(s.miniprogram.auth_date),1),t("div",Yt," \u8D26\u53F7\u7C7B\u578B: "+a(b(w)),1)])]),t("div",te,[ee,t("div",se,[t("div",ie,a(s.miniprogram.signature),1)])])])])):p("v-if",!0),ae,p(" BEGIN: Data List "),t("div",oe,[t("table",ue,[ne,t("tbody",null,[(r(!0),c(M,null,R(s.items,(u,$)=>(r(),c("tr",{key:$,class:"intro-x"},[t("td",re,[t("div",le,[t("div",ce,[f(n,{tag:"img",alt:u.nick,class:"rounded-full",src:u.head_img,content:`${u.nick}`},null,8,["alt","src","content"])])])]),t("td",null,[t("a",me,a(u.nick),1),t("div",de,a(u.principal_name),1),t("div",_e,a(u.authorizer_appid),1)]),t("td",pe,a(u.realname_status=="1"?"\u662F":"\u5426"),1),t("td",he,a(b(Y)(u.auth_time)),1),t("td",fe,[t("div",ge,a(u.account_type===0?"\u8BA2\u9605\u53F7":u.account_type===1?"\u8001\u8BA2\u9605\u53F7":u.account_type===2?"\u670D\u52A1\u53F7":u.account_type===3?"\u5C0F\u7A0B\u5E8F":""),1)]),t("td",we,a(u.version),1),t("td",xe,[t("div",be,a(u.status===0?"\u672A\u4E0A\u7EBF":u.status===1?"\u5BA1\u6838\u4E2D":u.status===2?"\u5BA1\u6838\u901A\u8FC7":u.status===3?"\u4E0A\u7EBF":""),1)]),t("td",ve,[u.account_type===3?(r(),c("div",Fe,[t("a",{class:"flex items-center mr-3 hover:text-red-500",href:"javascript:void(0)",onClick:O(U=>l(u,s.template),["stop"])}," \u6A21\u7248\u7BA1\u7406 ",8,ye),s.template.template_id!=u.template_id?(r(),c("span",Ee,"\u6700\u65B0\u7248\u672C("+a(s.template.user_version)+")",1)):p("v-if",!0)])):p("v-if",!0)]),t("td",Be,[t("div",Ae,[t("a",{class:"flex items-center hover:text-red-500",target:"_blank",href:s.authorize_url,onClick:_[1]||(_[1]=U=>x({title:"\u6388\u6743\u786E\u8BA4",content:"\u786E\u8BA4\u6388\u6743\u5B8C\u6210"}))}," \u6388\u6743 ",8,Ce)])])]))),128))])])]),p(" END: Data List ")]),_:1}),f(et,{ref_key:"confirmModal",ref:g,onOk:h},null,512),f(ht,{ref_key:"templateModal",ref:e,onOk:h,onSubmit:l},null,512),f($t,{ref_key:"logModal",ref:i,onOk:h},null,512)],64)}}}),ze=q(De,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/miniprogram/dashboard.vue"]]);export{ze as default};
