import{h as I,j as B,k as q,t as R,o as H,v as M,a as D,b as S,w as s,l as i,p as a,x as _,a2 as W,y as h,u as $,q as U,s as m,E as J,am as K,n as N,e as P,m as C,c as V,$ as z,Y as Q,D as X,Z as ee,C as G,F as te,d as k,a1 as oe}from"./index.ae8c907f.js";import{g as ie,u as Z,c as ne,b as ue}from"./market.c91fb01a.js";import{p as T}from"./pick.6d9c0b1f.js";import{f as ae,a as se}from"./goods.8a2eaae2.js";const le=i("option",{value:0},"\u9650\u5B9A\u5546\u54C1",-1),re=i("option",{value:1},"\u5168\u573A\u9650\u4EF7",-1),me=[le,re],we=I({__name:"data",setup(O,{expose:w}){const c=B({benefits:0,benefits_money:0,benefits_commission:0}),o={},b=B({visible:!1,confirmLoading:!1,data:{benefits_invite_buyer_rate:0}}),e=q(o,R(c));H(()=>{F()});const F=()=>{v()},v=()=>{ie({market_code:"vip"}).then(f=>{f.data.item&&M(()=>{Object.assign(c,T(f.data.item,["benefits","benefits_money","benefits_commission","benefits_invite_price","benefits_invite_client_price","benefits_invite_buyer_rate"])),b.data.benefits_invite_buyer_rate=f.data.item.benefits_invite_buyer_rate})})},g=f=>{if(f.preventDefault(),e.value.$touch(),e.value.$invalid)e.value.$errors;else{const d=$(c);Z(Object.assign(d,{market_code:"vip"})).then(u=>{const{code:t}=u||{};t===0?U.success("\u4FDD\u5B58\u6210\u529F"):U.error(u.message)})}},y=()=>{b.visible=!1};return w({edit:()=>{b.visible=!0}}),(f,d)=>{const u=m("h-form-item"),t=m("h-form"),n=m("h-drawer");return D(),S(n,{title:"\u8BBE\u7F6E",visible:b.visible,"confirm-loading":b.confirmLoading,onCancel:y},{footer:s(()=>[i("button",{class:"w-24 mb-2 mr-1 btn btn-primary",onClick:g},"\u4FDD\u5B58")]),default:s(()=>[a(t,{layout:"small"},{default:s(()=>[a(u,{label:"\u5168\u573A\u6D3B\u52A8",content:"",layout:"small"},{default:s(()=>[_(i("select",{class:"form-select","onUpdate:modelValue":d[0]||(d[0]=r=>c.benefits=r)},me,512),[[W,c.benefits]])]),_:1}),a(u,{label:"\u9650\u5B9A\u4EF7\u683C",content:"",layout:"small"},{default:s(()=>[_(i("input",{type:"text",class:"form-control","onUpdate:modelValue":d[1]||(d[1]=r=>c.benefits_money=r),placeholder:"\u4E0D\u8D85\u8FC7\u8FD9\u4E2A\u4EF7\u683C"},null,512),[[h,c.benefits_money]])]),_:1}),a(u,{label:"\u4F63\u91D1\u7B5B\u9009",content:"",layout:"small"},{default:s(()=>[_(i("input",{type:"text",class:"form-control","onUpdate:modelValue":d[2]||(d[2]=r=>c.benefits_commission=r),placeholder:"\u8D85\u8FC7\u8FD9\u4E2A\u4F63\u91D1"},null,512),[[h,c.benefits_commission]])]),_:1})]),_:1})]),_:1},8,["visible","confirm-loading"])}}}),ce={class:"input-group"},de={key:0},pe={key:1},fe={key:2},_e=i("option",{value:0},"\u9ED8\u8BA4",-1),be=i("option",{value:2},"\u4F18\u8D28\u5546\u54C1",-1),ve=i("option",{value:1},"\u4FBF\u5B9C\u5B9E\u7528",-1),ge=i("option",{value:3},"0\u5143\u9886\u53D6",-1),he=i("option",{value:4},"1\u5143\u8D2D\u7269",-1),Fe=[_e,be,ve,ge,he],De=I({__name:"goods",emits:["ok"],setup(O,{expose:w,emit:c}){const o=B({id:0,href:"",price:0,price_rate:0,commission_rate:0,inventory:0,recommend:0,num_iid:"",start_time:"",end_time:""}),b={},e=B({visible:!1,confirmLoading:!1,vip:{ori_price:0,coupon_price:0,buy_base_price:0,price:0,price_rate:0,commission_rate:0,commission:0},data:{href:"",pic_urls:[],wen_items:[]}});J(()=>{});const F=()=>{e.visible=!1},v=()=>{se({href:o.href}).then(u=>{u.data.goods&&(e.data.wen_items=u.data.goods.wen_items||[],e.data.pic_urls=u.data.goods.pic_urls||[])})};K(()=>e.data.href,(u,t)=>{v()},{immediate:!0});const g=q(b,R(o)),y=u=>{e.visible=!0,M(()=>{Object.assign(o,{id:0,href:"",price:0,price_rate:0,commission_rate:0,inventory:0,recommend:0,num_iid:"",start_time:"",end_time:""});const t=T(u,["id","recommend","inventory","href","num_iid","start_time","end_time","commission_rate","price_rate","price"]);Object.assign(o,t),f(),v()})},E=u=>{if(e.confirmLoading=!0,g.value.$touch(),g.value.$invalid)g.value.$errors,e.confirmLoading=!1;else{const t=$(o);t.start_time&&(t.start_time=z(t.start_time)),t.end_time&&(t.end_time=z(t.end_time)),ne(Object.assign(t,{type:"vip",submitStatus:u})).then(n=>{n.code===0&&(u===1?U.success("\u63D0\u4EA4\u6210\u529F"):U.success("\u4FDD\u5B58\u6210\u529F"),c("ok",t),e.visible=!1),e.confirmLoading=!1})}},f=()=>{ae({href:o.href}).then(u=>{u.data.goods&&(M(()=>{Object.assign(o,T(u.data.goods,["id","href","num_iid","start_time","end_time"]))}),e.vip.ori_price=u.data.goods.ori_price,e.vip.coupon_price=u.data.goods.coupon_price,e.vip.buy_base_price=u.data.goods.buy_base_price,e.vip.commission=u.data.goods.commission,e.data.wen_items=u.data.goods.wen_items||[],e.data.pic_urls=u.data.goods.pic_urls||[]),e.confirmLoading=!1})},d=()=>{e.vip.price=o.price,e.vip.price_rate=o.price_rate,e.vip.commission_rate=o.commission_rate};return w({edit:y}),(u,t)=>{const n=m("AlertCircleIcon"),r=m("Alert"),p=m("h-form-item"),A=m("Litepicker"),Y=m("h-form"),L=m("h-spin"),j=m("LoadingIcon"),x=m("h-modal");return D(),S(x,{title:"\u53D1\u5E03\u5546\u54C1",size:"modal-xl",visible:e.visible,"confirm-loading":e.confirmLoading,onCancel:F},{footer:s(()=>[i("button",{class:"w-24 mb-2 mr-1 btn btn-primary",onClick:t[10]||(t[10]=l=>E(1))},[N(" \u63D0\u4EA4\u53D1\u5E03 "),e.confirmLoading?(D(),S(j,{key:0,icon:"oval",color:"white",class:"w-4 h-4 ml-2"})):P("",!0)])]),default:s(()=>[a(L,{spinning:e.confirmLoading},{default:s(()=>[a(Y,{layout:"small"},{default:s(()=>[a(r,{class:"flex items-center mb-2 alert-outline-primary"},{default:s(()=>[a(n,{class:"w-6 h-6 mr-2"}),N(" \u6CE8\u610F\u63D0\u793A\uFF1A \u6210\u4EA4\u4EF7\u767E\u5206\u6BD4\u4F18\u5148\u4E8E\u4F63\u91D1\u767E\u5206\u6BD4\uFF0C\u4F8B\uFF1A\u8BBE\u7F6E\u4E86\u6210\u4EA4\u767E\u5206\u6BD4\uFF0C\u4F63\u91D1\u6BD4\u4F8B\u5C31\u65E0\u6548\uFF0C\uFF08\u56FA\u5B9A\u8FD4\u5229\u91D1\u989D\u4F18\u5148\u7EA7\u522B\u6700\u9AD8\uFF09 ")]),_:1}),i("div",null,[_(i("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>o.id=l),type:"hidden"},null,512),[[h,o.id]]),_(i("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>o.inventory=l),type:"hidden"},null,512),[[h,o.inventory]]),a(p,{label:"\u5730\u5740",content:"",layout:"small"},{default:s(()=>[i("div",ce,[_(i("input",{type:"text",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=l=>o.href=l)},null,512),[[h,o.href]]),i("div",{class:"input-group-text"},[i("button",{class:"w-24",onClick:f},"\u83B7\u53D6")])])]),_:1}),a(p,{label:"\u8BE6\u60C5",content:"",layout:"small"},{default:s(()=>[i("span",null,"\u539F\u4EF7:"+C(e.vip.ori_price),1),i("span",null,"\u5238\u540E\u4EF7:"+C(e.vip.coupon_price),1),i("span",null,"\u8D2D\u4E70\u6210\u672C\u4EF7:"+C(e.vip.buy_base_price),1),e.vip.price>0?(D(),V("span",de,"\u7528\u6237\u6700\u7EC8\u4EF7\u683C:"+C((e.vip.coupon_price-e.vip.price).toFixed(2)),1)):e.vip.price_rate>0?(D(),V("span",pe,"\u7528\u6237\u6700\u7EC8\u4EF7\u683C:"+C((e.vip.coupon_price*(100-e.vip.price_rate)/100).toFixed(2)),1)):e.vip.commission_rate>0?(D(),V("span",fe,"\u7528\u6237\u6700\u7EC8\u4EF7\u683C:"+C((e.vip.coupon_price-e.vip.commission*e.vip.commission_rate/100).toFixed(2)),1)):P("",!0)]),_:1}),a(p,{label:"\u5F00\u59CB\u65F6\u95F4",content:"",layout:"small"},{default:s(()=>[a(A,{modelValue:o.start_time,"onUpdate:modelValue":t[3]||(t[3]=l=>o.start_time=l),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"block w-56 mx-auto form-control"},null,8,["modelValue"])]),_:1}),a(p,{label:"\u7ED3\u675F\u65F6\u95F4",content:"",layout:"small"},{default:s(()=>[a(A,{modelValue:o.end_time,"onUpdate:modelValue":t[4]||(t[4]=l=>o.end_time=l),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"block w-56 mx-auto form-control"},null,8,["modelValue"])]),_:1}),a(p,{label:"\u5546\u54C1id",content:"",layout:"small"},{default:s(()=>[_(i("input",{type:"text",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=l=>o.num_iid=l)},null,512),[[h,o.num_iid]])]),_:1}),a(p,{label:"\u4F63\u91D1\u767E\u5206\u6BD4",content:"",layout:"small"},{default:s(()=>[_(i("input",{type:"text",class:"form-control","onUpdate:modelValue":t[6]||(t[6]=l=>o.commission_rate=l),onChange:d},null,544),[[h,o.commission_rate]])]),_:1}),a(p,{label:"\u6210\u4EA4\u4EF7\u767E\u5206\u6BD4",content:"",layout:"small"},{default:s(()=>[_(i("input",{type:"text",class:"form-control","onUpdate:modelValue":t[7]||(t[7]=l=>o.price_rate=l),onChange:d},null,544),[[h,o.price_rate]])]),_:1}),a(p,{label:"\u8FD4\u5229\u56FA\u5B9A\u91D1\u989D",content:"",layout:"small"},{default:s(()=>[_(i("input",{type:"text",class:"form-control","onUpdate:modelValue":t[8]||(t[8]=l=>o.price=l),onChange:d},null,544),[[h,o.price]])]),_:1}),a(p,{label:"\u5546\u54C1\u7C7B\u578B",content:"",layout:"small"},{default:s(()=>[_(i("select",{class:"form-select","onUpdate:modelValue":t[9]||(t[9]=l=>o.recommend=l)},Fe,512),[[W,o.recommend]])]),_:1})])]),_:1})]),_:1},8,["spinning"])]),_:1},8,["visible","confirm-loading"])}}}),ke=I({__name:"items",setup(O,{expose:w}){const c=Q(),o=X(()=>`${c.urlPrefix}${c.apiUrl}${ue.getItems}`),b=ee({}),e=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"\u6807\u9898",field:"title",formatter(n){return k(`<a target="_blank" href="${n.getData().item_url}">
          ${n.getData().goods.title}
        </a>`)[0]}},{title:"\u4EF7\u683C",field:"goods.price",width:100},{title:"\u9886\u53D6\u91CF",field:"draws",width:60},{title:"\u5E93\u5B58\u9650\u5236",field:"inventory",width:60},{title:"\u662F\u5426\u8425\u9500\u5E93",field:"marketTypeName",width:60,formatter(n){return n.getData().goods.material_lib_type==="1"?"\u662F":"\u5426"}},{title:"\u56FE\u7247",field:"pic_url",width:100,formatter(n){return k(`<a target="_blank" href="${n.getData().item_url}">
          <img src="${n.getData().goods.pic_url}" />
        </a>`)[0]}},{title:"\u9500\u91CF",field:"goods.volume",width:60},{title:"\u4F63\u91D1\u6BD4\u4F8B",field:"commission_rate",width:60},{title:"\u6210\u4EA4\u4EF7\u6BD4\u4F8B",field:"price_rate",width:60},{title:"\u72B6\u6001",field:"",width:60,formatter(n){return n.getData().status===1?"\u4E0A\u67B6":"\u4E0B\u67B6"}},{title:"\u6D3B\u52A8\u5F00\u59CB\u65F6\u95F4",field:"start_time",width:120,hozAlign:"center"},{title:"\u6D3B\u52A8\u7ED3\u675F\u65F6\u95F4",field:"end_time",width:120,hozAlign:"center"},{title:"\u64CD\u4F5C",field:"",width:120,formatter(n){const r=k(`    <div class="flex items-center lg:justify-center">
                <a class="flex items-center mr-3 action-uponline" href="javascript:;">
                  <i data-lucide="check-square" class="w-4 h-4 mr-1"></i> ${n.getData().status===0?"\u4E0A\u67B6":"\u4E0B\u67B6"}
                </a>
                <a class="flex items-center text-danger action-edit" href="javascript:;">
                  <i data-lucide="trash-2" class="w-4 h-4 mr-1"></i> \u7F16\u8F91
                </a>
                </div>`);return k(r).find(".action-uponline").on("click",function(p){p.target,n.getData().status===0?f(n.getData(),1):f(n.getData(),0)}),k(r).find(".action-edit").on("click",function(){d(n.getData())}),r[0]}}],F=B({type:"vip",rangePicker:"",username:"",status:0,startTime:"",endTime:""}),v=B({visible:!1,confirmLoading:!1}),g=G(),y=()=>{g.value.reload(!0)},E=G(),f=(n,r)=>{Z({num_iid:n.num_iid,status:r}).then(()=>{g.value.reload(!0)})},d=n=>{n.item_url&&(n.href=n.item_url),E.value.edit(n)},u=()=>{v.visible=!1};return w({show:()=>{v.visible=!0}}),(n,r)=>{const p=m("Litepicker"),A=m("h-form-item"),Y=m("h-form"),L=oe,j=m("h-drawer");return D(),V(te,null,[a(j,{title:"\u4E13\u4EAB\u4EA7\u54C1",size:"modal-xl",visible:v.visible,"confirm-loading":v.confirmLoading,onCancel:u},{header:s(()=>[i("button",{class:"btn btn-primary mr-2 shadow-md",onClick:r[0]||(r[0]=x=>E.value.edit({}))},"\u53D1\u5E03 ")]),default:s(()=>[a(L,{ref_key:"tableRef",ref:g,columns:e,ajaxUrl:$(o),config:$(b),queryParam:F},{search:s(()=>[a(Y,{layout:"inline"},{default:s(()=>[a(A,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:s(()=>[a(p,{modelValue:F.rangePicker,"onUpdate:modelValue":r[1]||(r[1]=x=>F.rangePicker=x),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"form-control mt-2 sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),i("div",{class:"mt-2 xl:mt-0"},[i("button",{type:"button",class:"btn btn-primary w-full sm:w-16",onClick:y}," \u67E5\u8BE2 ")])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1},8,["visible","confirm-loading"]),a(De,{ref_key:"modal",ref:E,onOk:y},null,512)],64)}}});export{we as _,ke as a};
