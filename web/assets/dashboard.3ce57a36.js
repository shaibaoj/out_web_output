import{Z as X,r as C,h as S,j as z,l as F,a as r,b as O,w as y,q as f,e as p,m as t,c,F as M,K as R,n as a,M as H,s as v,v as K,_ as q,G as j,aB as T,u as g,C as N,H as Y,a0 as G,p as tt}from"./index.a0d57e21.js";import{C as et}from"./confirm.dbd46fe2.js";const D=X(),k={getView:"/api/user/open/miniprogram/view",list:"/api/user/open/miniprogram/list",templateList:"/api/user/open/template/list",logsList:"/api/user/open/template/logs",selectUpdate:"/api/user/open/template/select",getRelease:"/api/user/open/template/release"};function st(d){return C({baseURL:D.miniProgramUrl,url:k.list,method:"post",data:d})}function it(d){return C({baseURL:D.miniProgramUrl,url:k.getRelease,method:"post",data:d})}function Z(d){return C({baseURL:D.miniProgramUrl,url:k.selectUpdate,method:"post",data:d})}function J(d){return C({baseURL:D.miniProgramUrl,url:k.getView,method:"post",data:d})}function Q(d){return C({baseURL:D.miniProgramUrl,url:k.templateList,method:"post",data:d})}function at(d){return C({baseURL:D.miniProgramUrl,url:k.logsList,method:"post",data:d})}const ot={class:"col-span-12 overflow-auto intro-y lg:overflow-visible"},ut={class:"table -mt-2 table-report"},nt=t("thead",null,[t("tr",null,[t("th",{class:"whitespace-nowrap"},"\u6A21\u677F\u7F16\u53F7"),t("th",{class:"text-center whitespace-nowrap"},"\u7248\u672C"),t("th",{class:"whitespace-nowrap"},"\u5907\u6CE8"),t("th",{class:"text-center whitespace-nowrap"})])],-1),rt={class:"w-20 text-center"},lt={class:"text-center"},ct={class:""},mt={class:"w-20"},dt={class:"flex items-center justify-center"},_t=["onClick"],pt=S({__name:"template",emits:["ok","submit"],setup(d,{expose:s,emit:w}){const e=z({visible:!1,confirmLoading:!1,name:"",items:[]}),i=z({authorizer_appid:"",platform_type:0}),x=()=>{e.confirmLoading=!0,Q({authorizer_appid:i.authorizer_appid,platform_type:i.platform_type}).then(l=>{e.confirmLoading=!1,l.data.items&&K(()=>{e.items=l.data.items})})},L=()=>{e.visible=!1},h=l=>{e.visible=!0,i.platform_type=l.platform_type,i.authorizer_appid=l.authorizer_appid,e.name=l.nick,x()},E=l=>{e.confirmLoading=!0,Z({platform_type:i.platform_type,authorizer_appid:i.authorizer_appid,template_id:l.template_id,user_version:l.user_version,user_desc:l.user_desc}).then(o=>{const{code:_}=o||{};_===0?(v.success("\u4FDD\u5B58\u6210\u529F"),b()):v.error(o.message),w("submit","")})},b=()=>{e.visible=!1};return s({show:h,hideModel:b}),(l,o)=>{var n;const _=F("h-spin"),B=F("h-modal");return r(),O(B,{title:"\u6A21\u7248\u66F4\u65B0\u8BB0\u5F55 ("+((n=e.name)!=null?n:"")+")",size:"modal-xl",visible:e.visible,"confirm-loading":e.confirmLoading,onCancel:L},{footer:y(()=>[]),default:y(()=>[f(_,{spinning:e.confirmLoading},{default:y(()=>[p(" BEGIN: Data List "),t("div",ot,[t("table",ut,[nt,t("tbody",null,[(r(!0),c(M,null,R(e.items,(m,u)=>(r(),c("tr",{key:u,class:"intro-x"},[t("td",rt,a(m.template_id),1),t("td",lt,a(m.user_version),1),t("td",ct,a(m.user_desc),1),t("td",mt,[t("div",dt,[t("a",{class:"flex items-center mr-3 hover:text-red-500",href:"javascript:0",onClick:H($=>E(m),["stop"])}," \u9009\u62E9 ",8,_t)])])]))),128))])])]),p(" END: Data List ")]),_:1},8,["spinning"])]),_:1},8,["title","visible","confirm-loading"])}}}),ht=q(pt,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/miniprogram/modal/template.vue"]]),ft={class:"py-10"},gt={class:"flex justify-center"},wt={class:"px-5 mt-10"},xt={class:"text-lg font-medium text-center"},bt={key:0,class:"mt-2 text-center text-slate-500"},vt={class:"mt-2 text-center text-slate-500"},Ft={key:1,class:"ml-3 text-base text-slate-600 dark:text-slate-400 lg:mx-auto lg:mt-3 lg:w-32"},yt={key:2,class:"ml-3 text-base text-center text-slate-600 dark:text-slate-400 lg:mx-auto lg:mt-3 lg:w-48"},Et={class:"col-span-12 overflow-auto intro-y lg:overflow-visible"},Bt={class:"table -mt-2 table-report"},At=t("thead",null,[t("tr",null,[t("th",{class:"text-center whitespace-nowrap"},"\u65F6\u95F4"),t("th",{class:"text-center whitespace-nowrap"},"\u6A21\u677F\u7F16\u53F7"),t("th",{class:"text-center whitespace-nowrap"},"\u7248\u672C"),t("th",{class:"text-center whitespace-nowrap"},"\u72B6\u6001"),t("th",{class:"whitespace-nowrap"},"\u5907\u6CE8")])],-1),Ct={class:"w-48 text-center"},Dt={class:"w-20 text-center"},kt={class:"w-20 text-center"},Lt={class:"text-center w-36"},zt={class:""},$t=S({__name:"log",emits:["ok"],setup(d,{expose:s,emit:w}){const e=z({visible:!1,confirmLoading:!1,name:"",items:[],mini:{}}),i=z({app_mini_id:0,authorizer_appid:"",platform_type:0,template_id:0,user_version:"",user_desc:""}),x=j(()=>{if(e.mini.id){if(e.mini.status===2||e.mini.status===3||e.mini.status===-1)return 2;if(e.mini.status===1)return 1}return 0}),L=j(()=>{if(e.mini.id){if(e.mini.status===-1)return"\u5BA1\u6838\u62D2\u7EDD";if(e.mini.status===0)return"\u672A\u4E0A\u7EBF";if(e.mini.status===1)return"\u5BA1\u6838\u4E2D";if(e.mini.status===2)return"\u6A21\u677F\u5BA1\u6838\u901A\u8FC7";if(e.mini.status===3)return"\u5DF2\u4E0A\u7EBF"}return""}),h=j(()=>e.mini.id&&e.mini.status_reason&&e.mini.status===-1?e.mini.status_reason:e.mini.status===0?"\u8BF7\u5148\u63D0\u4EA4\u6A21\u7248\u81F3\u5FAE\u4FE1\u5BA1\u6838":e.mini.status===1?"\u5F85\u5FAE\u4FE1\u5BA1\u6838\u901A\u8FC7\uFF0C\u5373\u53EF\u53D1\u5E03\u4E0A\u7EBF":e.mini.status===2?"\u6A21\u7248\u5DF2\u7ECF\u5BA1\u6838\u901A\u8FC7\u4E86\uFF0C\u53EF\u4EE5\u53D1\u5E03\u4E0A\u7EBF\u4E86":e.mini.status===3?"\u6A21\u7248\u5DF2\u7ECF\u4E0A\u7EBF":""),E=()=>{e.confirmLoading=!0,at({app_mini_id:i.app_mini_id,authorizer_appid:i.authorizer_appid,platform_type:i.platform_type}).then(n=>{e.confirmLoading=!1,n.data.items&&K(()=>{e.items=n.data.items})}),J({platform_type:100,authorizer_appid:i.authorizer_appid}).then(n=>{n.data.item&&(e.mini=n.data.item)})},b=()=>{e.visible=!1},l=(n,m)=>{e.visible=!0,i.app_mini_id=n.id,i.platform_type=n.platform_type,i.authorizer_appid=n.authorizer_appid,i.template_id=m.template_id,i.user_version=m.user_version,i.user_desc=m.user_desc,e.name=n.nick,e.mini=n,E()},o=()=>{e.confirmLoading=!0,it({app_mini_id:i.app_mini_id,platform_type:i.platform_type,authorizer_appid:i.authorizer_appid}).then(n=>{const{code:m}=n||{};m===0?v.success(n.message):v.error(n.message),E(),w("ok","")})},_=()=>{e.confirmLoading=!0,Z({platform_type:i.platform_type,authorizer_appid:i.authorizer_appid,template_id:i.template_id,user_version:i.user_version,user_desc:i.user_desc}).then(n=>{const{code:m}=n||{};m===0?(v.success("\u4FDD\u5B58\u6210\u529F"),B()):v.error(n.message),w("ok","")})},B=()=>{e.visible=!1};return s({show:l,hideModel:B}),(n,m)=>{var U;const u=F("h-spin"),$=F("h-modal");return r(),O($,{title:"\u5BA1\u6838\u8BB0\u5F55 ("+((U=e.name)!=null?U:"")+")",size:"modal-xl",visible:e.visible,"confirm-loading":e.confirmLoading,onCancel:b},{footer:y(()=>[]),default:y(()=>[f(u,{spinning:e.confirmLoading},{default:y(()=>{var I,P,V;return[t("div",ft,[t("div",gt,[t("button",{class:T(["w-10 h-10 mx-2 rounded-full intro-y btn",{"btn-primary":g(x)==0}])}," 1 ",2),t("button",{class:T(["w-10 h-10 mx-2 rounded-full intro-y btn bg-slate-100 text-slate-500 dark:border-darkmode-400 dark:bg-darkmode-400",{"btn-primary":g(x)==1}])}," 2 ",2),t("button",{class:T(["w-10 h-10 mx-2 rounded-full intro-y btn bg-slate-100 text-slate-500 dark:border-darkmode-400 dark:bg-darkmode-400",{"btn-primary":g(x)==2}])}," 3 ",2)]),t("div",wt,[t("div",xt,a((I=g(L))!=null?I:""),1),e.mini.template_id>0?(r(),c("div",bt," \u5F53\u524D\u7248\u672C:"+a((P=e.mini.version)!=null?P:""),1)):p("v-if",!0),t("div",vt,a((V=g(h))!=null?V:""),1),e.mini.status==2?(r(),c("div",Ft,[t("button",{class:"w-full btn btn-primary",onClick:o},"\u7ACB\u5373\u6A21\u677F\u4E0A\u7EBF")])):p("v-if",!0),e.mini.status==0||e.mini.status==3||e.mini.status==-1?(r(),c("div",yt,[e.mini.status==0?(r(),c("button",{key:0,class:"w-full btn btn-primary",onClick:_},"\u4E00\u952E\u63D0\u4EA4\u6A21\u7248")):e.mini.status==3?(r(),c("button",{key:1,class:"w-full btn btn-primary",onClick:_},"\u4E00\u952E\u63D0\u4EA4\u65B0\u6A21\u7248")):(r(),c("button",{key:2,class:"w-full btn btn-primary",onClick:_},"\u4E00\u952E\u91CD\u65B0\u63D0\u4EA4\u6A21\u7248"))])):p("v-if",!0)])]),p(" BEGIN: Data List "),t("div",Et,[t("table",Bt,[At,t("tbody",null,[(r(!0),c(M,null,R(e.items,(A,W)=>(r(),c("tr",{key:W,class:"intro-x"},[t("td",Ct,a(A.created_at),1),t("td",Dt,a(A.template_id),1),t("td",kt,a(A.version),1),t("td",Lt,a(A.status===0?"\u5BA1\u6838\u4E2D":A.status===-1?"\u62D2\u7EDD":"\u5BA1\u6838\u901A\u8FC7"),1),t("td",zt,a(A.memo),1)]))),128))])])]),p(" END: Data List ")]}),_:1},8,["spinning"])]),_:1},8,["title","visible","confirm-loading"])}}}),Ut=q($t,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/miniprogram/modal/log.vue"]]),jt={class:"py-10 mt-5 intro-y box sm:py-20"},Mt={class:"flex justify-center"},Tt={class:"flex flex-col items-center justify-center gap-y-3"},Nt=["href"],St=t("p",null,[tt(" \u6388\u6743\u5C0F\u7A0B\u5E8F\u4E4B\u524D\uFF0C\u8BF7\u5148\u524D\u5F80\u5FAE\u4FE1\u516C\u4F17\u53F7\u5E73\u53F0\u521B\u5EFA\u597D\u5C0F\u7A0B\u5E8F,"),t("a",{href:"https://mp.weixin.qq.com/",class:"",target:"_blank"},"\u300B\u300B\u5FAE\u4FE1\u516C\u4F17\u53F7\u5E73\u53F0 ")],-1),Rt={key:0,class:"px-5 pt-5 mt-5 intro-y box"},qt={class:"flex flex-col pb-5 -mx-5 border-b border-slate-200/60 dark:border-darkmode-400 lg:flex-row"},It={class:"flex items-center justify-center flex-1 px-5 lg:justify-start"},Pt={class:"relative flex-none w-20 h-20 image-fit sm:h-24 sm:w-24 lg:h-32 lg:w-32"},Vt=["alt","src"],Gt={class:"absolute bottom-0 right-0 flex items-center justify-center p-2 mb-1 mr-1 rounded-full bg-primary"},Ot={class:"ml-5"},Ht={class:"w-24 text-lg font-medium truncate sm:w-40 sm:whitespace-normal"},Kt={class:"text-slate-500"},Zt={class:"flex-1 px-5 pt-5 mt-6 border-t border-l border-r border-slate-200/60 dark:border-darkmode-400 lg:mt-0 lg:border-t-0 lg:pt-0"},Jt=t("div",{class:"font-medium text-center lg:mt-3 lg:text-left"}," \u8BE6\u60C5 ",-1),Qt={class:"flex flex-col items-center justify-center mt-4 lg:items-start"},Wt={class:"flex items-center truncate sm:whitespace-normal"},Xt={class:"flex items-center mt-3 truncate sm:whitespace-normal"},Yt={class:"flex items-center mt-3 truncate sm:whitespace-normal"},te={class:"flex items-center mt-3 truncate sm:whitespace-normal"},ee={class:"flex-1 px-5 pt-5 mt-6 border-t border-slate-200/60 dark:border-darkmode-400 lg:mt-0 lg:border-0 lg:pt-0"},se=t("div",{class:"font-medium text-center lg:mt-5 lg:text-left"}," \u4ECB\u7ECD ",-1),ie={class:"flex items-center justify-center mt-2 lg:justify-start"},ae={class:"flex mr-2"},oe=t("h2",{class:"mt-10 text-lg font-medium intro-y"},"\u6388\u6743\u5217\u8868",-1),ue={class:"col-span-12 overflow-auto intro-y lg:overflow-visible"},ne={class:"table -mt-2 table-report"},re=t("thead",null,[t("tr",null,[t("th",{class:"whitespace-nowrap"},"\u5934\u50CF"),t("th",{class:"whitespace-nowrap"},"\u540D\u79F0"),t("th",{class:"text-center whitespace-nowrap"},"\u5B9E\u540D\u8BA4\u8BC1"),t("th",{class:"text-center whitespace-nowrap"},"\u6388\u6743\u65F6\u95F4"),t("th",{class:"text-center whitespace-nowrap"},"\u8D26\u53F7\u7C7B\u578B"),t("th",{class:"text-center whitespace-nowrap"},"\u5F53\u524D\u7248\u672C"),t("th",{class:"text-center whitespace-nowrap"},"\u72B6\u6001"),t("th",{class:"text-center whitespace-nowrap"}),t("th",{class:"text-center whitespace-nowrap"})])],-1),le={class:"w-20"},ce={class:"flex"},me={class:"w-10 h-10 image-fit zoom-in"},de={href:"",class:"font-medium whitespace-nowrap"},_e={class:"mt-0.5 whitespace-nowrap text-xs text-slate-500"},pe={class:"mt-0.5 whitespace-nowrap text-xs text-slate-400"},he={class:"text-center"},fe={class:"text-center w-60"},ge={class:"w-40"},we={class:"flex items-center justify-center text-success"},xe={class:"text-center"},be={class:"w-40"},ve={class:"flex items-center justify-center"},Fe={class:"w-36 table-report__action"},ye={key:0,class:"flex flex-col items-center justify-center"},Ee=["onClick"],Be={key:0,class:"text-[9px] text-red-500"},Ae={class:"w-24 table-report__action"},Ce={class:"flex items-center justify-center"},De=["href"],ke=S({__name:"dashboard",setup(d){const s=z({miniprogram:{authorizer_appid:"",account_type:0,principal_type:"",auth_time:0,nick:"",head_img:"",principal_name:"",realname_status:"",signature:""},authorize_url:"",items:[],templates:[],logs:[],modal:{template:!1},template:{template_id:0,user_version:""},confirmLoading:!1}),w=N(),e=N(),i=N(),x=j(()=>{if(s.miniprogram.account_type){if(s.miniprogram.account_type===0)return"\u8BA2\u9605\u53F7";if(s.miniprogram.account_type===1)return"\u8001\u8BA2\u9605\u53F7";if(s.miniprogram.account_type===2)return"\u670D\u52A1\u53F7";if(s.miniprogram.account_type===3)return"\u5C0F\u7A0B\u5E8F"}return""});Y(()=>{L()});const L=()=>{h()},h=()=>{J({platform_type:100}).then(o=>{o.data.item&&(s.miniprogram=o.data.item),o.data.authorize_url&&(s.authorize_url=o.data.authorize_url),o.message&&v.success(o.message)}),st({platform_type:100}).then(o=>{o.data.items&&(s.items=o.data.items)}),E()},E=()=>{Q({platform_type:100}).then(o=>{o.data.items&&(s.templates=o.data.items),o.data.template&&(s.template=o.data.template)})},b=o=>{w.value.show(o)},l=(o,_)=>{i.value.show(o,_)};return(o,_)=>{const B=F("CameraIcon"),n=F("Tippy"),m=F("h-card");return r(),c(M,null,[f(m,{bordered:!1,title:"\u5C0F\u7A0B\u5E8F\u6388\u6743"},{default:y(()=>[t("div",jt,[t("div",Mt,[t("div",Tt,[t("a",{class:"btn btn-primary",target:"_blank",href:s.authorize_url,onClick:_[0]||(_[0]=u=>b({title:"\u6388\u6743\u786E\u8BA4",content:"\u786E\u8BA4\u6388\u6743\u5B8C\u6210"}))}," \u6388\u6743\u516C\u4F17\u53F7\\\u5C0F\u7A0B\u5E8F ",8,Nt),St])])]),s.miniprogram.authorizer_appid.length>0?(r(),c("div",Rt,[t("div",qt,[t("div",It,[t("div",Pt,[t("img",{alt:s.miniprogram.nick,class:"rounded-full",src:s.miniprogram.head_img},null,8,Vt),t("div",Gt,[f(B,{class:"w-4 h-4 text-white"})])]),t("div",Ot,[t("div",Ht,a(s.miniprogram.nick),1),t("div",Kt,a(s.miniprogram.authorizer_appid),1)])]),t("div",Zt,[Jt,t("div",Qt,[t("div",Wt," \u4E3B\u4F53\u540D\u79F0:"+a(s.miniprogram.principal_name),1),t("div",Xt," \u5B9E\u540D\u8BA4\u8BC1: "+a(s.miniprogram.realname_status=="1"?"\u662F":"\u5426"),1),t("div",Yt," \u6388\u6743\u65F6\u95F4: "+a(g(G)(s.miniprogram.auth_time)),1),t("div",te," \u8D26\u53F7\u7C7B\u578B: "+a(g(x)),1)])]),t("div",ee,[se,t("div",ie,[t("div",ae,a(s.miniprogram.signature),1)])])])])):p("v-if",!0),oe,p(" BEGIN: Data List "),t("div",ue,[t("table",ne,[re,t("tbody",null,[(r(!0),c(M,null,R(s.items,(u,$)=>(r(),c("tr",{key:$,class:"intro-x"},[t("td",le,[t("div",ce,[t("div",me,[f(n,{tag:"img",alt:u.nick,class:"rounded-full",src:u.head_img,content:`${u.nick}`},null,8,["alt","src","content"])])])]),t("td",null,[t("a",de,a(u.nick),1),t("div",_e,a(u.principal_name),1),t("div",pe,a(u.authorizer_appid),1)]),t("td",he,a(u.realname_status=="1"?"\u662F":"\u5426"),1),t("td",fe,a(g(G)(u.auth_time)),1),t("td",ge,[t("div",we,a(u.account_type===0?"\u8BA2\u9605\u53F7":u.account_type===1?"\u8001\u8BA2\u9605\u53F7":u.account_type===2?"\u670D\u52A1\u53F7":u.account_type===3?"\u5C0F\u7A0B\u5E8F":""),1)]),t("td",xe,a(u.version),1),t("td",be,[t("div",ve,a(u.status===0?"\u672A\u4E0A\u7EBF":u.status===1?"\u5BA1\u6838\u4E2D":u.status===2?"\u5BA1\u6838\u901A\u8FC7":u.status===3?"\u4E0A\u7EBF":""),1)]),t("td",Fe,[u.account_type===3?(r(),c("div",ye,[t("a",{class:"flex items-center mr-3 hover:text-red-500",href:"javascript:void(0)",onClick:H(U=>l(u,s.template),["stop"])}," \u6A21\u7248\u7BA1\u7406 ",8,Ee),s.template.template_id!=u.template_id?(r(),c("span",Be,"\u6700\u65B0\u7248\u672C("+a(s.template.user_version)+")",1)):p("v-if",!0)])):p("v-if",!0)]),t("td",Ae,[t("div",Ce,[t("a",{class:"flex items-center hover:text-red-500",target:"_blank",href:s.authorize_url,onClick:_[1]||(_[1]=U=>b({title:"\u6388\u6743\u786E\u8BA4",content:"\u786E\u8BA4\u6388\u6743\u5B8C\u6210"}))}," \u6388\u6743 ",8,De)])])]))),128))])])]),p(" END: Data List ")]),_:1}),f(et,{ref_key:"confirmModal",ref:w,onOk:h},null,512),f(ht,{ref_key:"templateModal",ref:e,onOk:h,onSubmit:l},null,512),f(Ut,{ref_key:"logModal",ref:i,onOk:h},null,512)],64)}}}),$e=q(ke,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/miniprogram/dashboard.vue"]]);export{$e as default};
