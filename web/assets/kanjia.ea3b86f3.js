import{h as U,j as x,o as Q,k as z,t as R,v as q,a as E,b as O,w as a,l as t,p as o,x as b,z as X,y as v,a2 as ee,c as $,F as V,u as B,q as Y,s as d,n as T,e as te,a3 as S,a4 as N,Y as I,D as W,Z as G,C,d as w,$ as P,a1 as H}from"./index.35f51f2d.js";import{g as oe,u as ae,c as ne,b as Z}from"./market.4608e9b1.js";import{p as J}from"./pick.8e71f98c.js";const le={class:"form-check form-switch"},ue=t("div",{class:"form-help"},"\u65B9\u4FBF\u7528\u6237\u8054\u7CFB\u7684\u5FAE\u4FE1\u5BA2\u670D\u5E10\u53F7",-1),se=t("option",{value:0},"\u4F63\u91D1\u5956\u52B1",-1),ie=t("option",{value:1},"\u514D\u5355\u6A21\u5F0F",-1),re=[se,ie],me={class:"input-group"},de=t("div",{class:"input-group-text"},"\u4EBA",-1),ce=t("div",{class:"form-help"},"\u6BCF\u4E2A\u5546\u54C1\u9700\u8981\u780D\u4EF7\u4EBA\u6570",-1),fe={class:"input-group"},_e=t("div",{class:"input-group-text"},"%",-1),pe=t("div",{class:"form-help"},"\u6BCF\u780D\u4E00\u6B21\u780D\u6389\u7684\u4F63\u91D1\u767E\u5206\u6BD4",-1),be={class:"input-group"},ge=t("div",{class:"input-group-text"},"\u5143",-1),De=t("div",{class:"form-help"},"\u6BCF\u780D\u4E00\u6B21\u780D\u6389\u7684\u6700\u5C0F\u91D1\u989D",-1),he={class:"input-group"},ve=t("div",{class:"input-group-text"},"\u5143",-1),ye=t("div",{class:"form-help"},"\u6BCF\u780D\u4E00\u6B21\u780D\u6389\u7684\u6700\u5927\u91D1\u989D",-1),Fe=U({__name:"data",emits:["ok"],setup(M,{expose:y,emit:F}){const e=x({weixin:"",mode:0,members:0,commission_rate:0,money1:0,money2:0,status:!1}),k={},i=x({visible:!1,confirmLoading:!1});Q(()=>{_()});const D=z(k,R(e)),_=()=>{g()},g=()=>{oe({market_code:"kanjia"}).then(f=>{f.data.item&&q(()=>{const u=J(f.data.item,["weixin","mode","members","commission_rate","money1","money2"]);Object.assign(e,u),u.status=f.data.item.status===1})})},h=f=>{if(f.preventDefault(),D.value.$touch(),D.value.$invalid)D.value.$errors;else{const u=B(e);ae(Object.assign(u,{market_code:"kanjia",status:e.status?1:0})).then(m=>{const{code:r}=m||{};r===0?(Y.success("\u4FDD\u5B58\u6210\u529F"),F("ok",{})):Y.error(m.message)})}},n=()=>{i.visible=!1};return y({edit:()=>{i.visible=!0}}),(f,u)=>{const m=d("h-form-item"),r=d("h-form"),c=d("h-drawer");return E(),O(c,{title:"\u8BBE\u7F6E",visible:i.visible,"confirm-loading":i.confirmLoading,onCancel:n},{footer:a(()=>[t("button",{class:"w-24 mb-2 mr-1 btn btn-primary",onClick:h},"\u4FDD\u5B58")]),default:a(()=>[o(r,{layout:"small"},{default:a(()=>[o(m,{label:"\u5168\u573A\u6D3B\u52A8",content:"",layout:"small"},{default:a(()=>[t("div",le,[b(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":u[0]||(u[0]=s=>e.status=s)},null,512),[[X,e.status]])])]),_:1}),o(m,{label:"\u5BA2\u670D\u5FAE\u4FE1",content:"",layout:"small"},{default:a(()=>[b(t("input",{type:"text",class:"form-control","onUpdate:modelValue":u[1]||(u[1]=s=>e.weixin=s)},null,512),[[v,e.weixin]]),ue]),_:1}),o(m,{label:"\u780D\u4EF7\u6A21\u5F0F",content:"",layout:"small"},{default:a(()=>[b(t("select",{class:"form-select","onUpdate:modelValue":u[2]||(u[2]=s=>e.mode=s)},re,512),[[ee,e.mode]])]),_:1}),e.mode==0?(E(),$(V,{key:0},[o(m,{label:"\u780D\u4EF7\u4EBA\u6570",content:"",layout:"small"},{default:a(()=>[t("div",me,[b(t("input",{type:"text",class:"form-control","onUpdate:modelValue":u[3]||(u[3]=s=>e.members=s)},null,512),[[v,e.members]]),de]),ce]),_:1}),o(m,{label:"\u780D\u4E00\u6B21\u91D1\u989D",content:"",layout:"small"},{default:a(()=>[t("div",fe,[b(t("input",{type:"text",class:"form-control","onUpdate:modelValue":u[4]||(u[4]=s=>e.commission_rate=s)},null,512),[[v,e.commission_rate]]),_e]),pe]),_:1})],64)):(E(),$(V,{key:1},[o(m,{label:"\u6700\u5C0F\u91D1\u989D",content:"",layout:"small"},{default:a(()=>[t("div",be,[b(t("input",{type:"text",class:"form-control","onUpdate:modelValue":u[5]||(u[5]=s=>e.money1=s)},null,512),[[v,e.money1]]),ge]),De]),_:1}),o(m,{label:"\u6700\u5927\u91D1\u989D",content:"",layout:"small"},{default:a(()=>[t("div",he,[b(t("input",{type:"text",class:"form-control","onUpdate:modelValue":u[6]||(u[6]=s=>e.money2=s)},null,512),[[v,e.money2]]),ve]),ye]),_:1})],64))]),_:1})]),_:1},8,["visible","confirm-loading"])}}}),ke=U({__name:"kanjia",emits:["ok"],setup(M,{expose:y,emit:F}){const e=x({item_id:"",commission_rate:0,members:0,start_time:"",end_time:""}),k={},i=x({visible:!1,confirmLoading:!1}),D=()=>{i.visible=!1},_=z(k,R(e)),g=n=>{i.visible=!0,q(()=>{const l=J(n,["item_id","commission_rate","members"]);Object.assign(e,l),e.start_time=S(n.start_time),e.end_time=S(n.end_time)})},h=()=>{if(i.confirmLoading=!0,_.value.$touch(),_.value.$invalid)_.value.$errors,i.confirmLoading=!1;else{let n=B(e);n.start_time&&(n=Object.assign(n,{start_time:N(n.start_time)})),n.end_time&&(n=Object.assign(n,{end_time:N(n.end_time)})),ne(Object.assign(n,{type:"kanjia"})).then(l=>{const{code:f}=l||{};f===0?Y.success("\u4FDD\u5B58\u6210\u529F"):Y.error(l.message),i.confirmLoading=!1,F("ok",n),i.visible=!1})}};return y({edit:g}),(n,l)=>{const f=d("AlertCircleIcon"),u=d("Alert"),m=d("h-form-item"),r=d("Litepicker"),c=d("h-form"),s=d("h-spin"),j=d("LoadingIcon"),L=d("h-modal");return E(),O(L,{title:"\u53D1\u5E03\u5546\u54C1",size:"modal-lg",visible:i.visible,"confirm-loading":i.confirmLoading,onCancel:D},{footer:a(()=>[t("button",{class:"w-24 mb-2 mr-1 btn btn-primary",onClick:l[5]||(l[5]=p=>h())},[T(" \u63D0\u4EA4\u53D1\u5E03 "),i.confirmLoading?(E(),O(j,{key:0,icon:"oval",color:"white",class:"w-4 h-4 ml-2"})):te("",!0)])]),default:a(()=>[o(s,{spinning:i.confirmLoading},{default:a(()=>[o(c,{layout:"small"},{default:a(()=>[o(u,{class:"flex items-center mb-2 alert-outline-primary"},{default:a(()=>[o(f,{class:"w-6 h-6 mr-2"}),T(" \u6CE8\u610F\u63D0\u793A\uFF1A \u7528\u6237\u83B7\u53D6\u7684\u603B\u780D\u4EF7=\u4F63\u91D1*\u5355\u6B21\u780D\u4EF7\u4F63\u91D1\u6BD4\u4F8B*\u780D\u4EF7\u6B21\u6570 ")]),_:1}),o(m,{label:"\u5546\u54C1id",content:"",layout:"small"},{default:a(()=>[b(t("input",{type:"text",class:"form-control","onUpdate:modelValue":l[0]||(l[0]=p=>e.item_id=p)},null,512),[[v,e.item_id]])]),_:1}),o(m,{label:"\u5355\u6B21\u780D\u4EF7\u4F63\u91D1\u6BD4\u4F8B",content:"",layout:"small"},{default:a(()=>[b(t("input",{type:"text",class:"form-control","onUpdate:modelValue":l[1]||(l[1]=p=>e.commission_rate=p)},null,512),[[v,e.commission_rate]])]),_:1}),o(m,{label:"\u780D\u4EF7\u4EBA\u6570",content:"",layout:"small"},{default:a(()=>[b(t("input",{type:"text",class:"form-control","onUpdate:modelValue":l[2]||(l[2]=p=>e.members=p)},null,512),[[v,e.members]])]),_:1}),o(m,{label:"\u5F00\u59CB\u65F6\u95F4",content:"",layout:"small"},{default:a(()=>[o(r,{modelValue:e.start_time,"onUpdate:modelValue":l[3]||(l[3]=p=>e.start_time=p),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"block w-56 mx-auto form-control"},null,8,["modelValue"])]),_:1}),o(m,{label:"\u7ED3\u675F\u65F6\u95F4",content:"",layout:"small"},{default:a(()=>[o(r,{modelValue:e.end_time,"onUpdate:modelValue":l[4]||(l[4]=p=>e.end_time=p),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"block w-56 mx-auto form-control"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["spinning"])]),_:1},8,["visible","confirm-loading"])}}}),we=U({__name:"items",emits:["ok"],setup(M,{expose:y,emit:F}){const e=I(),k=W(()=>`${e.urlPrefix}${e.apiUrl}${Z.getItems}`),i=G({}),D=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"\u6807\u9898",field:"goods.title",formatter(r){return w(`<a target="_blank" href="${r.getData().goods.item_url}">
          ${r.getData().goods.title}
        </a>`)[0]}},{title:"\u4EF7\u683C",field:"goods.price",width:50},{title:"\u56FE\u7247",field:"pic_url",width:100,formatter(r){return w(`<a target="_blank" href="${r.getData().item_url}">
          <img src="${r.getData().goods.pic_url}" />
        </a>`)[0]}},{title:"\u9500\u91CF",field:"goods.volume",width:50},{title:"\u5355\u6B21\u780D\u6BD4\u4F8B",field:"commission_rate",width:100},{title:"\u780D\u4EF7\u4EBA\u6570",field:"members",width:80},{title:"\u65F6\u95F4",field:"",width:140,formatter(r){return w(`<p>${P(r.getData().start_time)}</p>
        <p>${P(r.getData().end_time)}</p>`)[0]}},{title:"\u64CD\u4F5C",field:"action",width:120,formatter(r){const c=w('<a class="flex items-center" href="javascript:;">\u7F16\u8F91</a>');return w(c).on("click",function(s){f(r.getData())}),c[0]}}],_=x({type:"kanjia",rangePicker:"",name:"",status:0,startTime:"",endTime:""}),g=x({visible:!1,confirmLoading:!1}),h=C(),n=C(),l=()=>{h.value.reload(!0)},f=r=>{n.value.edit(r)},u=()=>{g.visible=!1,F("ok",{})};return y({show:()=>{g.visible=!0}}),(r,c)=>{const s=d("h-form-item"),j=d("Litepicker"),L=d("h-form"),p=H,K=d("h-drawer");return E(),$(V,null,[o(K,{title:"\u4E13\u4EAB\u4EA7\u54C1",size:"modal-xl",visible:g.visible,"confirm-loading":g.confirmLoading,onCancel:u},{header:a(()=>[t("button",{class:"mr-2 shadow-md btn btn-primary",onClick:c[0]||(c[0]=A=>n.value.edit({}))},"\u53D1\u5E03\u780D\u4EF7\u5546\u54C1 ")]),default:a(()=>[o(p,{ref_key:"tableRef",ref:h,columns:D,ajaxUrl:B(k),config:B(i),queryParam:_},{search:a(()=>[o(L,{layout:"inline"},{default:a(()=>[o(s,{label:"\u7528\u6237\u540D",content:"",layout:"inline"},{default:a(()=>[b(t("input",{"onUpdate:modelValue":c[1]||(c[1]=A=>_.name=A),type:"text",class:"mt-2 form-control sm:mt-0 sm:w-40 2xl:w-full"},null,512),[[v,_.name]])]),_:1}),o(s,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:a(()=>[o(j,{modelValue:_.rangePicker,"onUpdate:modelValue":c[2]||(c[2]=A=>_.rangePicker=A),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"mt-2 form-control sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),t("div",{class:"mt-2 xl:mt-0"},[t("button",{type:"button",class:"w-full btn btn-primary sm:w-16",onClick:l}," \u67E5\u8BE2 ")])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1},8,["visible","confirm-loading"]),o(ke,{ref_key:"modal",ref:n,onOk:l},null,512)],64)}}}),Ce=U({__name:"kanjia",setup(M){const y=I(),F=W(()=>`${y.urlPrefix}${y.apiUrl}${Z.shares}`),e=G({}),k=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"\u6807\u9898",field:"goods.title",formatter(n){return w(`<a target="_blank" href="${n.getData().goods.item_url}">
          ${n.getData().goods.title}
        </a>`)[0]}},{title:"\u4EF7\u683C",field:"goods.price",width:100},{title:"\u56FE\u7247",field:"pic_url",width:100,formatter(n){return w(`<a target="_blank" href="${n.getData().item_url}">
          <img src="${n.getData().goods.pic_url}" />
        </a>`)[0]}},{title:"\u5206\u4EAB\u4EBA",field:"member.user_name",width:100},{title:"\u53C2\u4E0E\u4EBA\u6B21",field:"invites",width:100},{title:"\u65F6\u95F4",field:"created_at",formatter(n){return P(n.getData().created_at,"YY-MM-DD HH:mm")},width:140}],i=x({market_code:"kanjia",rangePicker:"",name:"",status:0,startTime:"",endTime:""}),D=C(),_=C(),g=C(),h=()=>{D.value.reload(!0)};return(n,l)=>{const f=d("h-form-item"),u=d("Litepicker"),m=d("h-form"),r=H,c=d("h-card");return E(),$(V,null,[o(c,{bordered:!1,title:"\u4E13\u9898"},{header:a(()=>[t("button",{class:"mr-2 shadow-md btn btn-primary",onClick:l[0]||(l[0]=s=>g.value.show({}))},"\u63A8\u8350\u4EA7\u54C1 "),t("button",{class:"mr-2 shadow-md btn btn-primary",onClick:l[1]||(l[1]=s=>_.value.edit({}))},"\u8BBE\u7F6E ")]),default:a(()=>[o(r,{ref_key:"tableRef",ref:D,columns:k,ajaxUrl:B(F),config:B(e),queryParam:i},{search:a(()=>[o(m,{layout:"inline"},{default:a(()=>[o(f,{label:"\u7528\u6237\u540D",content:"",layout:"inline"},{default:a(()=>[b(t("input",{"onUpdate:modelValue":l[2]||(l[2]=s=>i.name=s),type:"text",class:"mt-2 form-control sm:mt-0 sm:w-40 2xl:w-full"},null,512),[[v,i.name]])]),_:1}),o(f,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:a(()=>[o(u,{modelValue:i.rangePicker,"onUpdate:modelValue":l[3]||(l[3]=s=>i.rangePicker=s),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"mt-2 form-control sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),t("div",{class:"mt-2 xl:mt-0"},[t("button",{type:"button",class:"w-full btn btn-primary sm:w-16",onClick:h}," \u67E5\u8BE2 ")])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1}),o(Fe,{ref_key:"dataModal",ref:_,onOk:h},null,512),o(we,{ref_key:"itemsModal",ref:g,onOk:h},null,512)],64)}}});export{Ce as default};
