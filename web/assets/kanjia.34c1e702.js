import{h as U,j as B,o as Z,k as S,t as N,v as z,a as E,b as P,w as n,l as e,p as o,x as g,z as J,y as v,a2 as K,c as $,F as V,u as x,q as Y,s as d,n as O,e as Q,$ as T,Y as R,D as q,Z as I,C,d as w,a1 as W}from"./index.68db354d.js";import{g as X,u as ee,c as te,b as G}from"./market.29c32e99.js";import{p as H}from"./pick.3bd8489a.js";const oe={class:"form-check form-switch"},ne=e("div",{class:"form-help"},"\u65B9\u4FBF\u7528\u6237\u8054\u7CFB\u7684\u5FAE\u4FE1\u5BA2\u670D\u5E10\u53F7",-1),ue=e("option",{value:0},"\u4F63\u91D1\u5956\u52B1",-1),le=e("option",{value:1},"\u514D\u5355\u6A21\u5F0F",-1),ae=[ue,le],se={class:"input-group"},ie=e("div",{class:"input-group-text"},"\u4EBA",-1),re=e("div",{class:"form-help"},"\u6BCF\u4E2A\u5546\u54C1\u9700\u8981\u780D\u4EF7\u4EBA\u6570",-1),me={class:"input-group"},de=e("div",{class:"input-group-text"},"%",-1),ce=e("div",{class:"form-help"},"\u6BCF\u780D\u4E00\u6B21\u780D\u6389\u7684\u4F63\u91D1\u767E\u5206\u6BD4",-1),fe={class:"input-group"},pe=e("div",{class:"input-group-text"},"\u5143",-1),_e=e("div",{class:"form-help"},"\u6BCF\u780D\u4E00\u6B21\u780D\u6389\u7684\u6700\u5C0F\u91D1\u989D",-1),be={class:"input-group"},ge=e("div",{class:"input-group-text"},"\u5143",-1),De=e("div",{class:"form-help"},"\u6BCF\u780D\u4E00\u6B21\u780D\u6389\u7684\u6700\u5927\u91D1\u989D",-1),he=U({__name:"data",setup(M,{expose:k}){const l=B({weixin:"",mode:0,members:0,commission_rate:0,money1:0,money2:0,status:!1}),m={},h=B({visible:!1,confirmLoading:!1});Z(()=>{_()});const i=S(m,N(l)),_=()=>{p()},p=()=>{X({market_code:"kanjia"}).then(t=>{t.data.item&&z(()=>{const u=H(t.data.item,["weixin","mode","members","commission_rate","money1","money2"]);Object.assign(l,u),u.status=t.data.item.status===1})})},y=t=>{if(t.preventDefault(),i.value.$touch(),i.value.$invalid)i.value.$errors;else{const u=x(l);ee(Object.assign(u,{market_code:"kanjia",status:l.status?1:0})).then(f=>{const{code:a}=f||{};a===0?Y.success("\u4FDD\u5B58\u6210\u529F"):Y.error(f.message)})}},D=()=>{h.visible=!1};return k({edit:()=>{h.visible=!0}}),(t,u)=>{const f=d("h-form-item"),a=d("h-form"),c=d("h-drawer");return E(),P(c,{title:"\u8BBE\u7F6E",visible:h.visible,"confirm-loading":h.confirmLoading,onCancel:D},{footer:n(()=>[e("button",{class:"w-24 mb-2 mr-1 btn btn-primary",onClick:y},"\u4FDD\u5B58")]),default:n(()=>[o(a,{layout:"small"},{default:n(()=>[o(f,{label:"\u5168\u573A\u6D3B\u52A8",content:"",layout:"small"},{default:n(()=>[e("div",oe,[g(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":u[0]||(u[0]=r=>l.status=r)},null,512),[[J,l.status]])])]),_:1}),o(f,{label:"\u5BA2\u670D\u5FAE\u4FE1",content:"",layout:"small"},{default:n(()=>[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":u[1]||(u[1]=r=>l.weixin=r)},null,512),[[v,l.weixin]]),ne]),_:1}),o(f,{label:"\u780D\u4EF7\u6A21\u5F0F",content:"",layout:"small"},{default:n(()=>[g(e("select",{class:"form-select","onUpdate:modelValue":u[2]||(u[2]=r=>l.mode=r)},ae,512),[[K,l.mode]])]),_:1}),l.mode==0?(E(),$(V,{key:0},[o(f,{label:"\u780D\u4EF7\u4EBA\u6570",content:"",layout:"small"},{default:n(()=>[e("div",se,[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":u[3]||(u[3]=r=>l.members=r)},null,512),[[v,l.members]]),ie]),re]),_:1}),o(f,{label:"\u780D\u4E00\u6B21\u91D1\u989D",content:"",layout:"small"},{default:n(()=>[e("div",me,[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":u[4]||(u[4]=r=>l.commission_rate=r)},null,512),[[v,l.commission_rate]]),de]),ce]),_:1})],64)):(E(),$(V,{key:1},[o(f,{label:"\u6700\u5C0F\u91D1\u989D",content:"",layout:"small"},{default:n(()=>[e("div",fe,[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":u[5]||(u[5]=r=>l.money1=r)},null,512),[[v,l.money1]]),pe]),_e]),_:1}),o(f,{label:"\u6700\u5927\u91D1\u989D",content:"",layout:"small"},{default:n(()=>[e("div",be,[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":u[6]||(u[6]=r=>l.money2=r)},null,512),[[v,l.money2]]),ge]),De]),_:1})],64))]),_:1})]),_:1},8,["visible","confirm-loading"])}}}),ve=U({__name:"kanjia",emits:["ok"],setup(M,{expose:k,emit:l}){const m=B({num_iid:"",commission_rate:0,members:0,start_time:"",end_time:""}),h={},i=B({visible:!1,confirmLoading:!1}),_=()=>{i.visible=!1},p=S(h,N(m)),y=s=>{i.visible=!0,z(()=>{const t=H(s,["num_iid","commission_rate","members","start_time","end_time"]);Object.assign(m,t)})},D=()=>{if(i.confirmLoading=!0,p.value.$touch(),p.value.$invalid)p.value.$errors,i.confirmLoading=!1;else{let s=x(m);s.start_time&&(s.start_time=T(s.start_time)),s.end_time&&(s.end_time=T(s.end_time)),te(Object.assign(s,{type:"kanjia"})).then(t=>{const{code:u}=t||{};u===0?Y.success("\u4FDD\u5B58\u6210\u529F"):Y.error(t.message),i.confirmLoading=!1,l("ok",s),i.visible=!1})}};return k({edit:y}),(s,t)=>{const u=d("AlertCircleIcon"),f=d("Alert"),a=d("h-form-item"),c=d("Litepicker"),r=d("h-form"),F=d("h-spin"),j=d("LoadingIcon"),L=d("h-modal");return E(),P(L,{title:"\u53D1\u5E03\u5546\u54C1",size:"modal-lg",visible:i.visible,"confirm-loading":i.confirmLoading,onCancel:_},{footer:n(()=>[e("button",{class:"btn btn-primary mb-2 mr-1 w-24",onClick:t[5]||(t[5]=b=>D())},[O(" \u63D0\u4EA4\u53D1\u5E03 "),i.confirmLoading?(E(),P(j,{key:0,icon:"oval",color:"white",class:"ml-2 h-4 w-4"})):Q("",!0)])]),default:n(()=>[o(F,{spinning:i.confirmLoading},{default:n(()=>[o(r,{layout:"small"},{default:n(()=>[o(f,{class:"alert-outline-primary mb-2 flex items-center"},{default:n(()=>[o(u,{class:"mr-2 h-6 w-6"}),O(" \u6CE8\u610F\u63D0\u793A\uFF1A \u7528\u6237\u83B7\u53D6\u7684\u603B\u780D\u4EF7=\u4F63\u91D1*\u5355\u6B21\u780D\u4EF7\u4F63\u91D1\u6BD4\u4F8B*\u780D\u4EF7\u6B21\u6570 ")]),_:1}),o(a,{label:"\u5546\u54C1id",content:"",layout:"small"},{default:n(()=>[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=b=>m.num_iid=b)},null,512),[[v,m.num_iid]])]),_:1}),o(a,{label:"\u5355\u6B21\u780D\u4EF7\u4F63\u91D1\u6BD4\u4F8B",content:"",layout:"small"},{default:n(()=>[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=b=>m.commission_rate=b)},null,512),[[v,m.commission_rate]])]),_:1}),o(a,{label:"\u780D\u4EF7\u4EBA\u6570",content:"",layout:"small"},{default:n(()=>[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=b=>m.members=b)},null,512),[[v,m.members]])]),_:1}),o(a,{label:"\u5F00\u59CB\u65F6\u95F4",content:"",layout:"small"},{default:n(()=>[o(c,{modelValue:m.start_time,"onUpdate:modelValue":t[3]||(t[3]=b=>m.start_time=b),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"form-control mx-auto block w-56"},null,8,["modelValue"])]),_:1}),o(a,{label:"\u7ED3\u675F\u65F6\u95F4",content:"",layout:"small"},{default:n(()=>[o(c,{modelValue:m.end_time,"onUpdate:modelValue":t[4]||(t[4]=b=>m.end_time=b),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"form-control mx-auto block w-56"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["spinning"])]),_:1},8,["visible","confirm-loading"])}}}),ye=U({__name:"items",setup(M,{expose:k}){const l=R(),m=q(()=>`${l.urlPrefix}${l.apiUrl}${G.getItems}`),h=I({}),i=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"\u6807\u9898",field:"goods.title",formatter(a){return w(`<a target="_blank" href="${a.getData().goods.item_url}">
          ${a.getData().goods.title}
        </a>`)[0]}},{title:"\u4EF7\u683C",field:"goods.price",width:50},{title:"\u56FE\u7247",field:"pic_url",width:100,formatter(a){return w(`<a target="_blank" href="${a.getData().item_url}">
          <img src="${a.getData().goods.pic_url}" />
        </a>`)[0]}},{title:"\u9500\u91CF",field:"goods.volume",width:50},{title:"\u5355\u6B21\u780D\u6BD4\u4F8B",field:"commission_rate",width:100},{title:"\u780D\u4EF7\u4EBA\u6570",field:"members",width:80},{title:"\u65F6\u95F4",field:"",width:140,formatter(a){return w(`<p>${a.getData().start_time}</p>
        <p>${a.getData().end_time}</p>`)[0]}},{title:"\u64CD\u4F5C",field:"action",width:120,formatter(a){const c=w('<a class="flex items-center" href="javascript:;">\u7F16\u8F91</a>');return w(c).on("click",function(r){t(a.getData())}),c[0]}}],_=B({type:"kanjia",rangePicker:"",username:"",status:0,startTime:"",endTime:""}),p=B({visible:!1,confirmLoading:!1}),y=C(),D=C(),s=()=>{y.value.reload(!0)},t=a=>{D.value.edit(a)},u=()=>{p.visible=!1};return k({show:()=>{p.visible=!0}}),(a,c)=>{const r=d("h-form-item"),F=d("Litepicker"),j=d("h-form"),L=W,b=d("h-drawer");return E(),$(V,null,[o(b,{title:"\u4E13\u4EAB\u4EA7\u54C1",size:"modal-xl",visible:p.visible,"confirm-loading":p.confirmLoading,onCancel:u},{header:n(()=>[e("button",{class:"btn btn-primary mr-2 shadow-md",onClick:c[0]||(c[0]=A=>D.value.edit({}))},"\u53D1\u5E03\u780D\u4EF7\u5546\u54C1 ")]),default:n(()=>[o(L,{ref_key:"tableRef",ref:y,columns:i,ajaxUrl:x(m),config:x(h),queryParam:_},{search:n(()=>[o(j,{layout:"inline"},{default:n(()=>[o(r,{label:"\u7528\u6237\u540D",content:"",layout:"inline"},{default:n(()=>[g(e("input",{"onUpdate:modelValue":c[1]||(c[1]=A=>_.username=A),type:"text",class:"form-control mt-2 sm:mt-0 sm:w-40 2xl:w-full"},null,512),[[v,_.username]])]),_:1}),o(r,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:n(()=>[o(F,{modelValue:_.rangePicker,"onUpdate:modelValue":c[2]||(c[2]=A=>_.rangePicker=A),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"form-control mt-2 sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),e("div",{class:"mt-2 xl:mt-0"},[e("button",{type:"button",class:"btn btn-primary w-full sm:w-16",onClick:s}," \u67E5\u8BE2 ")])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1},8,["visible","confirm-loading"]),o(ve,{ref_key:"modal",ref:D,onOk:s},null,512)],64)}}}),Ee=U({__name:"kanjia",setup(M){const k=R(),l=q(()=>`${k.urlPrefix}${k.apiUrl}${G.shares}`),m=I({}),h=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"\u6807\u9898",field:"goods.title",formatter(s){return w(`<a target="_blank" href="${s.getData().goods.item_url}">
          ${s.getData().goods.title}
        </a>`)[0]}},{title:"\u4EF7\u683C",field:"goods.price",width:100},{title:"\u56FE\u7247",field:"pic_url",width:100,formatter(s){return w(`<a target="_blank" href="${s.getData().item_url}">
          <img src="${s.getData().goods.pic_url}" />
        </a>`)[0]}},{title:"\u5206\u4EAB\u4EBA",field:"member.user_name",width:100},{title:"\u53C2\u4E0E\u4EBA\u6B21",field:"invites",width:100},{title:"\u65F6\u95F4",field:"created_at",formatter(s){return T(s.getData().created_at,"YY-MM-DD HH:mm")},width:140}],i=B({market_code:"kanjia",rangePicker:"",username:"",status:0,startTime:"",endTime:""}),_=C(),p=C(),y=C(),D=()=>{_.value.reload(!0)};return(s,t)=>{const u=d("h-form-item"),f=d("Litepicker"),a=d("h-form"),c=W,r=d("h-card");return E(),$(V,null,[o(r,{bordered:!1,title:"\u4E13\u9898"},{header:n(()=>[e("button",{class:"btn btn-primary mr-2 shadow-md",onClick:t[0]||(t[0]=F=>y.value.show({}))},"\u63A8\u8350\u4EA7\u54C1 "),e("button",{class:"btn btn-primary mr-2 shadow-md",onClick:t[1]||(t[1]=F=>p.value.edit({}))},"\u8BBE\u7F6E ")]),default:n(()=>[o(c,{ref_key:"tableRef",ref:_,columns:h,ajaxUrl:x(l),config:x(m),queryParam:i},{search:n(()=>[o(a,{layout:"inline"},{default:n(()=>[o(u,{label:"\u7528\u6237\u540D",content:"",layout:"inline"},{default:n(()=>[g(e("input",{"onUpdate:modelValue":t[2]||(t[2]=F=>i.username=F),type:"text",class:"form-control mt-2 sm:mt-0 sm:w-40 2xl:w-full"},null,512),[[v,i.username]])]),_:1}),o(u,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:n(()=>[o(f,{modelValue:i.rangePicker,"onUpdate:modelValue":t[3]||(t[3]=F=>i.rangePicker=F),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"form-control mt-2 sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),e("div",{class:"mt-2 xl:mt-0"},[e("button",{type:"button",class:"btn btn-primary w-full sm:w-16",onClick:D}," \u67E5\u8BE2 ")])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1}),o(he,{ref_key:"dataModal",ref:p,onOk:D},null,512),o(ye,{ref_key:"itemsModal",ref:y,onOk:D},null,512)],64)}}});export{Ee as default};
