import{r as U,h as L,j as D,k as M,t as O,a as x,b as F,w as s,l as d,n as P,e as N,p as l,x as T,y as j,v as R,a3 as Y,u as C,a4 as V,q as S,s as r,Y as q,D as W,Z as z,C as $,c as I,F as G,d as b,a0 as B,a1 as Z}from"./index.a61f9404.js";import{p as H}from"./pick.e65abaad.js";const A={list:"/api/admin/activity/list",adds:"/api/admin/activity/adds",update:"/api/admin/activity/update"};function J(h){return U({timeout:6e4,url:A.adds,method:"post",data:h})}const K=L({__name:"edit",emits:["ok"],setup(h,{expose:f,emit:k}){const n=D({start_time:"",end_time:"",content:""}),v={},a=D({visible:!1,confirmLoading:!1}),_=()=>{a.visible=!1},i=M(v,O(n)),p=e=>{a.visible=!0,R(()=>{Object.assign(n,{start_time:"",end_time:"",content:""}),Object.assign(n,H(e,["content"])),n.start_time=Y(e.start_time),n.end_time=Y(e.end_time)})},o=e=>{if(a.confirmLoading=!0,i.value.$touch(),i.value.$invalid)i.value.$errors,a.confirmLoading=!1;else{let t=C(n);t.start_time&&(t=Object.assign(t,{start_time:V(t.start_time)})),t.end_time&&(t=Object.assign(t,{end_time:V(t.end_time)})),J(Object.assign(t,{plan:e})).then(()=>{S.success("\u53D1\u5E03\u6210\u529F"),a.confirmLoading=!1,k("ok",t),a.visible=!1})}};return f({edit:p}),(e,t)=>{const g=r("Litepicker"),c=r("h-form-item"),w=r("h-form"),y=r("h-spin"),u=r("LoadingIcon"),E=r("h-modal");return x(),F(E,{title:"\u6D3B\u52A8\u5546\u54C1",size:"modal-xl",visible:a.visible,"confirm-loading":a.confirmLoading,onCancel:_},{footer:s(()=>[d("button",{class:"w-24 mb-2 mr-1 btn btn-primary",onClick:t[3]||(t[3]=m=>o(11))},[P(" \u6279\u91CF\u6DFB\u52A0 "),a.confirmLoading?(x(),F(u,{key:0,icon:"oval",color:"white",class:"w-4 h-4 ml-2"})):N("",!0)])]),default:s(()=>[l(y,{spinning:a.confirmLoading},{default:s(()=>[l(w,{layout:"small"},{default:s(()=>[l(c,{label:"\u5F00\u59CB\u65F6\u95F4",content:"",layout:"small"},{default:s(()=>[l(g,{modelValue:n.start_time,"onUpdate:modelValue":t[0]||(t[0]=m=>n.start_time=m),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"block w-full mx-auto form-control"},null,8,["modelValue"])]),_:1}),l(c,{label:"\u7ED3\u675F\u65F6\u95F4",content:"",layout:"small"},{default:s(()=>[l(g,{modelValue:n.end_time,"onUpdate:modelValue":t[1]||(t[1]=m=>n.end_time=m),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"block w-full mx-auto form-control"},null,8,["modelValue"])]),_:1}),l(c,{label:"\u5185\u5BB9",content:"",layout:"small"},{default:s(()=>[T(d("textarea",{class:"form-control","onUpdate:modelValue":t[2]||(t[2]=m=>n.content=m),rows:8},null,512),[[j,n.content]])]),_:1})]),_:1})]),_:1},8,["spinning"])]),_:1},8,["visible","confirm-loading"])}}}),ee=L({__name:"activity",setup(h){const f=q(),k=W(()=>`${f.urlPrefix}${f.apiUrl}${A.list}`),n=z({}),v=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"\u56FE\u7247",width:60,field:"pic_url",formatter(o){var e;return b(`<a target="_blank" href="${o.getData().item_url}">
          <img src="${(e=o.getData().goods)==null?void 0:e.pic_url}" />
        </a>`)[0]}},{title:"\u6807\u9898",field:"title",formatter(o){var e;return b(`<a target="_blank" href="${o.getData().item_url}">
          ${(e=o.getData().goods)==null?void 0:e.title}
        </a>`)[0]}},{title:"\u4EF7\u683C",width:150,field:"",formatter(o){return o.getData().price}},{title:"\u9500\u91CF",width:80,field:"",formatter(o){var e;return(e=o.getData().goods)==null?void 0:e.volume}},{title:"\u65E5\u9500\u91CF",width:100,field:"",formatter(o){var e;return(e=o.getData().goods_data)==null?void 0:e.day_sales}},{title:"2\u5C0F\u65F6\u9500\u91CF",width:100,field:"",formatter(o){var e;return(e=o.getData().goods_data)==null?void 0:e.sales2h}},{title:"\u64CD\u4F5C",field:"action",width:120,formatter(o){if(o.getData().status===0){const e=b('<a class="flex items-center" href="javascript:;">\u901A\u8FC7</a>');return b(e).on("click",function(t){}),e[0]}return""}}],a=D({rangePicker:"",username:"",status:0,startTime:"",endTime:""}),_=$(),i=$(),p=()=>{a.startTime=B(a.rangePicker)[0],a.endTime=B(a.rangePicker)[0],_.value.reload(!0)};return(o,e)=>{const t=r("h-form-item"),g=r("Litepicker"),c=r("h-form"),w=Z,y=r("h-card");return x(),I(G,null,[l(y,{bordered:!1,title:"\u6D3B\u52A8"},{header:s(()=>[d("button",{class:"btn btn-primary mr-2 shadow-md",onClick:e[0]||(e[0]=u=>i.value.edit({}))},"\u65B0\u5EFA ")]),default:s(()=>[l(w,{ref_key:"tableRef",ref:_,columns:v,ajaxUrl:C(k),config:C(n),queryParam:a},{search:s(()=>[l(c,{layout:"inline"},{default:s(()=>[l(t,{label:"\u7528\u6237\u540D",content:"",layout:"inline"},{default:s(()=>[T(d("input",{"onUpdate:modelValue":e[1]||(e[1]=u=>a.username=u),type:"text",class:"form-control mt-2 sm:mt-0 sm:w-40 2xl:w-full"},null,512),[[j,a.username]])]),_:1}),l(t,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:s(()=>[l(g,{modelValue:a.rangePicker,"onUpdate:modelValue":e[2]||(e[2]=u=>a.rangePicker=u),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"form-control mt-2 sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),d("div",{class:"mt-2 xl:mt-0"},[d("button",{type:"button",class:"btn btn-primary w-full sm:w-16",onClick:p}," \u67E5\u8BE2 ")])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1}),l(K,{ref_key:"modal",ref:i,onOk:p},null,512)],64)}}});export{ee as default};
