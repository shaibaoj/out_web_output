import{h as Z,Z as J,C as N,j as O,G as Q,H as dt,k as ct,t as _t,aq as Y,l as b,a as _,b as M,w as r,m as a,p as R,e as F,q as i,c as h,x as p,y as v,F as $,u as U,K as z,a3 as tt,n as w,v as x,a5 as k,a6 as K,s as P,_ as et,$ as pt,o as ft,d as c,a0 as gt,a2 as vt}from"./index.fe592241.js";import{u as ht,f as bt,a as Dt,b as wt,c as Ft,g as yt,d as Et,e as Ct}from"./goods.94228ab4.js";import{g as Bt,i as xt}from"./common.5401820e.js";import{p as S}from"./pick.75b5e982.js";const kt={class:"input-group"},$t={class:"input-group"},Ut=a("div",{class:"form-help"},"\u8FD8\u53EF\u4EE5\u8F93\u5165 16 \u4E2A\u5B57",-1),Vt={class:"w-32 mt-1 mb-2 mr-2 btn btn-outline-success btn-sm"},At=["src"],qt={key:1,class:"py-2"},jt=a("p",null,"\u4E3B\u56FE\u53C2\u8003",-1),Lt={class:"flex flex-row flex-wrap gap-x-1 gap-y-1"},Yt=["onClick"],St=["src"],Mt=a("div",{class:"form-help"},"\u4F18\u60E0\u5238\u5EFA\u8BAE\u65F6\u95F47\u5929\u5DE6\u53F3",-1),Nt=a("option",{value:0},"--\u9009\u62E9--",-1),Ot=["value"],Pt={key:0},Tt=a("p",null,"\u5907\u9009\u6587\u6848",-1),Gt={class:"flex flex-col gap-y-3"},It=["onClick"],Rt=["className"],zt=Z({__name:"goods",emits:["ok"],setup(ot,{expose:V,emit:T}){const G=J().uploadUrl,g=N(""),m=N(""),o=O({item_url:"",qq_video_url:"",coupon_url:"",money:0,id:0,item_id:"",seller_id:"",ori_price:0,user_type:0,volume:0,condition:0,title:"",price:0,qq_pic_url:"",comment:"",cid1:0,d_title:"",pic_url:"",start_time:"",end_time:""}),A={},s=O({visible:!1,confirmLoading:!1,data:{step:0,cats:[],wen_items:[],pic_urls:[]}}),q=Q(()=>!xt(o.pic_url));dt(()=>{y()});const y=()=>{Bt({}).then(u=>{u.data.items&&(s.data.cats=u.data.items)})},E=ct(A,_t(o)),t=u=>{s.data.step=0,m.value="",g.value="",s.visible=!0,x(()=>{Object.assign(o,{item_url:"",qq_video_url:"",coupon_url:"",money:0,id:0,item_id:"",seller_id:"",ori_price:0,user_type:0,volume:0,condition:0,title:"",price:0,qq_pic_url:"",comment:"",cid1:0,d_title:"",pic_url:"",start_time:"",end_time:""}),s.data.pic_urls=[],s.data.wen_items=[],u.id&&(s.data.step=1);const e=S(u,["id","cid1","coupon_url","item_url","item_id","title","d_title","price","pic_url","seller_id","ori_price","user_type","volume","comment","start_time","end_time","money","condition"]);Object.assign(o,e),u.start_time&&(o.start_time=k(u.start_time)),u.end_time&&(o.end_time=k(u.end_time))})},n=u=>{if(s.confirmLoading=!0,E.value.$touch(),E.value.$invalid)E.value.$errors,s.confirmLoading=!1;else{let e=U(o);e.start_time&&(e=Object.assign(e,{start_time:K(e.start_time)})),e.end_time&&(e=Object.assign(e,{end_time:K(e.end_time)})),ht(Object.assign({},e,{submitStatus:u})).then(d=>{d.code===0&&(u===1?P.success("\u63D0\u4EA4\u6210\u529F"):P.success("\u4FDD\u5B58\u6210\u529F"),T("ok",e),s.visible=!1),s.confirmLoading=!1})}},f=u=>{o.pic_url=u.data.item.img},C=()=>{bt({item_url:o.item_url}).then(u=>{u.data.goods&&(x(()=>{Object.assign(o,S(u.data.goods,["id","cid1","coupon_url","item_url","item_id","title","d_title","price","pic_url","seller_id","ori_price","user_type","volume","comment"]))}),s.data.wen_items=u.data.goods.wen_items||[],s.data.pic_urls=u.data.goods.pic_urls||[]),s.confirmLoading=!1})},I=()=>{Dt({item_url:o.item_url}).then(u=>{u.data.goods&&(s.data.wen_items=u.data.goods.wen_items||[],s.data.pic_urls=u.data.goods.pic_urls||[])})},j=()=>{wt({item_url:o.item_url,coupon_url:o.coupon_url}).then(u=>{u.data.coupon&&x(()=>{const e=S(u.data.coupon,["money","condition"]);Object.assign(o,e),o.start_time=k(u.data.coupon.start_time),o.end_time=k(u.data.coupon.end_time)})})},D=()=>{s.visible=!1},at=u=>{x(()=>{Object.assign(o,{comment:u.content})})},ut=u=>{x(()=>{o.pic_url=u})},L=()=>{Ft({item_url:g.value,content:m.value}).then(u=>{u.data.item&&x(()=>{const e=S(u.data.item,["item_url","coupon_url"]);Object.assign(o,e),s.data.step=1,C(),j()})})};return Y(()=>o.item_url,(u,e)=>{I()},{immediate:!0}),Y(()=>o.coupon_url,(u,e)=>{j()},{immediate:!0}),Y(()=>g,(u,e)=>{L()},{immediate:!0}),Y(()=>m,(u,e)=>{L()},{immediate:!0}),V({edit:t}),(u,e)=>{const d=b("h-form-item"),lt=b("UploadIcon"),st=b("h-upload"),W=b("Litepicker"),nt=b("h-form"),it=b("h-spin"),X=b("LoadingIcon"),rt=b("h-modal");return _(),M(rt,{title:"\u53D1\u5E03\u5546\u54C1",size:"modal-xl",visible:s.visible,"confirm-loading":s.confirmLoading,onCancel:D},{footer:r(()=>[a("div",{className:s.data.step===0?"hidden":""},[a("button",{class:"w-24 mb-2 mr-1 btn btn-primary",onClick:e[14]||(e[14]=l=>n(1))},[R(" \u63D0\u4EA4\u5BA1\u6838 "),s.confirmLoading?(_(),M(X,{key:0,icon:"oval",color:"white",class:"w-4 h-4 ml-2"})):F("v-if",!0)]),a("button",{class:"w-24 mb-2 mr-1 btn btn-primary",onClick:e[15]||(e[15]=l=>n(0))},[R("\u4FDD\u5B58\u8349\u7A3F "),s.confirmLoading?(_(),M(X,{key:0,icon:"oval",color:"white",class:"w-4 ml-2"})):F("v-if",!0)])],8,Rt)]),default:r(()=>[i(it,{spinning:s.confirmLoading},{default:r(()=>[i(nt,{layout:"small"},{default:r(()=>[s.data.step==0?(_(),h($,{key:0},[i(d,{label:"\u5546\u54C1\u94FE\u63A5",content:"",layout:"small"},{default:r(()=>[a("div",kt,[p(a("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=l=>g.value=l)},null,512),[[v,g.value]]),a("div",{class:"input-group-text"},[a("button",{class:"w-24",onClick:L},"\u83B7\u53D6")])])]),_:1}),i(d,{label:"\u5546\u54C1\u6587\u6848",content:"",layout:"small"},{default:r(()=>[p(a("textarea",{class:"form-control","onUpdate:modelValue":e[1]||(e[1]=l=>m.value=l),rows:4,placeholder:"\u8BF7\u5728\u6B64\u7C98\u8D34\u63A8\u5E7F\u6587\u6848\uFF0C\u672C\u529F\u80FD\u53EF\u8BC6\u522B\u5927\u591A\u7B26\u5408\u89C4\u5219\u7684\u6587\u6848",onChange:L},null,544),[[v,m.value]])]),_:1})],64)):F("v-if",!0),s.data.step!==0?(_(),h($,{key:1},[i(d,{label:"\u5546\u54C1\u5730\u5740",content:"",layout:"small"},{default:r(()=>[a("div",$t,[p(a("input",{type:"text",class:"form-control","onUpdate:modelValue":e[2]||(e[2]=l=>o.item_url=l)},null,512),[[v,o.item_url]]),a("div",{class:"input-group-text"},[a("button",{class:"w-24",onClick:C},"\u83B7\u53D6")])])]),_:1}),i(d,{label:"\u5546\u54C1\u6807\u9898",content:"",layout:"small"},{default:r(()=>[p(a("input",{type:"text",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=l=>o.title=l)},null,512),[[v,o.title]])]),_:1}),i(d,{label:"\u63A8\u5E7F\u77ED\u6807\u9898",content:"",layout:"small"},{default:r(()=>[p(a("input",{type:"text",class:"form-control","onUpdate:modelValue":e[4]||(e[4]=l=>o.d_title=l)},null,512),[[v,o.d_title]]),Ut]),_:1}),i(d,{label:"\u539F\u4EF7\u683C",content:"",layout:"small"},{default:r(()=>[p(a("input",{type:"text",class:"form-control","onUpdate:modelValue":e[5]||(e[5]=l=>o.price=l)},null,512),[[v,o.price]])]),_:1}),i(d,{label:"\u56FE\u7247",content:"",layout:"small"},{default:r(()=>[p(a("input",{type:"text",class:"form-control","onUpdate:modelValue":e[6]||(e[6]=l=>o.pic_url=l),placeholder:"\u4F8B\uFF1Ahttps://img.alicdn.com/imgextra/i1/2454060579/TB2fakMdl0lpuFjSszdXXcdxFXa_!!2454060579.jpg"},null,512),[[v,o.pic_url]]),i(st,{name:"file",multiple:!0,action:U(G),onChange:f},{default:r(()=>[a("button",Vt,[i(lt,{class:"w-4 h-4 mr-2"}),R("\u4E0A\u4F20 ")])]),_:1},8,["action"]),U(q)?(_(),h("img",{key:0,class:"w-48 h-48",src:o.pic_url},null,8,At)):F("v-if",!0),s.data.pic_urls&&s.data.pic_urls.length>0?(_(),h("div",qt,[jt,a("ul",Lt,[(_(!0),h($,null,z(s.data.pic_urls,(l,B)=>(_(),h("li",{key:B,onClick:mt=>ut(l),class:"p-1 border h-36 w-36 hover:border-green-600"},[a("img",{src:l},null,8,St)],8,Yt))),128))])])):F("v-if",!0)]),_:1}),i(d,{label:"\u4F18\u60E0\u5238\u8FDE\u63A5",content:"",layout:"small"},{default:r(()=>[p(a("input",{type:"text",class:"form-control","onUpdate:modelValue":e[7]||(e[7]=l=>o.coupon_url=l)},null,512),[[v,o.coupon_url]]),Mt]),_:1}),i(d,{label:"\u5206\u7C7B",content:"",layout:"small"},{default:r(()=>[p(a("select",{class:"form-select","onUpdate:modelValue":e[8]||(e[8]=l=>o.cid1=l)},[Nt,(_(!0),h($,null,z(s.data.cats,(l,B)=>(_(),h("option",{key:B,value:l.c_id},w(l.short_name),9,Ot))),128))],512),[[tt,o.cid1]])]),_:1}),i(d,{label:"\u5F00\u59CB\u65F6\u95F4",content:"",layout:"small"},{default:r(()=>[i(W,{modelValue:o.start_time,"onUpdate:modelValue":e[9]||(e[9]=l=>o.start_time=l),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"block w-56 form-control"},null,8,["modelValue"])]),_:1}),i(d,{label:"\u7ED3\u675F\u65F6\u95F4",content:"",layout:"small"},{default:r(()=>[i(W,{modelValue:o.end_time,"onUpdate:modelValue":e[10]||(e[10]=l=>o.end_time=l),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"block w-56 form-control"},null,8,["modelValue"])]),_:1}),i(d,{label:"\u5FAE\u4FE1\u7FA4\u4E13\u7528\u56FE",content:"",layout:"small"},{default:r(()=>[p(a("input",{type:"text",class:"form-control","onUpdate:modelValue":e[11]||(e[11]=l=>o.qq_pic_url=l)},null,512),[[v,o.qq_pic_url]])]),_:1}),i(d,{label:"\u5BFC\u8D2D\u6587\u6848",content:"",layout:"small"},{default:r(()=>[p(a("textarea",{class:"form-control","onUpdate:modelValue":e[12]||(e[12]=l=>o.comment=l),rows:4,placeholder:"\u8BF7\u8F93\u516520-100\u5B57\u5BFC\u8D2D\u6587\u6848\u4ECB\u7ECD"},null,512),[[v,o.comment]]),s.data.wen_items&&s.data.wen_items.length>0?(_(),h("div",Pt,[Tt,a("ul",Gt,[(_(!0),h($,null,z(s.data.wen_items,(l,B)=>(_(),h("li",{key:B,onClick:mt=>at(l)},w(B+1)+"."+w(l.content),9,It))),128))])])):F("v-if",!0)]),_:1}),i(d,{label:"\u89C6\u9891\u6587\u4EF6",content:"",layout:"small"},{default:r(()=>[p(a("input",{type:"text",class:"form-control","onUpdate:modelValue":e[13]||(e[13]=l=>o.qq_video_url=l)},null,512),[[v,o.qq_video_url]])]),_:1})],64)):F("v-if",!0)]),_:1})]),_:1},8,["spinning"])]),_:1},8,["visible","confirm-loading"])}}}),Ht=et(zt,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/business/goods/goods.vue"]]),Wt=a("option",{value:""},"\u5168\u90E8",-1),Xt={value:"2"},Kt={value:"1"},Zt={value:"0"},Jt={value:"-1"},Qt={value:"-2"},te=Z({__name:"goods",setup(ot){const V=J(),T=Q(()=>`${V.urlPrefix}${V.apiUrl}${Et.list}`),H=pt({}),G=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"\u4E3B\u56FE",width:50,field:"pic_url",formatter(t){return c(`<a target="_blank" href="${t.getData().item_url}">
          <img src="${t.getData().pic_url}" />
        </a>`)[0]}},{title:"\u77ED\u6807\u9898",field:"title",formatter(t){return c(`<a target="_blank" href="https://www.haowulm.com/?coupon=1&q=${encodeURIComponent(t.getData().item_url)}">
          ${t.getData().title}
        </a>`)[0]}},{title:"\u539F\u4EF7/\u5238\u540E\u4EF7	",width:120,field:"price",sorter:!0,formatter(t){return c(`<a target="_blank" href="${t.getData().item_url}">
          ${t.getData().price}
        </a>`)[0]}},{title:"\u4F63\u91D1\u6BD4\u4F8B",width:80,field:"coupon.commission_rate",formatter(t){return t.getData().coupon.commission_rate+"%"}},{title:"\u4F18\u60E0\u5238",width:80,field:"money",formatter(t){return c(`<a target="_blank" href="${t.getData().coupon_url}">
        \u67E5\u770B
        </a>`)[0]}},{title:"\u8D77\u6B62\u65E5\u671F",field:"",width:100,formatter(t){return c(`
        ${t.getData().start_time?`<span>${k(t.getData().start_time)}</span>`:""}
        ${t.getData().end_time?`<p>${k(t.getData().end_time)}</p>`:""}
        `)[0]}},{title:"\u9500\u91CF",width:50,field:"volume"},{title:"\u72B6\u6001",width:80,field:"",sorter:!0,formatter(t){return t.getData().status===0?"\u8349\u7A3F":t.getData().status===1?"\u5F85\u5BA1\u6838":t.getData().status===2?"\u4E0A\u67B6":t.getData().status===-1?"\u5DF2\u62D2\u7EDD":t.getData().status===-2?"\u5DF2\u4E0B\u67B6":""}},{title:"\u680F\u76EE",field:"category.short_name",width:60},{title:"\u5E97\u94FA",field:"user_type",width:80,formatter(t){return t.getData().user_type==="B"?"\u5929\u732B":"\u6DD8\u5B9D"}},{title:"\u66F4\u65B0\u65F6\u95F4",width:160,field:"updated_at",formatter(t){return gt(t.getData().created_at,"YY-MM-DD HH:mm")}},{title:"\u64CD\u4F5C",field:"action",width:120,hozAlign:"center",formatter(t){if(t.getData().status===-2){const n=c('<a class="flex items-center" href="javascript:;">\u6362\u5238</a>');return c(n).on("click",function(f){s(t.getData())}),n[0]}else if(t.getData().status===-1){const n=c('<a class="flex items-center" href="javascript:;">\u6362\u5238</a>');return c(n).on("click",function(f){s(t.getData())}),n[0]}else if(t.getData().status===0){const n=c('<a class="flex items-center" href="javascript:;">\u7F16\u8F91</a>');return c(n).on("click",function(f){s(t.getData())}),n[0]}else if(t.getData().status===1){const n=c('<a class="flex items-center" href="javascript:;">\u64A4\u9500\u5BA1\u6838</a>');return c(n).on("click",function(f){A(t.getData(),0)}),n[0]}else if(t.getData().status===2){const n=c('<a class="flex items-center" href="javascript:;">\u4E0B\u67B6</a>');return c(n).on("click",function(f){A(t.getData(),-2)}),n[0]}return""}}],g=O({item_id:"",status:"",url:""}),m=O({report:{status0:0,status1:0,status2:0,status01:0,status02:0}});ft(()=>{E()});const o=N(),A=(t,n)=>{Ct({id:t.id,status:n}).then(f=>{const{code:C}=f||{};C===0?P.success(f.message):P.error(f.message),y(!1)})},s=t=>{t.item_url&&(t.href=t.item_url),o.value.edit(t)},q=N(),y=t=>{q.value.reload(t),E()},E=()=>{yt({}).then(t=>{t.data.item&&(m.report.status0=t.data.item[0]?t.data.item[0]:0,m.report.status1=t.data.item[1]?t.data.item[1]:0,m.report.status2=t.data.item[2]?t.data.item[2]:0,m.report.status01=t.data.item[-1]?t.data.item[-1]:0,m.report.status02=t.data.item[-2]?t.data.item[-2]:0)})};return(t,n)=>{const f=b("h-form-item"),C=b("h-form"),I=vt,j=b("h-card");return _(),M(j,{bordered:!1,title:"\u5546\u54C1\u53D1\u5E03"},{header:r(()=>[a("button",{class:"mr-2 shadow-md btn btn-primary",onClick:n[0]||(n[0]=D=>o.value.edit({}))},"\u53D1\u5E03\u5546\u54C1 ")]),default:r(()=>[i(I,{ref_key:"tableRef",ref:q,columns:G,ajaxUrl:U(T),config:U(H),queryParam:g},{search:r(()=>[i(C,{layout:"inline"},{default:r(()=>[i(f,{label:"\u72B6\u6001",content:"",layout:"inline"},{default:r(()=>[p(a("select",{"onUpdate:modelValue":n[1]||(n[1]=D=>g.status=D),class:"w-full mt-2 form-select sm:mt-0 sm:w-auto",onChange:y},[Wt,a("option",Xt,"\u901A\u8FC7 ("+w(m.report.status2)+")",1),a("option",Kt,"\u5BA1\u6838\u4E2D ("+w(m.report.status1)+")",1),a("option",Zt,"\u8349\u7A3F ("+w(m.report.status0)+")",1),a("option",Jt,"\u62D2\u7EDD ("+w(m.report.status01)+")",1),a("option",Qt,"\u4E0B\u67B6 ("+w(m.report.status02)+")",1)],544),[[tt,g.status]])]),_:1}),i(f,{label:"\u5546\u54C1\u7F16\u53F7",content:"",layout:"inline"},{default:r(()=>[p(a("input",{"onUpdate:modelValue":n[2]||(n[2]=D=>g.item_id=D),type:"text",class:"mt-2 form-control sm:mt-0 sm:w-40 2xl:w-full"},null,512),[[v,g.item_id]])]),_:1}),i(f,{label:"\u5546\u54C1\u5730\u5740",content:"",layout:"inline"},{default:r(()=>[p(a("input",{"onUpdate:modelValue":n[3]||(n[3]=D=>g.url=D),type:"text",class:"mt-2 form-control sm:mt-0 sm:w-40 2xl:w-full"},null,512),[[v,g.url]])]),_:1}),a("div",{class:"mt-2 xl:mt-0"},[a("button",{type:"button",class:"w-full btn btn-primary sm:w-16",onClick:y}," \u67E5\u8BE2 ")])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"]),i(Ht,{ref_key:"modal",ref:o,onOk:n[4]||(n[4]=D=>y(!1))},null,512)]),_:1})}}}),le=et(te,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/business/goods.vue"]]);export{le as default};
