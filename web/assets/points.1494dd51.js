import{r as O,h as j,Y as P,j as B,k as G,t as H,a as U,b as S,w as n,l as o,n as T,e as Z,p as e,x as w,y,u as k,v as J,q as M,s as i,D as q,Z as I,C as E,c as N,F as R,d as Y,a1 as W,$ as K}from"./index.5040b566.js";import{p as Q}from"./pick.16f72627.js";const A={getItems:"/api/user/member/points/list",getView:"/api/user/member/points/view",updateItem:"/api/user/member/points/update",list_gift:"/api/user/member/points/list_gift",view_gift:"/api/user/member/points/view_gift",update_gift_status:"/api/user/member/points/update_gift_status",update_gift:"/api/user/member/points/update_gift"};function X(b){return O({url:A.update_gift_status,method:"post",data:b})}function tt(b){return O({url:A.update_gift,method:"post",data:b})}const et={class:"btn btn-outline-success btn-sm mt-1 mb-2 mr-2 w-32"},nt={class:"input-group"},ot=o("div",{class:"input-group-text"},"\u4E2A",-1),lt=o("div",{class:"form-help"},null,-1),at={class:"input-group"},st=o("div",{class:"input-group-text"},"\u4E2A",-1),it=o("div",{class:"form-help"},null,-1),ut=j({__name:"liwu",emits:["ok"],setup(b,{expose:h,emit:x}){const F=P().uploadUrl,t=B({id:0,pic_url:"",title:"",content:"",points:0,number:0}),v={},a=B({visible:!1,confirmLoading:!1}),p=()=>{a.visible=!1},f=r=>{t.pic_url=r.data.item.img},u=G(v,H(t)),_=r=>{a.visible=!0,J(()=>{Object.assign(t,{id:0,pic_url:"",title:"",content:"",points:0,number:0}),Object.assign(t,Q(r,["id","title","pic_url","content","points","number"]))})},D=()=>{if(a.confirmLoading=!0,u.value.$touch(),u.value.$invalid)u.value.$errors,a.confirmLoading=!1;else{const r=k(t);tt(r).then(l=>{const{code:d}=l||{};d===0?M.success("\u4FDD\u5B58\u6210\u529F"):M.error(l.message),a.confirmLoading=!1,x("ok",r),a.visible=!1})}};return h({edit:_}),(r,l)=>{const d=i("h-form-item"),s=i("UploadIcon"),m=i("h-upload"),g=i("h-form"),V=i("h-spin"),$=i("LoadingIcon"),L=i("h-modal");return U(),S(L,{title:"\u793C\u7269\u53D1\u5E03",size:"modal-lg",visible:a.visible,"confirm-loading":a.confirmLoading,onCancel:p},{footer:n(()=>[o("button",{class:"btn btn-primary mb-2 mr-1 w-24",onClick:l[5]||(l[5]=c=>D())},[T(" \u4FDD\u5B58 "),a.confirmLoading?(U(),S($,{key:0,icon:"oval",color:"white",class:"ml-2 h-4 w-4"})):Z("",!0)])]),default:n(()=>[e(V,{spinning:a.confirmLoading},{default:n(()=>[e(g,{layout:"small"},{default:n(()=>[e(d,{label:"\u540D\u79F0",content:"",layout:"small"},{default:n(()=>[w(o("input",{type:"text",class:"form-control","onUpdate:modelValue":l[0]||(l[0]=c=>t.title=c)},null,512),[[y,t.title]])]),_:1}),e(d,{label:"\u56FE\u7247",content:"",layout:"small"},{default:n(()=>[w(o("input",{type:"text",class:"form-control","onUpdate:modelValue":l[1]||(l[1]=c=>t.pic_url=c),placeholder:""},null,512),[[y,t.pic_url]]),e(m,{name:"file",multiple:!0,action:k(F),onChange:f},{default:n(()=>[o("button",et,[e(s,{class:"mr-2 h-4 w-4"}),T("\u4E0A\u4F20 ")])]),_:1},8,["action"])]),_:1}),e(d,{label:"\u63CF\u8FF0",content:"",layout:"small"},{default:n(()=>[w(o("textarea",{class:"form-control","onUpdate:modelValue":l[2]||(l[2]=c=>t.content=c),rows:2},null,512),[[y,t.content]])]),_:1}),e(d,{label:"\u79EF\u5206",content:"",layout:"small"},{default:n(()=>[o("div",nt,[w(o("input",{type:"text",class:"form-control","onUpdate:modelValue":l[3]||(l[3]=c=>t.points=c)},null,512),[[y,t.points]]),ot]),lt]),_:1}),e(d,{label:"\u5E93\u5B58",content:"",layout:"small"},{default:n(()=>[o("div",at,[w(o("input",{type:"text",class:"form-control","onUpdate:modelValue":l[4]||(l[4]=c=>t.number=c)},null,512),[[y,t.number]]),st]),it]),_:1})]),_:1})]),_:1},8,["spinning"])]),_:1},8,["visible","confirm-loading"])}}}),rt=j({__name:"liwu",emits:["ok"],setup(b,{expose:h,emit:x}){const C=P(),F=q(()=>`${C.urlPrefix}${C.apiUrl}${A.list_gift}`),t=I({}),v=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"\u540D\u79F0",field:"title"},{title:"\u79EF\u5206",hozAlign:"center",field:"points",width:120},{title:"\u5E93\u5B58",hozAlign:"center",field:"number",width:120},{title:"\u72B6\u6001",hozAlign:"center",field:"status",width:80},{title:"\u64CD\u4F5C",field:"action",width:120,formatter(s){const m=Y(`    <div class="flex items-center lg:justify-center">
                <a class="flex items-center mr-3 action-uponline" href="javascript:;">
                  <i data-lucide="check-square" class="w-4 h-4 mr-1"></i> ${s.getData().status===0?"\u4E0A\u67B6":"\u4E0B\u67B6"}
                </a>
                <a class="flex items-center text-danger action-edit" href="javascript:;">
                  <i data-lucide="trash-2" class="w-4 h-4 mr-1"></i> \u7F16\u8F91
                </a>
                </div>`);return Y(m).find(".action-uponline").on("click",function(g){g.target,s.getData().status===0?r(s.getData(),1):r(s.getData(),0)}),Y(m).find(".action-edit").on("click",function(){D(s.getData())}),m[0]}}],a=B({rangePicker:"",name:"",status:0,startTime:"",endTime:""}),p=E(),f=B({visible:!1,confirmLoading:!1}),u=E(),_=()=>{p.value.reload(!0)},D=s=>{u.value.edit(s)},r=(s,m)=>{X({id:s.id,status:m}).then(g=>{M.success(g.message),p.value.reload()})},l=()=>{f.visible=!1,x("ok",{})};return h({show:()=>{f.visible=!0}}),(s,m)=>{const g=i("Litepicker"),V=i("h-form-item"),$=i("h-form"),L=W,c=i("h-drawer");return U(),N(R,null,[e(c,{title:"\u793C\u7269\u7BA1\u7406",size:"modal-xl",visible:f.visible,"confirm-loading":f.confirmLoading,onCancel:l},{header:n(()=>[o("button",{class:"w-24 mb-2 mr-1 btn btn-primary",icon:"add",onClick:m[0]||(m[0]=z=>u.value.edit({}))},"\u6DFB\u52A0\u793C\u7269")]),default:n(()=>[e(L,{ref_key:"tableRef",ref:p,columns:v,ajaxUrl:k(F),config:k(t),queryParam:a},{search:n(()=>[e($,{layout:"inline"},{default:n(()=>[e(V,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:n(()=>[e(g,{modelValue:a.rangePicker,"onUpdate:modelValue":m[1]||(m[1]=z=>a.rangePicker=z),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"mt-2 form-control sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),o("div",{class:"mt-2 xl:mt-0"},[o("button",{type:"button",class:"w-full btn btn-primary sm:w-16",onClick:_}," \u67E5\u8BE2 ")])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1},8,["visible","confirm-loading"]),e(ut,{ref_key:"modal",ref:u,onOk:_},null,512)],64)}}}),dt=j({__name:"points",setup(b){const h=P(),x=q(()=>`${h.urlPrefix}${h.apiUrl}${A.getItems}`),C=I({}),F=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"\u7528\u6237\u540D",field:"user.nick_name",width:150},{title:"\u79EF\u5206",field:"points",width:80},{title:"\u73B0\u91D1",field:"money",width:120},{title:"\u793C\u54C1",field:"user_cms_gift_id"},{title:"\u5151\u6362\u65F6\u95F4",hozAlign:"center",field:"created_at",formatter(f){return K(f.getData().created_at,"YY-MM-DD HH:mm")},width:160},{title:"\u72B6\u6001",hozAlign:"center",field:"status_name",width:80}],t=B({rangePicker:"",name:"",status:0,startTime:"",endTime:""}),v=E(),a=E(),p=()=>{v.value.reload(!0)};return(f,u)=>{const _=i("h-form-item"),D=i("Litepicker"),r=i("h-form"),l=W,d=i("h-card");return U(),N(R,null,[e(d,{bordered:!1,title:"\u5151\u6362\u8BB0\u5F55"},{header:n(()=>[o("button",{class:"mr-2 shadow-md btn btn-primary",onClick:u[0]||(u[0]=s=>a.value.show({}))},"\u793C\u7269\u7BA1\u7406 ")]),default:n(()=>[e(l,{ref_key:"tableRef",ref:v,columns:F,ajaxUrl:k(x),config:k(C),queryParam:t},{search:n(()=>[e(r,{layout:"inline"},{default:n(()=>[e(_,{label:"\u7528\u6237\u540D",content:"",layout:"inline"},{default:n(()=>[w(o("input",{"onUpdate:modelValue":u[1]||(u[1]=s=>t.name=s),type:"text",class:"mt-2 form-control sm:mt-0 sm:w-40 2xl:w-full"},null,512),[[y,t.name]])]),_:1}),e(_,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:n(()=>[e(D,{modelValue:t.rangePicker,"onUpdate:modelValue":u[2]||(u[2]=s=>t.rangePicker=s),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"mt-2 form-control sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),o("div",{class:"mt-2 xl:mt-0"},[o("button",{type:"button",class:"w-full btn btn-primary sm:w-16",onClick:p}," \u67E5\u8BE2 ")])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1}),e(rt,{ref_key:"liwuModal",ref:a,onOk:p},null,512)],64)}}});export{dt as default};
