import{d as L,l as C,m as K,t as Q,o as ue,s as S,n as r,b as y,e as T,w as u,h as e,u as l,B as k,j as D,x as G,F as A,q as Y,k as M,I as ne,aC as le,f as q,L as se,g,Y as R,p as V,c as $,ad as re,ae as W,ah as H,a7 as X,G as Z,a8 as ee,C as U,y as te,a as F,ab as ae,a9 as me}from"./index.06fc13de.js";import{g as de,u as oe,b as ce,c as ie}from"./market.ee1ff808.js";import{p as z}from"./pick.b800152b.js";import{f as J}from"./goods.103d4918.js";const _e=L({__name:"data",emits:["ok"],setup(j,{expose:E,emit:x}){const o=C({weixin:"",status:!1}),B={},t=C({visible:!1,confirmLoading:!1,data:{benefits_invite_buyer_rate:0}}),v=K(B,Q(o));ue(()=>{p()});const p=()=>{f()},f=()=>{de({market_code:"miandan"}).then(_=>{_.data.item&&S(()=>{const n=z(_.data.item,["weixin"]);Object.assign(o,n),n.status=_.data.item.status===1})})},h=_=>{if(_.preventDefault(),v.value.$touch(),v.value.$invalid)v.value.$errors;else{const n=l(o);oe(Object.assign(n,{market_code:"miandan",status:o.status?1:0})).then(i=>{const{code:w}=i||{};w===0?Y.success("\u4FDD\u5B58\u6210\u529F"):Y.error(i.message),x("ok",{})})}},c=()=>{t.visible=!1};return E({edit:()=>{t.visible=!0}}),(_,n)=>{const i=r("h-form-item"),w=r("h-form"),a=r("h-drawer");return y(),T(a,{title:"\u8BBE\u7F6E",visible:t.visible,"confirm-loading":t.confirmLoading,onCancel:c},{footer:u(()=>[e(l(k),{variant:"primary",class:"w-24 mb-2 mr-1",onClick:h},{default:u(()=>[D("\u4FDD\u5B58")]),_:1})]),default:u(()=>[e(w,{layout:"small"},{default:u(()=>[e(i,{label:"\u72B6\u6001",content:"",layout:"small"},{default:u(()=>[e(l(G),null,{default:u(()=>[e(l(G).Input,{type:"checkbox",modelValue:o.status,"onUpdate:modelValue":n[0]||(n[0]=s=>o.status=s)},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{label:"\u5FAE\u4FE1\u5BA2\u670D",content:"",layout:"small"},{default:u(()=>[e(l(A),{type:"text",modelValue:o.weixin,"onUpdate:modelValue":n[1]||(n[1]=s=>o.weixin=s),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["visible","confirm-loading"])}}}),fe=M(_e,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/market/miandan/data.vue"]]),pe={key:0},ge={key:1},ve={key:2},he=g("option",{value:0},"\u9ED8\u8BA4",-1),we=g("option",{value:2},"\u4F18\u8D28\u5546\u54C1",-1),be=g("option",{value:1},"\u4FBF\u5B9C\u5B9E\u7528",-1),Fe=g("option",{value:3},"0\u5143\u9886\u53D6",-1),De=g("option",{value:4},"1\u5143\u8D2D\u7269",-1),Ee=L({__name:"goods",emits:["ok"],setup(j,{expose:E,emit:x}){const o=C({id:0,href:"",price:0,price_rate:0,commission_rate:0,inventory:0,recommend:0,item_id:"",start_time:"",end_time:""}),B={},t=C({visible:!1,confirmLoading:!1,vip:{ori_price:0,coupon_price:0,buy_base_price:0,price:0,price_rate:0,commission_rate:0,commission:0},data:{href:"",pic_urls:[],wen_items:[]}});ne(()=>{});const v=()=>{t.visible=!1},p=()=>{J({content:o.href}).then(n=>{n.data.goods&&(t.data.wen_items=n.data.goods.wen_items||[],t.data.pic_urls=n.data.goods.pic_urls||[])})};le(()=>t.data.href,(n,i)=>{p()},{immediate:!0});const f=K(B,Q(o)),h=n=>{t.visible=!0,S(()=>{Object.assign(o,{id:0,href:"",price:0,price_rate:0,commission_rate:0,inventory:0,recommend:0,item_id:"",start_time:"",end_time:""});const i=z(n,["id","recommend","inventory","href","item_id","commission_rate","price_rate","price"]);Object.assign(o,i),o.start_time=W(n.start_time),o.end_time=W(n.end_time),d(),p()})},c=n=>{if(t.confirmLoading=!0,f.value.$touch(),f.value.$invalid)f.value.$errors,t.confirmLoading=!1;else{let i=l(o);i.start_time&&(i=Object.assign(i,{start_time:H(i.start_time)})),i.end_time&&(i=Object.assign(i,{end_time:H(i.end_time)})),ce(Object.assign(i,{market_code:"vip",submitStatus:n})).then(w=>{w.code===0&&(n===1?Y.success("\u63D0\u4EA4\u6210\u529F"):Y.success("\u4FDD\u5B58\u6210\u529F"),x("ok",i),t.visible=!1),t.confirmLoading=!1})}},d=()=>{J({href:o.href}).then(n=>{n.data.goods&&(S(()=>{Object.assign(o,z(n.data.goods,["id","href","item_id","start_time","end_time"]))}),t.vip.ori_price=n.data.goods.ori_price,t.vip.coupon_price=n.data.goods.coupon_price,t.vip.buy_base_price=n.data.goods.buy_base_price,t.vip.commission=n.data.goods.commission,t.data.wen_items=n.data.goods.wen_items||[],t.data.pic_urls=n.data.goods.pic_urls||[]),t.confirmLoading=!1})},_=()=>{t.vip.price=o.price,t.vip.price_rate=o.price_rate,t.vip.commission_rate=o.commission_rate};return E({edit:h}),(n,i)=>{const w=r("Alert"),a=r("h-form-item"),s=r("Litepicker"),b=r("h-form"),O=r("h-spin"),I=r("LoadingIcon"),P=r("h-modal");return y(),T(P,{title:"\u53D1\u5E03\u5546\u54C1",size:"xl",visible:t.visible,"confirm-loading":t.confirmLoading,onCancel:v},{footer:u(()=>[e(l(k),{variant:"primary",class:"w-24 mb-2 mr-1",onClick:i[8]||(i[8]=m=>c(1))},{default:u(()=>[D(" \u63D0\u4EA4\u53D1\u5E03 "),t.confirmLoading?(y(),T(I,{key:0,icon:"oval",color:"white",class:"w-4 h-4 ml-2"})):q("v-if",!0)]),_:1})]),default:u(()=>[e(O,{spinning:t.confirmLoading},{default:u(()=>[e(b,{layout:"small"},{default:u(()=>[e(w,{class:"flex items-center mb-2 alert-outline-primary"},{default:u(()=>[e(l(se),{icon:"AlertCircle",class:"w-6 h-6 mr-2"}),D(" \u6CE8\u610F\u63D0\u793A\uFF1A \u6210\u4EA4\u4EF7\u767E\u5206\u6BD4\u4F18\u5148\u4E8E\u4F63\u91D1\u767E\u5206\u6BD4\uFF0C\u4F8B\uFF1A\u8BBE\u7F6E\u4E86\u6210\u4EA4\u767E\u5206\u6BD4\uFF0C\u4F63\u91D1\u6BD4\u4F8B\u5C31\u65E0\u6548\uFF0C\uFF08\u56FA\u5B9A\u8FD4\u5229\u91D1\u989D\u4F18\u5148\u7EA7\u522B\u6700\u9AD8\uFF09 ")]),_:1}),g("div",null,[e(a,{label:"\u5730\u5740",content:"",layout:"small"},{default:u(()=>[e(l(R),null,{default:u(()=>[e(l(A),{type:"text",modelValue:o.href,"onUpdate:modelValue":i[0]||(i[0]=m=>o.href=m)},null,8,["modelValue"]),e(l(R).Text,null,{default:u(()=>[e(l(k),{class:"w-24",onClick:d},{default:u(()=>[D("\u83B7\u53D6")]),_:1})]),_:1})]),_:1})]),_:1}),e(a,{label:"\u8BE6\u60C5",content:"",layout:"small"},{default:u(()=>[g("span",null,"\u539F\u4EF7:"+V(t.vip.ori_price),1),g("span",null,"\u5238\u540E\u4EF7:"+V(t.vip.coupon_price),1),g("span",null,"\u8D2D\u4E70\u6210\u672C\u4EF7:"+V(t.vip.buy_base_price),1),t.vip.price>0?(y(),$("span",pe,"\u7528\u6237\u6700\u7EC8\u4EF7\u683C:"+V((t.vip.coupon_price-t.vip.price).toFixed(2)),1)):t.vip.price_rate>0?(y(),$("span",ge,"\u7528\u6237\u6700\u7EC8\u4EF7\u683C:"+V((t.vip.coupon_price*(100-t.vip.price_rate)/100).toFixed(2)),1)):t.vip.commission_rate>0?(y(),$("span",ve,"\u7528\u6237\u6700\u7EC8\u4EF7\u683C:"+V((t.vip.coupon_price-t.vip.commission*t.vip.commission_rate/100).toFixed(2)),1)):q("v-if",!0)]),_:1}),e(a,{label:"\u5F00\u59CB\u65F6\u95F4",content:"",layout:"small"},{default:u(()=>[e(s,{modelValue:o.start_time,"onUpdate:modelValue":i[1]||(i[1]=m=>o.start_time=m),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"block w-56 mx-auto"},null,8,["modelValue"])]),_:1}),e(a,{label:"\u7ED3\u675F\u65F6\u95F4",content:"",layout:"small"},{default:u(()=>[e(s,{modelValue:o.end_time,"onUpdate:modelValue":i[2]||(i[2]=m=>o.end_time=m),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"block w-56 mx-auto"},null,8,["modelValue"])]),_:1}),e(a,{label:"\u5546\u54C1id",content:"",layout:"small"},{default:u(()=>[e(l(A),{type:"text",modelValue:o.item_id,"onUpdate:modelValue":i[3]||(i[3]=m=>o.item_id=m)},null,8,["modelValue"])]),_:1}),e(a,{label:"\u4F63\u91D1\u767E\u5206\u6BD4",content:"",layout:"small"},{default:u(()=>[e(l(A),{type:"text",modelValue:o.commission_rate,"onUpdate:modelValue":i[4]||(i[4]=m=>o.commission_rate=m),onChange:_},null,8,["modelValue"])]),_:1}),e(a,{label:"\u6210\u4EA4\u4EF7\u767E\u5206\u6BD4",content:"",layout:"small"},{default:u(()=>[e(l(A),{type:"text",modelValue:o.price_rate,"onUpdate:modelValue":i[5]||(i[5]=m=>o.price_rate=m),onChange:_},null,8,["modelValue"])]),_:1}),e(a,{label:"\u8FD4\u5229\u56FA\u5B9A\u91D1\u989D",content:"",layout:"small"},{default:u(()=>[e(l(A),{type:"text",modelValue:o.price,"onUpdate:modelValue":i[6]||(i[6]=m=>o.price=m),onChange:_},null,8,["modelValue"])]),_:1}),e(a,{label:"\u5546\u54C1\u7C7B\u578B",content:"",layout:"small"},{default:u(()=>[e(l(re),{modelValue:o.recommend,"onUpdate:modelValue":i[7]||(i[7]=m=>o.recommend=m)},{default:u(()=>[he,we,be,Fe,De]),_:1},8,["modelValue"])]),_:1})])]),_:1})]),_:1},8,["spinning"])]),_:1},8,["visible","confirm-loading"])}}}),ye=M(Ee,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/market/miandan/modal/goods.vue"]]),ke={class:"mt-2 xl:mt-0"},xe=L({__name:"items",emits:["ok"],setup(j,{expose:E,emit:x}){const o=X(),B=Z(()=>`${o.urlPrefix}${o.apiUrl}${ie.getItems}`),t=ee({}),v=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"",field:"title",formatter(a){return F(`
          <div class="flex items-center">
            <div class="w-9 h-9 image-fit zoom-in">
              <a target="_blank" href="${a.getData().goods.item_url}">
                <img class="border-white rounded-lg shadow-md" src="${a.getData().goods.pic_url}" />
              </a>
            </div>
            <div class="ml-4">
              <div class="font-medium ">
                ${a.getData().goods.d_title||""}
              </div>
              <div class="text-slate-500 text-xs mt-0.5">
                ${a.getData().goods.title||""}
              </div>
            </div>
          </div>
          `)[0]},download:!0},{title:"\u4EF7\u683C",width:120,field:"price",sorter:!0,formatter(a){return F(`
          <div class="flex flex-col items-start">
            <div class="text-slate-500 text-xs whitespace-nowrap mt-0.5">
              \u5238\u540E\u4EF7:${a.getData().coupon_price}
            </div>
            <div class="text-slate-500 text-xs whitespace-nowrap mt-0.5">
              \u798F\u5229\u91D1:${a.getData().rebate_amount}
            </div>
            <div class="text-slate-500 text-xs whitespace-nowrap mt-0.5">
              \u5230\u624B\u4EF7:${(a.getData().coupon_price-a.getData().rebate_amount).toFixed(2)}
            </div>
          </div>
          `)[0]}},{title:"\u6807\u9898",field:"title",formatter(a){return F(`<a target="_blank" href="${a.getData().item_url}">
          ${a.getData().goods.title}
        </a>`)[0]}},{title:"\u4EF7\u683C",field:"goods.price",width:100},{title:"\u9886\u53D6\u91CF",field:"draws",width:60},{title:"\u5E93\u5B58\u9650\u5236",field:"inventory",width:60},{title:"\u662F\u5426\u8425\u9500\u5E93",field:"marketTypeName",width:60,formatter(a){return a.getData().goods.material_lib_type==="1"?"\u662F":"\u5426"}},{title:"\u56FE\u7247",field:"pic_url",width:100,formatter(a){return F(`<a target="_blank" href="${a.getData().item_url}">
          <img src="${a.getData().goods.pic_url}" />
        </a>`)[0]}},{title:"\u9500\u91CF",field:"goods.volume",width:60},{title:"\u4F63\u91D1\u6BD4\u4F8B",field:"commission_rate",width:60},{title:"\u6210\u4EA4\u4EF7\u6BD4\u4F8B",field:"price_rate",width:60},{title:"\u72B6\u6001",field:"",width:60,formatter(a){return a.getData().status===1?"\u4E0A\u67B6":"\u4E0B\u67B6"}},{title:"\u6D3B\u52A8\u5F00\u59CB\u65F6\u95F4",field:"start_time",width:120,hozAlign:"center"},{title:"\u6D3B\u52A8\u7ED3\u675F\u65F6\u95F4",field:"end_time",width:120,hozAlign:"center"},{title:"\u64CD\u4F5C",field:"",width:120,formatter(a){const s=F(`    <div class="flex items-center lg:justify-center">
                <a class="flex items-center mr-3 action-uponline" href="javascript:;">
                  <i data-lucide="check-square" class="w-4 h-4 mr-1"></i> ${a.getData().status===0?"\u4E0A\u67B6":"\u4E0B\u67B6"}
                </a>
                <a class="flex items-center text-danger action-edit" href="javascript:;">
                  <i data-lucide="trash-2" class="w-4 h-4 mr-1"></i> \u7F16\u8F91
                </a>
                </div>`);return F(s).find(".action-uponline").on("click",function(){a.getData().status===0?_(a.getData(),1):_(a.getData(),0)}),F(s).find(".action-edit").on("click",function(){n(a.getData())}),s[0]}}],p=C({market_code:"miandan",rangePicker:"",name:"",status:0,startTime:"",endTime:""}),f=C({visible:!1,confirmLoading:!1}),h=U(),c=()=>{h.value.reload(!0)},d=U(),_=(a,s)=>{oe({item_id:a.item_id,status:s}).then(()=>{h.value.reload(!0)})},n=a=>{a.item_url&&(a.href=a.item_url),d.value.edit(a)},i=()=>{f.visible=!1,x("ok",{})};return E({show:()=>{f.visible=!0}}),(a,s)=>{const b=r("Litepicker"),O=r("h-form-item"),I=r("h-form"),P=ae,m=r("h-drawer");return y(),$(te,null,[e(m,{title:"\u4E13\u4EAB\u4EA7\u54C1",size:"xl",visible:f.visible,"confirm-loading":f.confirmLoading,onCancel:i},{header:u(()=>[e(l(k),{variant:"primary",class:"mr-2 shadow-md",onClick:s[0]||(s[0]=N=>d.value.edit({}))},{default:u(()=>[D("\u53D1\u5E03 ")]),_:1})]),default:u(()=>[e(P,{ref_key:"tableRef",ref:h,columns:v,ajaxUrl:l(B),config:l(t),queryParam:p},{search:u(()=>[e(I,{layout:"inline"},{default:u(()=>[e(O,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:u(()=>[e(b,{modelValue:p.rangePicker,"onUpdate:modelValue":s[1]||(s[1]=N=>p.rangePicker=N),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"mt-2 sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),g("div",ke,[e(l(k),{variant:"primary",type:"button",class:"w-full sm:w-16",onClick:c},{default:u(()=>[D(" \u67E5\u8BE2 ")]),_:1})])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1},8,["visible","confirm-loading"]),e(ye,{ref_key:"modal",ref:d,onOk:c},null,512)],64)}}}),Be=M(xe,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/market/miandan/items.vue"]]),Ce={class:"mt-2 xl:mt-0"},Ve=L({__name:"miandan",setup(j){const E=X(),x=Z(()=>`${E.urlPrefix}${E.apiUrl}${ie.getList}`),o=ee({}),B=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"\u6807\u9898",field:"title",formatter(c){return F(`<a target="_blank" href="${c.getData().item_url}">
          ${c.getData().goods.title}
        </a>`)[0]}},{title:"\u4EF7\u683C",field:"goods.price",width:60},{title:"\u56FE\u7247",field:"pic_url",width:100,formatter(c){return F(`<a target="_blank" href="${c.getData().item_url}">
          <img src="${c.getData().goods.pic_url}" />
        </a>`)[0]}},{title:"\u8FD4\u5229\u6BD4\u4F8B",field:"commission_rate",width:60},{title:"\u6210\u4EA4\u4EF7\u6BD4\u4F8B",field:"price_rate",width:100},{title:"\u8D2D\u4E70\u4EBA",field:"member.nick_name",width:100},{title:"\u8BA2\u5355\u53F7",field:"trade_id",width:100},{title:"\u65F6\u95F4",field:"created_at",formatter(c){return me(c.getData().created_at,"YY-MM-DD HH:mm")},width:140}],t=C({market_code:"miandan",rangePicker:"",name:"",status:0,startTime:"",endTime:""}),v=U(),p=()=>{v.value.reload(!0)},f=U(),h=U();return(c,d)=>{const _=r("FormInput"),n=r("h-form-item"),i=r("Litepicker"),w=r("h-form"),a=ae,s=r("h-card");return y(),$(te,null,[e(s,{bordered:!1,title:"\u514D\u5355\u6D3B\u52A8"},{header:u(()=>[e(l(k),{variant:"primary",class:"mr-2 shadow-md",onClick:d[0]||(d[0]=b=>f.value.edit({}))},{default:u(()=>[D("\u8BBE\u7F6E ")]),_:1}),e(l(k),{variant:"primary",class:"mr-2 shadow-md",onClick:d[1]||(d[1]=b=>h.value.show({}))},{default:u(()=>[D("\u5546\u54C1\u5E93\u7BA1\u7406 ")]),_:1})]),default:u(()=>[e(a,{ref_key:"tableRef",ref:v,columns:B,ajaxUrl:l(x),config:l(o),queryParam:t},{search:u(()=>[e(w,{layout:"inline"},{default:u(()=>[e(n,{label:"\u7528\u6237\u540D",content:"",layout:"inline"},{default:u(()=>[e(_,{type:"text",modelValue:t.name,"onUpdate:modelValue":d[2]||(d[2]=b=>t.name=b),class:"mt-2 sm:mt-0 sm:w-40 2xl:w-full"},null,8,["modelValue"])]),_:1}),e(n,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:u(()=>[e(i,{modelValue:t.rangePicker,"onUpdate:modelValue":d[3]||(d[3]=b=>t.rangePicker=b),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"mt-2 sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),g("div",Ce,[e(l(k),{variant:"primary",type:"button",class:"w-full sm:w-16",onClick:p},{default:u(()=>[D(" \u67E5\u8BE2 ")]),_:1})])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1}),e(fe,{ref_key:"dataModal",ref:f,onOk:p},null,512),e(Be,{ref_key:"itemsModal",ref:h,onOk:p},null,512)],64)}}}),Le=M(Ve,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/market/miandan.vue"]]);export{Le as default};
