import{h as j,j as E,o as X,k as I,t as R,v as q,l as d,a as y,b as P,w as s,m as t,q as o,x as b,z as ee,y as D,a3 as te,c as A,F as V,u as B,s as U,_ as Y,p as S,e as oe,a5 as z,a6 as N,Z as W,G,$ as H,C,d as h,a0 as T,a2 as Z}from"./index.53559b39.js";import{g as ae,u as se,c as ne,b as J}from"./market.ad017f2e.js";import{p as K}from"./pick.8b56a9dd.js";const ue={class:"form-check form-switch"},le=t("div",{class:"form-help"},"\u65B9\u4FBF\u7528\u6237\u8054\u7CFB\u7684\u5FAE\u4FE1\u5BA2\u670D\u5E10\u53F7",-1),ie=t("option",{value:0},"\u4F63\u91D1\u5956\u52B1",-1),re=t("option",{value:1},"\u514D\u5355\u6A21\u5F0F",-1),me=[ie,re],de={class:"input-group"},ce=t("div",{class:"input-group-text"},"\u4EBA",-1),fe=t("div",{class:"form-help"},"\u6BCF\u4E2A\u5546\u54C1\u9700\u8981\u780D\u4EF7\u4EBA\u6570",-1),_e={class:"input-group"},pe=t("div",{class:"input-group-text"},"%",-1),be=t("div",{class:"form-help"},"\u6BCF\u780D\u4E00\u6B21\u780D\u6389\u7684\u4F63\u91D1\u767E\u5206\u6BD4",-1),ge={class:"input-group"},ve=t("div",{class:"input-group-text"},"\u5143",-1),we=t("div",{class:"form-help"},"\u6BCF\u780D\u4E00\u6B21\u780D\u6389\u7684\u6700\u5C0F\u91D1\u989D",-1),De={class:"input-group"},he=t("div",{class:"input-group-text"},"\u5143",-1),ke=t("div",{class:"form-help"},"\u6BCF\u780D\u4E00\u6B21\u780D\u6389\u7684\u6700\u5927\u91D1\u989D",-1),Fe=j({__name:"data",emits:["ok"],setup(M,{expose:k,emit:F}){const e=E({weixin:"",mode:0,members:0,commission_rate:0,money1:0,money2:0,status:!1}),x={},r=E({visible:!1,confirmLoading:!1});X(()=>{_()});const v=I(x,R(e)),_=()=>{g()},g=()=>{ae({market_code:"kanjia"}).then(f=>{f.data.item&&q(()=>{const l=K(f.data.item,["weixin","mode","members","commission_rate","money1","money2"]);Object.assign(e,l),l.status=f.data.item.status===1})})},w=f=>{if(f.preventDefault(),v.value.$touch(),v.value.$invalid)v.value.$errors;else{const l=B(e);se(Object.assign(l,{market_code:"kanjia",status:e.status?1:0})).then(m=>{const{code:a}=m||{};a===0?(U.success("\u4FDD\u5B58\u6210\u529F"),F("ok",{})):U.error(m.message)})}},n=()=>{r.visible=!1};return k({edit:()=>{r.visible=!0}}),(f,l)=>{const m=d("h-form-item"),a=d("h-form"),c=d("h-drawer");return y(),P(c,{title:"\u8BBE\u7F6E",visible:r.visible,"confirm-loading":r.confirmLoading,onCancel:n},{footer:s(()=>[t("button",{class:"w-24 mb-2 mr-1 btn btn-primary",onClick:w},"\u4FDD\u5B58")]),default:s(()=>[o(a,{layout:"small"},{default:s(()=>[o(m,{label:"\u5168\u573A\u6D3B\u52A8",content:"",layout:"small"},{default:s(()=>[t("div",ue,[b(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":l[0]||(l[0]=i=>e.status=i)},null,512),[[ee,e.status]])])]),_:1}),o(m,{label:"\u5BA2\u670D\u5FAE\u4FE1",content:"",layout:"small"},{default:s(()=>[b(t("input",{type:"text",class:"form-control","onUpdate:modelValue":l[1]||(l[1]=i=>e.weixin=i)},null,512),[[D,e.weixin]]),le]),_:1}),o(m,{label:"\u780D\u4EF7\u6A21\u5F0F",content:"",layout:"small"},{default:s(()=>[b(t("select",{class:"form-select","onUpdate:modelValue":l[2]||(l[2]=i=>e.mode=i)},me,512),[[te,e.mode]])]),_:1}),e.mode==0?(y(),A(V,{key:0},[o(m,{label:"\u780D\u4EF7\u4EBA\u6570",content:"",layout:"small"},{default:s(()=>[t("div",de,[b(t("input",{type:"text",class:"form-control","onUpdate:modelValue":l[3]||(l[3]=i=>e.members=i)},null,512),[[D,e.members]]),ce]),fe]),_:1}),o(m,{label:"\u780D\u4E00\u6B21\u91D1\u989D",content:"",layout:"small"},{default:s(()=>[t("div",_e,[b(t("input",{type:"text",class:"form-control","onUpdate:modelValue":l[4]||(l[4]=i=>e.commission_rate=i)},null,512),[[D,e.commission_rate]]),pe]),be]),_:1})],64)):(y(),A(V,{key:1},[o(m,{label:"\u6700\u5C0F\u91D1\u989D",content:"",layout:"small"},{default:s(()=>[t("div",ge,[b(t("input",{type:"text",class:"form-control","onUpdate:modelValue":l[5]||(l[5]=i=>e.money1=i)},null,512),[[D,e.money1]]),ve]),we]),_:1}),o(m,{label:"\u6700\u5927\u91D1\u989D",content:"",layout:"small"},{default:s(()=>[t("div",De,[b(t("input",{type:"text",class:"form-control","onUpdate:modelValue":l[6]||(l[6]=i=>e.money2=i)},null,512),[[D,e.money2]]),he]),ke]),_:1})],64))]),_:1})]),_:1},8,["visible","confirm-loading"])}}}),xe=Y(Fe,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/market/kanjia/data.vue"]]),ye=j({__name:"kanjia",emits:["ok"],setup(M,{expose:k,emit:F}){const e=E({item_id:"",commission_rate:0,members:0,start_time:"",end_time:""}),x={},r=E({visible:!1,confirmLoading:!1}),v=()=>{r.visible=!1},_=I(x,R(e)),g=n=>{r.visible=!0,q(()=>{const u=K(n,["item_id","commission_rate","members"]);Object.assign(e,u),e.start_time=z(n.start_time),e.end_time=z(n.end_time)})},w=()=>{if(r.confirmLoading=!0,_.value.$touch(),_.value.$invalid)_.value.$errors,r.confirmLoading=!1;else{let n=B(e);n.start_time&&(n=Object.assign(n,{start_time:N(n.start_time)})),n.end_time&&(n=Object.assign(n,{end_time:N(n.end_time)})),ne(Object.assign(n,{market_code:"kanjia"})).then(u=>{const{code:f}=u||{};f===0?U.success("\u4FDD\u5B58\u6210\u529F"):U.error(u.message),r.confirmLoading=!1,F("ok",n),r.visible=!1})}};return k({edit:g}),(n,u)=>{const f=d("AlertCircleIcon"),l=d("Alert"),m=d("h-form-item"),a=d("Litepicker"),c=d("h-form"),i=d("h-spin"),L=d("LoadingIcon"),O=d("h-modal");return y(),P(O,{title:"\u53D1\u5E03\u5546\u54C1",size:"modal-lg",visible:r.visible,"confirm-loading":r.confirmLoading,onCancel:v},{footer:s(()=>[t("button",{class:"w-24 mb-2 mr-1 btn btn-primary",onClick:u[5]||(u[5]=p=>w())},[S(" \u63D0\u4EA4\u53D1\u5E03 "),r.confirmLoading?(y(),P(L,{key:0,icon:"oval",color:"white",class:"w-4 h-4 ml-2"})):oe("v-if",!0)])]),default:s(()=>[o(i,{spinning:r.confirmLoading},{default:s(()=>[o(c,{layout:"small"},{default:s(()=>[o(l,{class:"flex items-center mb-2 alert-outline-primary"},{default:s(()=>[o(f,{class:"w-6 h-6 mr-2"}),S(" \u6CE8\u610F\u63D0\u793A\uFF1A \u7528\u6237\u83B7\u53D6\u7684\u603B\u780D\u4EF7=\u4F63\u91D1*\u5355\u6B21\u780D\u4EF7\u4F63\u91D1\u6BD4\u4F8B*\u780D\u4EF7\u6B21\u6570 ")]),_:1}),o(m,{label:"\u5546\u54C1id",content:"",layout:"small"},{default:s(()=>[b(t("input",{type:"text",class:"form-control","onUpdate:modelValue":u[0]||(u[0]=p=>e.item_id=p)},null,512),[[D,e.item_id]])]),_:1}),o(m,{label:"\u5355\u6B21\u780D\u4EF7\u4F63\u91D1\u6BD4\u4F8B",content:"",layout:"small"},{default:s(()=>[b(t("input",{type:"text",class:"form-control","onUpdate:modelValue":u[1]||(u[1]=p=>e.commission_rate=p)},null,512),[[D,e.commission_rate]])]),_:1}),o(m,{label:"\u780D\u4EF7\u4EBA\u6570",content:"",layout:"small"},{default:s(()=>[b(t("input",{type:"text",class:"form-control","onUpdate:modelValue":u[2]||(u[2]=p=>e.members=p)},null,512),[[D,e.members]])]),_:1}),o(m,{label:"\u5F00\u59CB\u65F6\u95F4",content:"",layout:"small"},{default:s(()=>[o(a,{modelValue:e.start_time,"onUpdate:modelValue":u[3]||(u[3]=p=>e.start_time=p),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"block w-56 mx-auto form-control"},null,8,["modelValue"])]),_:1}),o(m,{label:"\u7ED3\u675F\u65F6\u95F4",content:"",layout:"small"},{default:s(()=>[o(a,{modelValue:e.end_time,"onUpdate:modelValue":u[4]||(u[4]=p=>e.end_time=p),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"block w-56 mx-auto form-control"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["spinning"])]),_:1},8,["visible","confirm-loading"])}}}),Ee=Y(ye,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/market/kanjia/modal/kanjia.vue"]]),Be=j({__name:"items",emits:["ok"],setup(M,{expose:k,emit:F}){const e=W(),x=G(()=>`${e.urlPrefix}${e.apiUrl}${J.getItems}`),r=H({}),v=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"",field:"title",formatter(a){return h(`
          <div class="flex items-center">
            <div class="w-9 h-9 image-fit zoom-in">
              <a target="_blank" href="${a.getData().goods.item_url}">
                <img class="border-white rounded-lg shadow-md" src="${a.getData().goods.pic_url||""}" />
              </a>
            </div>
            <div class="ml-4">
              <div class="font-medium ">
                ${a.getData().d_title||""}
              </div>
              <div class="text-slate-500 text-xs mt-0.5">
                ${a.getData().title||""}
              </div>
            </div>
          </div>
          `)[0]},download:!0},{title:"\u4EF7\u683C",width:120,field:"price",sorter:!0,formatter(a){return h(`
          <div class="flex flex-col items-start">
            <div class="text-slate-500 text-xs whitespace-nowrap mt-0.5">
              \u5238\u540E\u4EF7:${a.getData().coupon_price}
            </div>
            <div class="text-slate-500 text-xs whitespace-nowrap mt-0.5">
              \u798F\u5229\u91D1:${a.getData().rebate_amount}
            </div>
            <div class="text-slate-500 text-xs whitespace-nowrap mt-0.5">
              \u5230\u624B\u4EF7:${(a.getData().coupon_price-a.getData().rebate_amount).toFixed(2)}
            </div>
          </div>
          `)[0]}},{title:"\u6807\u9898",field:"goods.title",formatter(a){return h(`<a target="_blank" href="${a.getData().goods.item_url}">
          ${a.getData().goods.title}
        </a>`)[0]}},{title:"\u4EF7\u683C",field:"goods.price",width:50},{title:"\u56FE\u7247",field:"pic_url",width:100,formatter(a){return h(`<a target="_blank" href="${a.getData().item_url}">
          <img src="${a.getData().goods.pic_url}" />
        </a>`)[0]}},{title:"\u9500\u91CF",field:"goods.volume",width:50},{title:"\u780D\u4EF7\u4EBA\u6570",field:"members",width:80},{title:"\u65F6\u95F4",field:"",width:140,formatter(a){return h(`<p>${T(a.getData().start_time)}</p>
        <p>${T(a.getData().end_time)}</p>`)[0]}},{title:"\u64CD\u4F5C",field:"action",width:120,formatter(a){const c=h('<a class="flex items-center" href="javascript:;">\u7F16\u8F91</a>');return h(c).on("click",function(i){f(a.getData())}),c[0]}}],_=E({market_code:"kanjia",rangePicker:"",name:"",status:0,startTime:"",endTime:""}),g=E({visible:!1,confirmLoading:!1}),w=C(),n=C(),u=()=>{w.value.reload(!0)},f=a=>{n.value.edit(a)},l=()=>{g.visible=!1,F("ok",{})};return k({show:()=>{g.visible=!0}}),(a,c)=>{const i=d("h-form-item"),L=d("Litepicker"),O=d("h-form"),p=Z,Q=d("h-drawer");return y(),A(V,null,[o(Q,{title:"\u4E13\u4EAB\u4EA7\u54C1",size:"modal-xl",visible:g.visible,"confirm-loading":g.confirmLoading,onCancel:l},{header:s(()=>[t("button",{class:"mr-2 shadow-md btn btn-primary",onClick:c[0]||(c[0]=$=>n.value.edit({}))},"\u53D1\u5E03\u780D\u4EF7\u5546\u54C1 ")]),default:s(()=>[o(p,{ref_key:"tableRef",ref:w,columns:v,ajaxUrl:B(x),config:B(r),queryParam:_},{search:s(()=>[o(O,{layout:"inline"},{default:s(()=>[o(i,{label:"\u7528\u6237\u540D",content:"",layout:"inline"},{default:s(()=>[b(t("input",{"onUpdate:modelValue":c[1]||(c[1]=$=>_.name=$),type:"text",class:"mt-2 form-control sm:mt-0 sm:w-40 2xl:w-full"},null,512),[[D,_.name]])]),_:1}),o(i,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:s(()=>[o(L,{modelValue:_.rangePicker,"onUpdate:modelValue":c[2]||(c[2]=$=>_.rangePicker=$),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"mt-2 form-control sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),t("div",{class:"mt-2 xl:mt-0"},[t("button",{type:"button",class:"w-full btn btn-primary sm:w-16",onClick:u}," \u67E5\u8BE2 ")])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1},8,["visible","confirm-loading"]),o(Ee,{ref_key:"modal",ref:n,onOk:u},null,512)],64)}}}),Ce=Y(Be,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/market/kanjia/items.vue"]]),$e=j({__name:"kanjia",setup(M){const k=W(),F=G(()=>`${k.urlPrefix}${k.apiUrl}${J.shares}`),e=H({}),x=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"\u6807\u9898",field:"goods.title",formatter(n){return h(`<a target="_blank" href="${n.getData().goods.item_url}">
          ${n.getData().goods.title}
        </a>`)[0]}},{title:"\u4EF7\u683C",field:"goods.price",width:100},{title:"\u56FE\u7247",field:"pic_url",width:100,formatter(n){return h(`<a target="_blank" href="${n.getData().item_url}">
          <img src="${n.getData().goods.pic_url}" />
        </a>`)[0]}},{title:"\u5206\u4EAB\u4EBA",field:"member.user_name",width:100},{title:"\u53C2\u4E0E\u4EBA\u6B21",field:"invites",width:100},{title:"\u65F6\u95F4",field:"created_at",formatter(n){return T(n.getData().created_at,"YY-MM-DD HH:mm")},width:140}],r=E({market_code:"kanjia",rangePicker:"",name:"",status:0,startTime:"",endTime:""}),v=C(),_=C(),g=C(),w=()=>{v.value.reload(!0)};return(n,u)=>{const f=d("h-form-item"),l=d("Litepicker"),m=d("h-form"),a=Z,c=d("h-card");return y(),A(V,null,[o(c,{bordered:!1,title:"\u4E13\u9898"},{header:s(()=>[t("button",{class:"mr-2 shadow-md btn btn-primary",onClick:u[0]||(u[0]=i=>g.value.show({}))},"\u63A8\u8350\u4EA7\u54C1 "),t("button",{class:"mr-2 shadow-md btn btn-primary",onClick:u[1]||(u[1]=i=>_.value.edit({}))},"\u8BBE\u7F6E ")]),default:s(()=>[o(a,{ref_key:"tableRef",ref:v,columns:x,ajaxUrl:B(F),config:B(e),queryParam:r},{search:s(()=>[o(m,{layout:"inline"},{default:s(()=>[o(f,{label:"\u7528\u6237\u540D",content:"",layout:"inline"},{default:s(()=>[b(t("input",{"onUpdate:modelValue":u[2]||(u[2]=i=>r.name=i),type:"text",class:"mt-2 form-control sm:mt-0 sm:w-40 2xl:w-full"},null,512),[[D,r.name]])]),_:1}),o(f,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:s(()=>[o(l,{modelValue:r.rangePicker,"onUpdate:modelValue":u[3]||(u[3]=i=>r.rangePicker=i),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"mt-2 form-control sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),t("div",{class:"mt-2 xl:mt-0"},[t("button",{type:"button",class:"w-full btn btn-primary sm:w-16",onClick:w}," \u67E5\u8BE2 ")])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1}),o(xe,{ref_key:"dataModal",ref:_,onOk:w},null,512),o(Ce,{ref_key:"itemsModal",ref:g,onOk:w},null,512)],64)}}}),je=Y($e,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/market/kanjia.vue"]]);export{je as default};
