import{Y as G,r as B,h as R,j as z,a as c,b as P,w as b,p as h,l as t,c as d,I as T,m as i,L as V,F as U,s as w,v as I,q as L,D as j,aw as M,u as y,e as N,C as S,E as Y,n as H}from"./index.9c437169.js";import{_ as J}from"./confirm.vue_vue_type_script_setup_true_lang.fdb10ac2.js";const C=G(),A={getView:"/api/user/open/miniprogram/view",list:"/api/user/open/miniprogram/list",templateList:"/api/user/open/template/list",logsList:"/api/user/open/template/logs",selectUpdate:"/api/user/open/template/select",getRelease:"/api/user/open/template/release"};function K(l){return B({baseURL:C.miniProgramUrl,url:A.list,method:"post",data:l})}function Q(l){return B({baseURL:C.miniProgramUrl,url:A.getRelease,method:"post",data:l})}function W(l){return B({baseURL:C.miniProgramUrl,url:A.selectUpdate,method:"post",data:l})}function X(l){return B({baseURL:C.miniProgramUrl,url:A.getView,method:"post",data:l})}function Z(l){return B({baseURL:C.miniProgramUrl,url:A.templateList,method:"post",data:l})}function tt(l){return B({baseURL:C.miniProgramUrl,url:A.logsList,method:"post",data:l})}const et={class:"col-span-12 overflow-auto intro-y lg:overflow-visible"},st={class:"table -mt-2 table-report"},at=t("thead",null,[t("tr",null,[t("th",{class:"whitespace-nowrap"},"\u6A21\u677F\u7F16\u53F7"),t("th",{class:"text-center whitespace-nowrap"},"\u7248\u672C"),t("th",{class:"whitespace-nowrap"},"\u5907\u6CE8"),t("th",{class:"text-center whitespace-nowrap"})])],-1),it={class:"w-20 text-center"},ot={class:"text-center"},nt={class:""},rt={class:"w-20"},ut={class:"flex items-center justify-center"},lt=["onClick"],ct=R({__name:"template",emits:["ok","submit"],setup(l,{expose:s,emit:v}){const e=z({visible:!1,confirmLoading:!1,name:"",items:[]}),n=z({authorizer_appid:"",platform_type:0}),f=()=>{e.confirmLoading=!0,Z({authorizer_appid:n.authorizer_appid,platform_type:n.platform_type}).then(u=>{e.confirmLoading=!1,u.data.items&&I(()=>{e.items=u.data.items})})},E=()=>{e.visible=!1},_=u=>{e.visible=!0,n.platform_type=u.platform_type,n.authorizer_appid=u.authorizer_appid,e.name=u.nick,f()},g=u=>{e.confirmLoading=!0,W({platform_type:n.platform_type,authorizer_appid:n.authorizer_appid,template_id:u.template_id,user_version:u.user_version,user_desc:u.user_desc}).then(a=>{const{code:m}=a||{};m===0?(L.success("\u4FDD\u5B58\u6210\u529F"),F()):L.error(a.message),v("submit","")})},F=()=>{e.visible=!1};return s({show:_,hideModel:F}),(u,a)=>{var x;const m=w("h-spin"),r=w("h-modal");return c(),P(r,{title:"\u6A21\u7248\u66F4\u65B0\u8BB0\u5F55 ("+((x=e.name)!=null?x:"")+")",size:"modal-xl",visible:e.visible,"confirm-loading":e.confirmLoading,onCancel:E},{footer:b(()=>[]),default:b(()=>[h(m,{spinning:e.confirmLoading},{default:b(()=>[t("div",et,[t("table",st,[at,t("tbody",null,[(c(!0),d(U,null,T(e.items,(p,o)=>(c(),d("tr",{key:o,class:"intro-x"},[t("td",it,i(p.template_id),1),t("td",ot,i(p.user_version),1),t("td",nt,i(p.user_desc),1),t("td",rt,[t("div",ut,[t("a",{class:"flex items-center mr-3 hover:text-red-500",href:"javascript:0",onClick:V(k=>g(p),["stop"])}," \u9009\u62E9 ",8,lt)])])]))),128))])])])]),_:1},8,["spinning"])]),_:1},8,["title","visible","confirm-loading"])}}}),mt={class:"py-10"},dt={class:"flex justify-center"},_t={class:"px-5 mt-10"},pt={class:"text-lg font-medium text-center"},ht={class:"mt-2 text-center text-slate-500"},ft={key:0,class:"ml-3 text-base text-slate-600 dark:text-slate-400 lg:mx-auto lg:mt-3 lg:w-32"},gt={class:"col-span-12 overflow-auto intro-y lg:overflow-visible"},xt={class:"table -mt-2 table-report"},bt=t("thead",null,[t("tr",null,[t("th",{class:"whitespace-nowrap"},"\u65F6\u95F4"),t("th",{class:"text-center whitespace-nowrap"},"\u6A21\u677F\u7F16\u53F7"),t("th",{class:"text-center whitespace-nowrap"},"\u72B6\u6001"),t("th",{class:"whitespace-nowrap"},"\u5907\u6CE8")])],-1),wt={class:"w-48 text-center"},vt={class:"w-20 text-center"},Ft={class:"text-center w-36"},yt={class:""},Bt=R({__name:"log",emits:["ok"],setup(l,{expose:s,emit:v}){const e=z({visible:!1,confirmLoading:!1,name:"",items:[],mini:{}}),n=z({authorizer_appid:"",platform_type:0}),f=j(()=>{if(e.mini.id){if(e.mini.status===1||e.mini.status===2)return 2;if(e.mini.status===0||e.mini.status===-1)return 1}return 0}),E=j(()=>{if(e.mini.id){if(e.mini.status===-1)return"\u5BA1\u6838\u62D2\u7EDD";if(e.mini.status===0)return"\u5BA1\u6838\u4E2D";if(e.mini.status===1)return"\u6A21\u677F\u5BA1\u6838\u901A\u8FC7"}return"\u7B49\u5F85\u5BA1\u6838"}),_=j(()=>e.mini.id&&e.mini.status_reason&&e.mini.status===-1?e.mini.status_reason:"\u5F85\u5FAE\u4FE1\u5BA1\u6838\u901A\u8FC7\uFF0C\u5373\u53EF\u53D1\u5E03\u4E0A\u7EBF"),g=()=>{e.confirmLoading=!0,tt({authorizer_appid:n.authorizer_appid,platform_type:n.platform_type}).then(r=>{e.confirmLoading=!1,r.data.items&&I(()=>{e.items=r.data.items})})},F=()=>{e.visible=!1},u=r=>{e.visible=!0,n.platform_type=r.platform_type,n.authorizer_appid=r.authorizer_appid,e.name=r.nick,e.mini=r,g()},a=()=>{e.confirmLoading=!0,Q({platform_type:n.platform_type,authorizer_appid:n.authorizer_appid}).then(r=>{const{code:x}=r||{};x===0?L.success(r.message):L.error(r.message),g(),v("ok","")})};return s({show:u,hideModel:()=>{e.visible=!1}}),(r,x)=>{var k;const p=w("h-spin"),o=w("h-modal");return c(),P(o,{title:"\u5BA1\u6838\u8BB0\u5F55 ("+((k=e.name)!=null?k:"")+")",size:"modal-xl",visible:e.visible,"confirm-loading":e.confirmLoading,onCancel:F},{footer:b(()=>[]),default:b(()=>[h(p,{spinning:e.confirmLoading},{default:b(()=>{var D,q;return[t("div",mt,[t("div",dt,[t("button",{class:M(["w-10 h-10 mx-2 rounded-full intro-y btn",{"btn-primary":y(f)==0}])}," 1 ",2),t("button",{class:M(["w-10 h-10 mx-2 rounded-full intro-y btn bg-slate-100 text-slate-500 dark:border-darkmode-400 dark:bg-darkmode-400",{"btn-primary":y(f)==1}])}," 2 ",2),t("button",{class:M(["w-10 h-10 mx-2 rounded-full intro-y btn bg-slate-100 text-slate-500 dark:border-darkmode-400 dark:bg-darkmode-400",{"btn-primary":y(f)==2}])}," 3 ",2)]),t("div",_t,[t("div",pt,i((D=y(E))!=null?D:""),1),t("div",ht,i((q=y(_))!=null?q:""),1),e.mini.status==1?(c(),d("div",ft,[t("button",{onClick:a},"\u7ACB\u5373\u6A21\u677F\u4E0A\u7EBF")])):N("",!0)])]),t("div",gt,[t("table",xt,[bt,t("tbody",null,[(c(!0),d(U,null,T(e.items,($,O)=>(c(),d("tr",{key:O,class:"intro-x"},[t("td",wt,i($.created_at),1),t("td",vt,i($.template_id),1),t("td",Ft,i($.status===0?"\u5BA1\u6838\u4E2D":$.status===-1?"\u62D2\u7EDD":"\u5BA1\u6838\u901A\u8FC7"),1),t("td",yt,i($.user_desc),1)]))),128))])])])]}),_:1},8,["spinning"])]),_:1},8,["title","visible","confirm-loading"])}}}),Ct={class:"py-10 mt-5 intro-y box sm:py-20"},At={class:"flex justify-center"},Et={class:"flex flex-col items-center justify-center gap-y-3"},kt=["href"],$t=t("p",null,[H(" \u6388\u6743\u5C0F\u7A0B\u5E8F\u4E4B\u524D\uFF0C\u8BF7\u5148\u524D\u5F80\u5FAE\u4FE1\u516C\u4F17\u53F7\u5E73\u53F0\u521B\u5EFA\u597D\u5C0F\u7A0B\u5E8F,"),t("a",{href:"https://mp.weixin.qq.com/",class:"",target:"_blank"},"\u300B\u300B\u5FAE\u4FE1\u516C\u4F17\u53F7\u5E73\u53F0 ")],-1),zt={key:0,class:"px-5 pt-5 mt-5 intro-y box"},Lt={class:"flex flex-col pb-5 -mx-5 border-b border-slate-200/60 dark:border-darkmode-400 lg:flex-row"},Dt={class:"flex items-center justify-center flex-1 px-5 lg:justify-start"},jt={class:"relative flex-none w-20 h-20 image-fit sm:h-24 sm:w-24 lg:h-32 lg:w-32"},Ut=["alt","src"],Mt={class:"absolute bottom-0 right-0 flex items-center justify-center p-2 mb-1 mr-1 rounded-full bg-primary"},St={class:"ml-5"},Rt={class:"w-24 text-lg font-medium truncate sm:w-40 sm:whitespace-normal"},Tt={class:"text-slate-500"},qt={class:"flex-1 px-5 pt-5 mt-6 border-t border-l border-r border-slate-200/60 dark:border-darkmode-400 lg:mt-0 lg:border-t-0 lg:pt-0"},Pt=t("div",{class:"font-medium text-center lg:mt-3 lg:text-left"}," \u8BE6\u60C5 ",-1),Vt={class:"flex flex-col items-center justify-center mt-4 lg:items-start"},It={class:"flex items-center truncate sm:whitespace-normal"},Nt={class:"flex items-center mt-3 truncate sm:whitespace-normal"},Ot={class:"flex items-center mt-3 truncate sm:whitespace-normal"},Gt={class:"flex items-center mt-3 truncate sm:whitespace-normal"},Yt={class:"flex-1 px-5 pt-5 mt-6 border-t border-slate-200/60 dark:border-darkmode-400 lg:mt-0 lg:border-0 lg:pt-0"},Ht=t("div",{class:"font-medium text-center lg:mt-5 lg:text-left"}," \u4ECB\u7ECD ",-1),Jt={class:"flex items-center justify-center mt-2 lg:justify-start"},Kt={class:"flex mr-2"},Qt=t("h2",{class:"mt-10 text-lg font-medium intro-y"},"\u6388\u6743\u5217\u8868",-1),Wt={class:"col-span-12 overflow-auto intro-y lg:overflow-visible"},Xt={class:"table -mt-2 table-report"},Zt=t("thead",null,[t("tr",null,[t("th",{class:"whitespace-nowrap"},"\u5934\u50CF"),t("th",{class:"whitespace-nowrap"},"\u540D\u79F0"),t("th",{class:"text-center whitespace-nowrap"},"\u5B9E\u540D\u8BA4\u8BC1"),t("th",{class:"text-center whitespace-nowrap"},"\u6388\u6743\u65F6\u95F4"),t("th",{class:"text-center whitespace-nowrap"},"\u8D26\u53F7\u7C7B\u578B"),t("th",{class:"text-center whitespace-nowrap"})])],-1),te={class:"w-20"},ee={class:"flex"},se={class:"w-10 h-10 image-fit zoom-in"},ae={href:"",class:"font-medium whitespace-nowrap"},ie={class:"mt-0.5 whitespace-nowrap text-xs text-slate-500"},oe={class:"text-center"},ne={class:"text-center"},re={class:"w-40"},ue={class:"flex items-center justify-center text-success"},le={class:"w-56 table-report__action"},ce={class:"flex items-center justify-center"},me=["onClick"],de=["href"],he=R({__name:"dashboard",setup(l){const s=z({miniprogram:{authorizer_appid:"",account_type:"",principal_type:"",auth_date:"",nick:"",head_img:"",principal_name:"",realname_status:"",signature:""},authorize_url:"",items:[],templates:[],logs:[],modal:{template:!1},template:{authorizer_appid:""},confirmLoading:!1}),v=S(),e=S(),n=S(),f=j(()=>{if(s.miniprogram.account_type){if(s.miniprogram.account_type==="0")return"\u8BA2\u9605\u53F7";if(s.miniprogram.account_type==="1")return"\u8001\u8BA2\u9605\u53F7";if(s.miniprogram.account_type==="2")return"\u670D\u52A1\u53F7";if(s.miniprogram.account_type==="3")return"\u5C0F\u7A0B\u5E8F"}return""});Y(()=>{E()});const E=()=>{_()},_=()=>{X({platform_type:100}).then(a=>{a.data.item&&(s.miniprogram=a.data.item),a.data.authorize_url&&(s.authorize_url=a.data.authorize_url),a.message&&L.success(a.message)}),K({platform_type:100}).then(a=>{a.data.items&&(s.items=a.data.items)})},g=a=>{v.value.show(a)},F=a=>{e.value.show(a)},u=a=>{n.value.show(a)};return(a,m)=>{const r=w("CameraIcon"),x=w("Tippy"),p=w("h-card");return c(),d(U,null,[h(p,{bordered:!1,title:"\u5C0F\u7A0B\u5E8F\u6388\u6743"},{default:b(()=>[t("div",Ct,[t("div",At,[t("div",Et,[t("a",{class:"btn btn-primary",target:"_blank",href:s.authorize_url,onClick:m[0]||(m[0]=o=>g({title:"\u6388\u6743\u786E\u8BA4",content:"\u786E\u8BA4\u6388\u6743\u5B8C\u6210"}))}," \u6388\u6743\u516C\u4F17\u53F7\\\u5C0F\u7A0B\u5E8F ",8,kt),$t])])]),s.miniprogram.authorizer_appid.length>0?(c(),d("div",zt,[t("div",Lt,[t("div",Dt,[t("div",jt,[t("img",{alt:s.miniprogram.nick,class:"rounded-full",src:s.miniprogram.head_img},null,8,Ut),t("div",Mt,[h(r,{class:"w-4 h-4 text-white"})])]),t("div",St,[t("div",Rt,i(s.miniprogram.nick),1),t("div",Tt,i(s.miniprogram.authorizer_appid),1)])]),t("div",qt,[Pt,t("div",Vt,[t("div",It," \u4E3B\u4F53\u540D\u79F0:"+i(s.miniprogram.principal_name),1),t("div",Nt," \u5B9E\u540D\u8BA4\u8BC1: "+i(s.miniprogram.realname_status=="1"?"\u662F":"\u5426"),1),t("div",Ot," \u6388\u6743\u65F6\u95F4: "+i(s.miniprogram.auth_date),1),t("div",Gt," \u8D26\u53F7\u7C7B\u578B: "+i(y(f)),1)])]),t("div",Yt,[Ht,t("div",Jt,[t("div",Kt,i(s.miniprogram.signature),1)])])])])):N("",!0),Qt,t("div",Wt,[t("table",Xt,[Zt,t("tbody",null,[(c(!0),d(U,null,T(s.items,(o,k)=>(c(),d("tr",{key:k,class:"intro-x"},[t("td",te,[t("div",ee,[t("div",se,[h(x,{tag:"img",alt:o.nick,class:"rounded-full",src:o.head_img,content:`${o.nick}`},null,8,["alt","src","content"])])])]),t("td",null,[t("a",ae,i(o.nick),1),t("div",ie,i(o.principal_name),1)]),t("td",oe,i(o.realname_status=="1"?"\u662F":"\u5426"),1),t("td",ne,i(o.auth_date),1),t("td",re,[t("div",ue,i(o.account_type==="0"?"\u8BA2\u9605\u53F7":o.account_type==="1"?"\u8001\u8BA2\u9605\u53F7":o.account_type==="2"?"\u670D\u52A1\u53F7":o.account_type==="3"?"\u5C0F\u7A0B\u5E8F":""),1)]),t("td",le,[t("div",ce,[t("a",{class:"flex items-center mr-3 hover:text-red-500",href:"javascript:void(0)",onClick:V(D=>F(o),["stop"])}," \u6A21\u7248\u4E0A\u67B6 ",8,me),t("a",{class:"flex items-center hover:text-red-500",target:"_blank",href:s.authorize_url,onClick:m[1]||(m[1]=D=>g({title:"\u6388\u6743\u786E\u8BA4",content:"\u786E\u8BA4\u6388\u6743\u5B8C\u6210"}))}," \u6388\u6743 ",8,de)])])]))),128))])])])]),_:1}),h(J,{ref_key:"confirmModal",ref:v,onOk:_},null,512),h(ct,{ref_key:"templateModal",ref:e,onOk:_,onSubmit:u},null,512),h(Bt,{ref_key:"logModal",ref:n,onOk:_},null,512)],64)}}});export{he as default};
