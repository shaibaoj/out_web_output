import{h as U,j as E,o as Q,k as N,t as R,v as q,a as x,b as O,w as n,l as e,p as o,x as g,z as X,y as h,a2 as tt,c as A,F as V,u as B,q as Y,s as d,n as T,e as et,a4 as S,a5 as z,Y as I,D as W,Z as G,C,d as F,$ as P,a1 as H}from"./index.64e15f73.js";import{g as ot,u as at,c as nt,b as Z}from"./market.a6091a71.js";import{p as J}from"./pick.57748f43.js";const lt={class:"form-check form-switch"},st=e("div",{class:"form-help"},"\u65B9\u4FBF\u7528\u6237\u8054\u7CFB\u7684\u5FAE\u4FE1\u5BA2\u670D\u5E10\u53F7",-1),ut=e("option",{value:0},"\u4F63\u91D1\u5956\u52B1",-1),it=e("option",{value:1},"\u514D\u5355\u6A21\u5F0F",-1),rt=[ut,it],mt={class:"input-group"},dt=e("div",{class:"input-group-text"},"\u4EBA",-1),ct=e("div",{class:"form-help"},"\u6BCF\u4E2A\u5546\u54C1\u9700\u8981\u780D\u4EF7\u4EBA\u6570",-1),ft={class:"input-group"},_t=e("div",{class:"input-group-text"},"%",-1),pt=e("div",{class:"form-help"},"\u6BCF\u780D\u4E00\u6B21\u780D\u6389\u7684\u4F63\u91D1\u767E\u5206\u6BD4",-1),gt={class:"input-group"},bt=e("div",{class:"input-group-text"},"\u5143",-1),Dt=e("div",{class:"form-help"},"\u6BCF\u780D\u4E00\u6B21\u780D\u6389\u7684\u6700\u5C0F\u91D1\u989D",-1),vt={class:"input-group"},ht=e("div",{class:"input-group-text"},"\u5143",-1),Ft=e("div",{class:"form-help"},"\u6BCF\u780D\u4E00\u6B21\u780D\u6389\u7684\u6700\u5927\u91D1\u989D",-1),yt=U({__name:"data",emits:["ok"],setup(M,{expose:y,emit:k}){const t=E({weixin:"",mode:0,members:0,commission_rate:0,money1:0,money2:0,status:!1}),w={},r=E({visible:!1,confirmLoading:!1});Q(()=>{_()});const D=N(w,R(t)),_=()=>{b()},b=()=>{ot({market_code:"kanjia"}).then(f=>{f.data.item&&q(()=>{const u=J(f.data.item,["weixin","mode","members","commission_rate","money1","money2"]);Object.assign(t,u),u.status=f.data.item.status===1})})},v=f=>{if(f.preventDefault(),D.value.$touch(),D.value.$invalid)D.value.$errors;else{const u=B(t);at(Object.assign(u,{market_code:"kanjia",status:t.status?1:0})).then(m=>{const{code:a}=m||{};a===0?(Y.success("\u4FDD\u5B58\u6210\u529F"),k("ok",{})):Y.error(m.message)})}},l=()=>{r.visible=!1};return y({edit:()=>{r.visible=!0}}),(f,u)=>{const m=d("h-form-item"),a=d("h-form"),c=d("h-drawer");return x(),O(c,{title:"\u8BBE\u7F6E",visible:r.visible,"confirm-loading":r.confirmLoading,onCancel:l},{footer:n(()=>[e("button",{class:"w-24 mb-2 mr-1 btn btn-primary",onClick:v},"\u4FDD\u5B58")]),default:n(()=>[o(a,{layout:"small"},{default:n(()=>[o(m,{label:"\u5168\u573A\u6D3B\u52A8",content:"",layout:"small"},{default:n(()=>[e("div",lt,[g(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":u[0]||(u[0]=i=>t.status=i)},null,512),[[X,t.status]])])]),_:1}),o(m,{label:"\u5BA2\u670D\u5FAE\u4FE1",content:"",layout:"small"},{default:n(()=>[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":u[1]||(u[1]=i=>t.weixin=i)},null,512),[[h,t.weixin]]),st]),_:1}),o(m,{label:"\u780D\u4EF7\u6A21\u5F0F",content:"",layout:"small"},{default:n(()=>[g(e("select",{class:"form-select","onUpdate:modelValue":u[2]||(u[2]=i=>t.mode=i)},rt,512),[[tt,t.mode]])]),_:1}),t.mode==0?(x(),A(V,{key:0},[o(m,{label:"\u780D\u4EF7\u4EBA\u6570",content:"",layout:"small"},{default:n(()=>[e("div",mt,[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":u[3]||(u[3]=i=>t.members=i)},null,512),[[h,t.members]]),dt]),ct]),_:1}),o(m,{label:"\u780D\u4E00\u6B21\u91D1\u989D",content:"",layout:"small"},{default:n(()=>[e("div",ft,[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":u[4]||(u[4]=i=>t.commission_rate=i)},null,512),[[h,t.commission_rate]]),_t]),pt]),_:1})],64)):(x(),A(V,{key:1},[o(m,{label:"\u6700\u5C0F\u91D1\u989D",content:"",layout:"small"},{default:n(()=>[e("div",gt,[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":u[5]||(u[5]=i=>t.money1=i)},null,512),[[h,t.money1]]),bt]),Dt]),_:1}),o(m,{label:"\u6700\u5927\u91D1\u989D",content:"",layout:"small"},{default:n(()=>[e("div",vt,[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":u[6]||(u[6]=i=>t.money2=i)},null,512),[[h,t.money2]]),ht]),Ft]),_:1})],64))]),_:1})]),_:1},8,["visible","confirm-loading"])}}}),kt=U({__name:"kanjia",emits:["ok"],setup(M,{expose:y,emit:k}){const t=E({item_id:"",commission_rate:0,members:0,start_time:"",end_time:""}),w={},r=E({visible:!1,confirmLoading:!1}),D=()=>{r.visible=!1},_=N(w,R(t)),b=l=>{r.visible=!0,q(()=>{const s=J(l,["item_id","commission_rate","members"]);Object.assign(t,s),t.start_time=S(l.start_time),t.end_time=S(l.end_time)})},v=()=>{if(r.confirmLoading=!0,_.value.$touch(),_.value.$invalid)_.value.$errors,r.confirmLoading=!1;else{let l=B(t);l.start_time&&(l=Object.assign(l,{start_time:z(l.start_time)})),l.end_time&&(l=Object.assign(l,{end_time:z(l.end_time)})),nt(Object.assign(l,{market_code:"kanjia"})).then(s=>{const{code:f}=s||{};f===0?Y.success("\u4FDD\u5B58\u6210\u529F"):Y.error(s.message),r.confirmLoading=!1,k("ok",l),r.visible=!1})}};return y({edit:b}),(l,s)=>{const f=d("AlertCircleIcon"),u=d("Alert"),m=d("h-form-item"),a=d("Litepicker"),c=d("h-form"),i=d("h-spin"),j=d("LoadingIcon"),L=d("h-modal");return x(),O(L,{title:"\u53D1\u5E03\u5546\u54C1",size:"modal-lg",visible:r.visible,"confirm-loading":r.confirmLoading,onCancel:D},{footer:n(()=>[e("button",{class:"w-24 mb-2 mr-1 btn btn-primary",onClick:s[5]||(s[5]=p=>v())},[T(" \u63D0\u4EA4\u53D1\u5E03 "),r.confirmLoading?(x(),O(j,{key:0,icon:"oval",color:"white",class:"w-4 h-4 ml-2"})):et("",!0)])]),default:n(()=>[o(i,{spinning:r.confirmLoading},{default:n(()=>[o(c,{layout:"small"},{default:n(()=>[o(u,{class:"flex items-center mb-2 alert-outline-primary"},{default:n(()=>[o(f,{class:"w-6 h-6 mr-2"}),T(" \u6CE8\u610F\u63D0\u793A\uFF1A \u7528\u6237\u83B7\u53D6\u7684\u603B\u780D\u4EF7=\u4F63\u91D1*\u5355\u6B21\u780D\u4EF7\u4F63\u91D1\u6BD4\u4F8B*\u780D\u4EF7\u6B21\u6570 ")]),_:1}),o(m,{label:"\u5546\u54C1id",content:"",layout:"small"},{default:n(()=>[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=p=>t.item_id=p)},null,512),[[h,t.item_id]])]),_:1}),o(m,{label:"\u5355\u6B21\u780D\u4EF7\u4F63\u91D1\u6BD4\u4F8B",content:"",layout:"small"},{default:n(()=>[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=p=>t.commission_rate=p)},null,512),[[h,t.commission_rate]])]),_:1}),o(m,{label:"\u780D\u4EF7\u4EBA\u6570",content:"",layout:"small"},{default:n(()=>[g(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[2]||(s[2]=p=>t.members=p)},null,512),[[h,t.members]])]),_:1}),o(m,{label:"\u5F00\u59CB\u65F6\u95F4",content:"",layout:"small"},{default:n(()=>[o(a,{modelValue:t.start_time,"onUpdate:modelValue":s[3]||(s[3]=p=>t.start_time=p),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"block w-56 mx-auto form-control"},null,8,["modelValue"])]),_:1}),o(m,{label:"\u7ED3\u675F\u65F6\u95F4",content:"",layout:"small"},{default:n(()=>[o(a,{modelValue:t.end_time,"onUpdate:modelValue":s[4]||(s[4]=p=>t.end_time=p),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"block w-56 mx-auto form-control"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["spinning"])]),_:1},8,["visible","confirm-loading"])}}}),wt=U({__name:"items",emits:["ok"],setup(M,{expose:y,emit:k}){const t=I(),w=W(()=>`${t.urlPrefix}${t.apiUrl}${Z.getItems}`),r=G({}),D=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"",field:"title",formatter(a){return F(`
          <div class="flex items-center">
            <div class="w-9 h-9 image-fit zoom-in">
              <a target="_blank" href="${a.getData().goods.item_url}">
                <img class="border-white rounded-lg shadow-md" src="${a.getData().goods.pic_url||""}" />
              </a>
            </div>
            <div class="ml-4">
              <div class="font-medium ">
                ${a.getData().d_title||""}
              </div>
              <div class="text-slate-500 text-xs mt-0.5">
                ${a.getData().title||""}
              </div>
            </div>
          </div>
          `)[0]},download:!0},{title:"\u4EF7\u683C",width:120,field:"price",sorter:!0,formatter(a){return F(`
          <div class="flex flex-col items-start">
            <div class="text-slate-500 text-xs whitespace-nowrap mt-0.5">
              \u5238\u540E\u4EF7:${a.getData().coupon_price}
            </div>
            <div class="text-slate-500 text-xs whitespace-nowrap mt-0.5">
              \u798F\u5229\u91D1:${a.getData().rebate_amount}
            </div>
            <div class="text-slate-500 text-xs whitespace-nowrap mt-0.5">
              \u798F\u5229\u4EF7:${(a.getData().coupon_price-a.getData().rebate_amount).toFixed(2)}
            </div>
          </div>
          `)[0]}},{title:"\u6807\u9898",field:"goods.title",formatter(a){return F(`<a target="_blank" href="${a.getData().goods.item_url}">
          ${a.getData().goods.title}
        </a>`)[0]}},{title:"\u4EF7\u683C",field:"goods.price",width:50},{title:"\u56FE\u7247",field:"pic_url",width:100,formatter(a){return F(`<a target="_blank" href="${a.getData().item_url}">
          <img src="${a.getData().goods.pic_url}" />
        </a>`)[0]}},{title:"\u9500\u91CF",field:"goods.volume",width:50},{title:"\u780D\u4EF7\u4EBA\u6570",field:"members",width:80},{title:"\u65F6\u95F4",field:"",width:140,formatter(a){return F(`<p>${P(a.getData().start_time)}</p>
        <p>${P(a.getData().end_time)}</p>`)[0]}},{title:"\u64CD\u4F5C",field:"action",width:120,formatter(a){const c=F('<a class="flex items-center" href="javascript:;">\u7F16\u8F91</a>');return F(c).on("click",function(i){f(a.getData())}),c[0]}}],_=E({market_code:"kanjia",rangePicker:"",name:"",status:0,startTime:"",endTime:""}),b=E({visible:!1,confirmLoading:!1}),v=C(),l=C(),s=()=>{v.value.reload(!0)},f=a=>{l.value.edit(a)},u=()=>{b.visible=!1,k("ok",{})};return y({show:()=>{b.visible=!0}}),(a,c)=>{const i=d("h-form-item"),j=d("Litepicker"),L=d("h-form"),p=H,K=d("h-drawer");return x(),A(V,null,[o(K,{title:"\u4E13\u4EAB\u4EA7\u54C1",size:"modal-xl",visible:b.visible,"confirm-loading":b.confirmLoading,onCancel:u},{header:n(()=>[e("button",{class:"mr-2 shadow-md btn btn-primary",onClick:c[0]||(c[0]=$=>l.value.edit({}))},"\u53D1\u5E03\u780D\u4EF7\u5546\u54C1 ")]),default:n(()=>[o(p,{ref_key:"tableRef",ref:v,columns:D,ajaxUrl:B(w),config:B(r),queryParam:_},{search:n(()=>[o(L,{layout:"inline"},{default:n(()=>[o(i,{label:"\u7528\u6237\u540D",content:"",layout:"inline"},{default:n(()=>[g(e("input",{"onUpdate:modelValue":c[1]||(c[1]=$=>_.name=$),type:"text",class:"mt-2 form-control sm:mt-0 sm:w-40 2xl:w-full"},null,512),[[h,_.name]])]),_:1}),o(i,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:n(()=>[o(j,{modelValue:_.rangePicker,"onUpdate:modelValue":c[2]||(c[2]=$=>_.rangePicker=$),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"mt-2 form-control sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),e("div",{class:"mt-2 xl:mt-0"},[e("button",{type:"button",class:"w-full btn btn-primary sm:w-16",onClick:s}," \u67E5\u8BE2 ")])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1},8,["visible","confirm-loading"]),o(kt,{ref_key:"modal",ref:l,onOk:s},null,512)],64)}}}),Ct=U({__name:"kanjia",setup(M){const y=I(),k=W(()=>`${y.urlPrefix}${y.apiUrl}${Z.shares}`),t=G({}),w=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"\u6807\u9898",field:"goods.title",formatter(l){return F(`<a target="_blank" href="${l.getData().goods.item_url}">
          ${l.getData().goods.title}
        </a>`)[0]}},{title:"\u4EF7\u683C",field:"goods.price",width:100},{title:"\u56FE\u7247",field:"pic_url",width:100,formatter(l){return F(`<a target="_blank" href="${l.getData().item_url}">
          <img src="${l.getData().goods.pic_url}" />
        </a>`)[0]}},{title:"\u5206\u4EAB\u4EBA",field:"member.user_name",width:100},{title:"\u53C2\u4E0E\u4EBA\u6B21",field:"invites",width:100},{title:"\u65F6\u95F4",field:"created_at",formatter(l){return P(l.getData().created_at,"YY-MM-DD HH:mm")},width:140}],r=E({market_code:"kanjia",rangePicker:"",name:"",status:0,startTime:"",endTime:""}),D=C(),_=C(),b=C(),v=()=>{D.value.reload(!0)};return(l,s)=>{const f=d("h-form-item"),u=d("Litepicker"),m=d("h-form"),a=H,c=d("h-card");return x(),A(V,null,[o(c,{bordered:!1,title:"\u4E13\u9898"},{header:n(()=>[e("button",{class:"mr-2 shadow-md btn btn-primary",onClick:s[0]||(s[0]=i=>b.value.show({}))},"\u63A8\u8350\u4EA7\u54C1 "),e("button",{class:"mr-2 shadow-md btn btn-primary",onClick:s[1]||(s[1]=i=>_.value.edit({}))},"\u8BBE\u7F6E ")]),default:n(()=>[o(a,{ref_key:"tableRef",ref:D,columns:w,ajaxUrl:B(k),config:B(t),queryParam:r},{search:n(()=>[o(m,{layout:"inline"},{default:n(()=>[o(f,{label:"\u7528\u6237\u540D",content:"",layout:"inline"},{default:n(()=>[g(e("input",{"onUpdate:modelValue":s[2]||(s[2]=i=>r.name=i),type:"text",class:"mt-2 form-control sm:mt-0 sm:w-40 2xl:w-full"},null,512),[[h,r.name]])]),_:1}),o(f,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:n(()=>[o(u,{modelValue:r.rangePicker,"onUpdate:modelValue":s[3]||(s[3]=i=>r.rangePicker=i),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"mt-2 form-control sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),e("div",{class:"mt-2 xl:mt-0"},[e("button",{type:"button",class:"w-full btn btn-primary sm:w-16",onClick:v}," \u67E5\u8BE2 ")])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1}),o(yt,{ref_key:"dataModal",ref:_,onOk:v},null,512),o(wt,{ref_key:"itemsModal",ref:b,onOk:v},null,512)],64)}}});export{Ct as default};
