import{h as M,j as y,k as W,t as H,o as oe,v as S,l as m,a as F,b as I,w as l,m as u,q as n,x as w,z as ae,y as x,u as C,s as U,_ as Y,I as ie,aq as ne,p as N,e as q,n as B,c as A,a3 as ue,a5 as G,a6 as R,Z,G as J,$ as K,C as $,F as Q,d as h,a2 as X,a0 as se}from"./index.66cbea10.js";import{g as le,u as ee,c as re,b as te}from"./market.bbd9deb6.js";import{p as z}from"./pick.a33a9641.js";import{a as me,f as de}from"./goods.470596c7.js";const ce={class:"form-check form-switch"},fe=M({__name:"data",emits:["ok"],setup(L,{expose:D,emit:E}){const t=y({weixin:"",status:!1}),k={},e=y({visible:!1,confirmLoading:!1,data:{benefits_invite_buyer_rate:0}}),g=W(k,H(t));oe(()=>{p()});const p=()=>{_()},_=()=>{le({market_code:"miandan"}).then(c=>{c.data.item&&S(()=>{const i=z(c.data.item,["weixin"]);Object.assign(t,i),i.status=c.data.item.status===1})})},b=c=>{if(c.preventDefault(),g.value.$touch(),g.value.$invalid)g.value.$errors;else{const i=C(t);ee(Object.assign(i,{market_code:"miandan",status:t.status?1:0})).then(o=>{const{code:v}=o||{};v===0?U.success("\u4FDD\u5B58\u6210\u529F"):U.error(o.message),E("ok",{})})}},f=()=>{e.visible=!1};return D({edit:()=>{e.visible=!0}}),(c,i)=>{const o=m("h-form-item"),v=m("h-form"),a=m("h-drawer");return F(),I(a,{title:"\u8BBE\u7F6E",visible:e.visible,"confirm-loading":e.confirmLoading,onCancel:f},{footer:l(()=>[u("button",{class:"w-24 mb-2 mr-1 btn btn-primary",onClick:b},"\u4FDD\u5B58")]),default:l(()=>[n(v,{layout:"small"},{default:l(()=>[n(o,{label:"\u72B6\u6001",content:"",layout:"small"},{default:l(()=>[u("div",ce,[w(u("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":i[0]||(i[0]=s=>t.status=s)},null,512),[[ae,t.status]])])]),_:1}),n(o,{label:"\u5FAE\u4FE1\u5BA2\u670D",content:"",layout:"small"},{default:l(()=>[w(u("input",{type:"text",class:"form-control","onUpdate:modelValue":i[1]||(i[1]=s=>t.weixin=s),placeholder:""},null,512),[[x,t.weixin]])]),_:1})]),_:1})]),_:1},8,["visible","confirm-loading"])}}}),_e=Y(fe,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/market/miandan/data.vue"]]),pe={class:"input-group"},ge={key:0},be={key:1},ve={key:2},he=u("option",{value:0},"\u9ED8\u8BA4",-1),we=u("option",{value:2},"\u4F18\u8D28\u5546\u54C1",-1),De=u("option",{value:1},"\u4FBF\u5B9C\u5B9E\u7528",-1),Fe=u("option",{value:3},"0\u5143\u9886\u53D6",-1),Ee=u("option",{value:4},"1\u5143\u8D2D\u7269",-1),ke=[he,we,De,Fe,Ee],xe=M({__name:"goods",emits:["ok"],setup(L,{expose:D,emit:E}){const t=y({id:0,href:"",price:0,price_rate:0,commission_rate:0,inventory:0,recommend:0,item_id:"",start_time:"",end_time:""}),k={},e=y({visible:!1,confirmLoading:!1,vip:{ori_price:0,coupon_price:0,buy_base_price:0,price:0,price_rate:0,commission_rate:0,commission:0},data:{href:"",pic_urls:[],wen_items:[]}});ie(()=>{});const g=()=>{e.visible=!1},p=()=>{me({href:t.href}).then(i=>{i.data.goods&&(e.data.wen_items=i.data.goods.wen_items||[],e.data.pic_urls=i.data.goods.pic_urls||[])})};ne(()=>e.data.href,(i,o)=>{p()},{immediate:!0});const _=W(k,H(t)),b=i=>{e.visible=!0,S(()=>{Object.assign(t,{id:0,href:"",price:0,price_rate:0,commission_rate:0,inventory:0,recommend:0,item_id:"",start_time:"",end_time:""});const o=z(i,["id","recommend","inventory","href","item_id","commission_rate","price_rate","price"]);Object.assign(t,o),t.start_time=G(i.start_time),t.end_time=G(i.end_time),d(),p()})},f=i=>{if(e.confirmLoading=!0,_.value.$touch(),_.value.$invalid)_.value.$errors,e.confirmLoading=!1;else{let o=C(t);o.start_time&&(o=Object.assign(o,{start_time:R(o.start_time)})),o.end_time&&(o=Object.assign(o,{end_time:R(o.end_time)})),re(Object.assign(o,{market_code:"vip",submitStatus:i})).then(v=>{v.code===0&&(i===1?U.success("\u63D0\u4EA4\u6210\u529F"):U.success("\u4FDD\u5B58\u6210\u529F"),E("ok",o),e.visible=!1),e.confirmLoading=!1})}},d=()=>{de({href:t.href}).then(i=>{i.data.goods&&(S(()=>{Object.assign(t,z(i.data.goods,["id","href","item_id","start_time","end_time"]))}),e.vip.ori_price=i.data.goods.ori_price,e.vip.coupon_price=i.data.goods.coupon_price,e.vip.buy_base_price=i.data.goods.buy_base_price,e.vip.commission=i.data.goods.commission,e.data.wen_items=i.data.goods.wen_items||[],e.data.pic_urls=i.data.goods.pic_urls||[]),e.confirmLoading=!1})},c=()=>{e.vip.price=t.price,e.vip.price_rate=t.price_rate,e.vip.commission_rate=t.commission_rate};return D({edit:b}),(i,o)=>{const v=m("AlertCircleIcon"),a=m("Alert"),s=m("h-form-item"),V=m("Litepicker"),j=m("h-form"),O=m("h-spin"),P=m("LoadingIcon"),T=m("h-modal");return F(),I(T,{title:"\u53D1\u5E03\u5546\u54C1",size:"modal-xl",visible:e.visible,"confirm-loading":e.confirmLoading,onCancel:g},{footer:l(()=>[u("button",{class:"w-24 mb-2 mr-1 btn btn-primary",onClick:o[8]||(o[8]=r=>f(1))},[N(" \u63D0\u4EA4\u53D1\u5E03 "),e.confirmLoading?(F(),I(P,{key:0,icon:"oval",color:"white",class:"w-4 h-4 ml-2"})):q("v-if",!0)])]),default:l(()=>[n(O,{spinning:e.confirmLoading},{default:l(()=>[n(j,{layout:"small"},{default:l(()=>[n(a,{class:"flex items-center mb-2 alert-outline-primary"},{default:l(()=>[n(v,{class:"w-6 h-6 mr-2"}),N(" \u6CE8\u610F\u63D0\u793A\uFF1A \u6210\u4EA4\u4EF7\u767E\u5206\u6BD4\u4F18\u5148\u4E8E\u4F63\u91D1\u767E\u5206\u6BD4\uFF0C\u4F8B\uFF1A\u8BBE\u7F6E\u4E86\u6210\u4EA4\u767E\u5206\u6BD4\uFF0C\u4F63\u91D1\u6BD4\u4F8B\u5C31\u65E0\u6548\uFF0C\uFF08\u56FA\u5B9A\u8FD4\u5229\u91D1\u989D\u4F18\u5148\u7EA7\u522B\u6700\u9AD8\uFF09 ")]),_:1}),u("div",null,[n(s,{label:"\u5730\u5740",content:"",layout:"small"},{default:l(()=>[u("div",pe,[w(u("input",{type:"text",class:"form-control","onUpdate:modelValue":o[0]||(o[0]=r=>t.href=r)},null,512),[[x,t.href]]),u("div",{class:"input-group-text"},[u("button",{class:"w-24",onClick:d},"\u83B7\u53D6")])])]),_:1}),n(s,{label:"\u8BE6\u60C5",content:"",layout:"small"},{default:l(()=>[u("span",null,"\u539F\u4EF7:"+B(e.vip.ori_price),1),u("span",null,"\u5238\u540E\u4EF7:"+B(e.vip.coupon_price),1),u("span",null,"\u8D2D\u4E70\u6210\u672C\u4EF7:"+B(e.vip.buy_base_price),1),e.vip.price>0?(F(),A("span",ge,"\u7528\u6237\u6700\u7EC8\u4EF7\u683C:"+B((e.vip.coupon_price-e.vip.price).toFixed(2)),1)):e.vip.price_rate>0?(F(),A("span",be,"\u7528\u6237\u6700\u7EC8\u4EF7\u683C:"+B((e.vip.coupon_price*(100-e.vip.price_rate)/100).toFixed(2)),1)):e.vip.commission_rate>0?(F(),A("span",ve,"\u7528\u6237\u6700\u7EC8\u4EF7\u683C:"+B((e.vip.coupon_price-e.vip.commission*e.vip.commission_rate/100).toFixed(2)),1)):q("v-if",!0)]),_:1}),n(s,{label:"\u5F00\u59CB\u65F6\u95F4",content:"",layout:"small"},{default:l(()=>[n(V,{modelValue:t.start_time,"onUpdate:modelValue":o[1]||(o[1]=r=>t.start_time=r),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"block w-56 mx-auto form-control"},null,8,["modelValue"])]),_:1}),n(s,{label:"\u7ED3\u675F\u65F6\u95F4",content:"",layout:"small"},{default:l(()=>[n(V,{modelValue:t.end_time,"onUpdate:modelValue":o[2]||(o[2]=r=>t.end_time=r),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"block w-56 mx-auto form-control"},null,8,["modelValue"])]),_:1}),n(s,{label:"\u5546\u54C1id",content:"",layout:"small"},{default:l(()=>[w(u("input",{type:"text",class:"form-control","onUpdate:modelValue":o[3]||(o[3]=r=>t.item_id=r)},null,512),[[x,t.item_id]])]),_:1}),n(s,{label:"\u4F63\u91D1\u767E\u5206\u6BD4",content:"",layout:"small"},{default:l(()=>[w(u("input",{type:"text",class:"form-control","onUpdate:modelValue":o[4]||(o[4]=r=>t.commission_rate=r),onChange:c},null,544),[[x,t.commission_rate]])]),_:1}),n(s,{label:"\u6210\u4EA4\u4EF7\u767E\u5206\u6BD4",content:"",layout:"small"},{default:l(()=>[w(u("input",{type:"text",class:"form-control","onUpdate:modelValue":o[5]||(o[5]=r=>t.price_rate=r),onChange:c},null,544),[[x,t.price_rate]])]),_:1}),n(s,{label:"\u8FD4\u5229\u56FA\u5B9A\u91D1\u989D",content:"",layout:"small"},{default:l(()=>[w(u("input",{type:"text",class:"form-control","onUpdate:modelValue":o[6]||(o[6]=r=>t.price=r),onChange:c},null,544),[[x,t.price]])]),_:1}),n(s,{label:"\u5546\u54C1\u7C7B\u578B",content:"",layout:"small"},{default:l(()=>[w(u("select",{class:"form-select","onUpdate:modelValue":o[7]||(o[7]=r=>t.recommend=r)},ke,512),[[ue,t.recommend]])]),_:1})])]),_:1})]),_:1},8,["spinning"])]),_:1},8,["visible","confirm-loading"])}}}),ye=Y(xe,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/market/miandan/modal/goods.vue"]]),Be=M({__name:"items",emits:["ok"],setup(L,{expose:D,emit:E}){const t=Z(),k=J(()=>`${t.urlPrefix}${t.apiUrl}${te.getItems}`),e=K({}),g=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"",field:"title",formatter(a){return h(`
          <div class="flex items-center">
            <div class="w-9 h-9 image-fit zoom-in">
              <a target="_blank" href="${a.getData().goods.item_url}">
                <img class="border-white rounded-lg shadow-md" src="${a.getData().goods.pic_url}" />
              </a>
            </div>
            <div class="ml-4">
              <div class="font-medium ">
                ${a.getData().goods.d_title||""}
              </div>
              <div class="text-slate-500 text-xs mt-0.5">
                ${a.getData().goods.title||""}
              </div>
            </div>
          </div>
          `)[0]},download:!0},{title:"\u4EF7\u683C",width:120,field:"price",sorter:!0,formatter(a){return h(`
          <div class="flex flex-col items-start">
            <div class="text-slate-500 text-xs whitespace-nowrap mt-0.5">
              \u5238\u540E\u4EF7:${a.getData().coupon_price}
            </div>
            <div class="text-slate-500 text-xs whitespace-nowrap mt-0.5">
              \u798F\u5229\u91D1:${a.getData().rebate_amount}
            </div>
            <div class="text-slate-500 text-xs whitespace-nowrap mt-0.5">
              \u5230\u624B\u4EF7:${(a.getData().coupon_price-a.getData().rebate_amount).toFixed(2)}
            </div>
          </div>
          `)[0]}},{title:"\u6807\u9898",field:"title",formatter(a){return h(`<a target="_blank" href="${a.getData().item_url}">
          ${a.getData().goods.title}
        </a>`)[0]}},{title:"\u4EF7\u683C",field:"goods.price",width:100},{title:"\u9886\u53D6\u91CF",field:"draws",width:60},{title:"\u5E93\u5B58\u9650\u5236",field:"inventory",width:60},{title:"\u662F\u5426\u8425\u9500\u5E93",field:"marketTypeName",width:60,formatter(a){return a.getData().goods.material_lib_type==="1"?"\u662F":"\u5426"}},{title:"\u56FE\u7247",field:"pic_url",width:100,formatter(a){return h(`<a target="_blank" href="${a.getData().item_url}">
          <img src="${a.getData().goods.pic_url}" />
        </a>`)[0]}},{title:"\u9500\u91CF",field:"goods.volume",width:60},{title:"\u4F63\u91D1\u6BD4\u4F8B",field:"commission_rate",width:60},{title:"\u6210\u4EA4\u4EF7\u6BD4\u4F8B",field:"price_rate",width:60},{title:"\u72B6\u6001",field:"",width:60,formatter(a){return a.getData().status===1?"\u4E0A\u67B6":"\u4E0B\u67B6"}},{title:"\u6D3B\u52A8\u5F00\u59CB\u65F6\u95F4",field:"start_time",width:120,hozAlign:"center"},{title:"\u6D3B\u52A8\u7ED3\u675F\u65F6\u95F4",field:"end_time",width:120,hozAlign:"center"},{title:"\u64CD\u4F5C",field:"",width:120,formatter(a){const s=h(`    <div class="flex items-center lg:justify-center">
                <a class="flex items-center mr-3 action-uponline" href="javascript:;">
                  <i data-lucide="check-square" class="w-4 h-4 mr-1"></i> ${a.getData().status===0?"\u4E0A\u67B6":"\u4E0B\u67B6"}
                </a>
                <a class="flex items-center text-danger action-edit" href="javascript:;">
                  <i data-lucide="trash-2" class="w-4 h-4 mr-1"></i> \u7F16\u8F91
                </a>
                </div>`);return h(s).find(".action-uponline").on("click",function(){a.getData().status===0?c(a.getData(),1):c(a.getData(),0)}),h(s).find(".action-edit").on("click",function(){i(a.getData())}),s[0]}}],p=y({market_code:"miandan",rangePicker:"",name:"",status:0,startTime:"",endTime:""}),_=y({visible:!1,confirmLoading:!1}),b=$(),f=()=>{b.value.reload(!0)},d=$(),c=(a,s)=>{ee({item_id:a.item_id,status:s}).then(()=>{b.value.reload(!0)})},i=a=>{a.item_url&&(a.href=a.item_url),d.value.edit(a)},o=()=>{_.visible=!1,E("ok",{})};return D({show:()=>{_.visible=!0}}),(a,s)=>{const V=m("Litepicker"),j=m("h-form-item"),O=m("h-form"),P=X,T=m("h-drawer");return F(),A(Q,null,[n(T,{title:"\u4E13\u4EAB\u4EA7\u54C1",size:"modal-xl",visible:_.visible,"confirm-loading":_.confirmLoading,onCancel:o},{header:l(()=>[u("button",{class:"mr-2 shadow-md btn btn-primary",onClick:s[0]||(s[0]=r=>d.value.edit({}))},"\u53D1\u5E03 ")]),default:l(()=>[n(P,{ref_key:"tableRef",ref:b,columns:g,ajaxUrl:C(k),config:C(e),queryParam:p},{search:l(()=>[n(O,{layout:"inline"},{default:l(()=>[n(j,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:l(()=>[n(V,{modelValue:p.rangePicker,"onUpdate:modelValue":s[1]||(s[1]=r=>p.rangePicker=r),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"mt-2 form-control sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),u("div",{class:"mt-2 xl:mt-0"},[u("button",{type:"button",class:"w-full btn btn-primary sm:w-16",onClick:f}," \u67E5\u8BE2 ")])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1},8,["visible","confirm-loading"]),n(ye,{ref_key:"modal",ref:d,onOk:f},null,512)],64)}}}),Ce=Y(Be,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/market/miandan/items.vue"]]),Ae=M({__name:"miandan",setup(L){const D=Z(),E=J(()=>`${D.urlPrefix}${D.apiUrl}${te.getList}`),t=K({}),k=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"\u6807\u9898",field:"title",formatter(f){return h(`<a target="_blank" href="${f.getData().item_url}">
          ${f.getData().goods.title}
        </a>`)[0]}},{title:"\u4EF7\u683C",field:"goods.price",width:60},{title:"\u56FE\u7247",field:"pic_url",width:100,formatter(f){return h(`<a target="_blank" href="${f.getData().item_url}">
          <img src="${f.getData().goods.pic_url}" />
        </a>`)[0]}},{title:"\u8FD4\u5229\u6BD4\u4F8B",field:"commission_rate",width:60},{title:"\u6210\u4EA4\u4EF7\u6BD4\u4F8B",field:"price_rate",width:100},{title:"\u8D2D\u4E70\u4EBA",field:"member.user_name",width:100},{title:"\u8BA2\u5355\u53F7",field:"trade_id",width:100},{title:"\u65F6\u95F4",field:"created_at",formatter(f){return se(f.getData().created_at,"YY-MM-DD HH:mm")},width:140}],e=y({market_code:"miandan",rangePicker:"",name:"",status:0,startTime:"",endTime:""}),g=$(),p=()=>{g.value.reload(!0)},_=$(),b=$();return(f,d)=>{const c=m("h-form-item"),i=m("Litepicker"),o=m("h-form"),v=X,a=m("h-card");return F(),A(Q,null,[n(a,{bordered:!1,title:"\u514D\u5355\u6D3B\u52A8"},{header:l(()=>[u("button",{class:"mr-2 shadow-md btn btn-primary",onClick:d[0]||(d[0]=s=>_.value.edit({}))},"\u8BBE\u7F6E "),u("button",{class:"mr-2 shadow-md btn btn-primary",onClick:d[1]||(d[1]=s=>b.value.show({}))},"\u5546\u54C1\u5E93\u7BA1\u7406 ")]),default:l(()=>[n(v,{ref_key:"tableRef",ref:g,columns:k,ajaxUrl:C(E),config:C(t),queryParam:e},{search:l(()=>[n(o,{layout:"inline"},{default:l(()=>[n(c,{label:"\u7528\u6237\u540D",content:"",layout:"inline"},{default:l(()=>[w(u("input",{"onUpdate:modelValue":d[2]||(d[2]=s=>e.name=s),type:"text",class:"mt-2 form-control sm:mt-0 sm:w-40 2xl:w-full"},null,512),[[x,e.name]])]),_:1}),n(c,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:l(()=>[n(i,{modelValue:e.rangePicker,"onUpdate:modelValue":d[3]||(d[3]=s=>e.rangePicker=s),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"mt-2 form-control sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),u("div",{class:"mt-2 xl:mt-0"},[u("button",{type:"button",class:"w-full btn btn-primary sm:w-16",onClick:p}," \u67E5\u8BE2 ")])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1}),n(_e,{ref_key:"dataModal",ref:_,onOk:p},null,512),n(Ce,{ref_key:"itemsModal",ref:b,onOk:p},null,512)],64)}}}),Ye=Y(Ae,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/market/miandan.vue"]]);export{Ye as default};
