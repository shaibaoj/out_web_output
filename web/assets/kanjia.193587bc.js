import{d as L,l as V,o as oe,m as W,t as G,s as H,n as r,b as E,e as S,w as t,h as e,u as o,B,j as c,x as z,F as C,v as $,ad as le,c as j,y as Y,Y as y,g as T,q as M,k as I,f as ue,L as ne,ae as R,ah as q,a7 as J,G as K,a8 as Q,C as A,a as F,a9 as N,ab as X}from"./index.e8171561.js";import{g as se,u as ie,b as re,c as Z}from"./market.47621573.js";import{p as ee}from"./pick.68155b67.js";const me=T("option",{value:0},"\u4F63\u91D1\u5956\u52B1",-1),de=T("option",{value:1},"\u514D\u5355\u6A21\u5F0F",-1),ce=L({__name:"data",emits:["ok"],setup(O,{expose:k,emit:x}){const a=V({weixin:"",mode:0,members:0,commission_rate:0,money1:0,money2:0,status:!1}),h={},i=V({visible:!1,confirmLoading:!1});oe(()=>{_()});const w=W(h,G(a)),_=()=>{b()},b=()=>{se({market_code:"kanjia"}).then(p=>{p.data.item&&H(()=>{const s=ee(p.data.item,["weixin","mode","members","commission_rate","money1","money2"]);Object.assign(a,s),s.status=p.data.item.status===1})})},D=p=>{if(p.preventDefault(),w.value.$touch(),w.value.$invalid)w.value.$errors;else{const s=o(a);ie(Object.assign(s,{market_code:"kanjia",status:a.status?1:0})).then(d=>{const{code:l}=d||{};l===0?(M.success("\u4FDD\u5B58\u6210\u529F"),x("ok",{})):M.error(d.message)})}},u=()=>{i.visible=!1};return k({edit:()=>{i.visible=!0}}),(p,s)=>{const d=r("h-form-item"),l=r("h-form"),f=r("h-drawer");return E(),S(f,{title:"\u8BBE\u7F6E",visible:i.visible,"confirm-loading":i.confirmLoading,onCancel:u},{footer:t(()=>[e(o(B),{variant:"primary",class:"w-24 mb-2 mr-1",onClick:D},{default:t(()=>[c("\u4FDD\u5B58")]),_:1})]),default:t(()=>[e(l,{layout:"small"},{default:t(()=>[e(d,{label:"\u5168\u573A\u6D3B\u52A8",content:"",layout:"small"},{default:t(()=>[e(o(z),null,{default:t(()=>[e(o(z).Input,{type:"checkbox",modelValue:a.status,"onUpdate:modelValue":s[0]||(s[0]=m=>a.status=m)},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{label:"\u5BA2\u670D\u5FAE\u4FE1",content:"",layout:"small"},{default:t(()=>[e(o(C),{type:"text",modelValue:a.weixin,"onUpdate:modelValue":s[1]||(s[1]=m=>a.weixin=m)},null,8,["modelValue"]),e(o($),null,{default:t(()=>[c("\u65B9\u4FBF\u7528\u6237\u8054\u7CFB\u7684\u5FAE\u4FE1\u5BA2\u670D\u5E10\u53F7")]),_:1})]),_:1}),e(d,{label:"\u780D\u4EF7\u6A21\u5F0F",content:"",layout:"small"},{default:t(()=>[e(o(le),{modelValue:a.mode,"onUpdate:modelValue":s[2]||(s[2]=m=>a.mode=m)},{default:t(()=>[me,de]),_:1},8,["modelValue"])]),_:1}),a.mode==0?(E(),j(Y,{key:0},[e(d,{label:"\u780D\u4EF7\u4EBA\u6570",content:"",layout:"small"},{default:t(()=>[e(o(y),null,{default:t(()=>[e(o(C),{type:"text",modelValue:a.members,"onUpdate:modelValue":s[3]||(s[3]=m=>a.members=m)},null,8,["modelValue"]),e(o(y).Text,null,{default:t(()=>[c("\u4EBA")]),_:1})]),_:1}),e(o($),null,{default:t(()=>[c("\u6BCF\u4E2A\u5546\u54C1\u9700\u8981\u780D\u4EF7\u4EBA\u6570")]),_:1})]),_:1}),e(d,{label:"\u780D\u4E00\u6B21\u91D1\u989D",content:"",layout:"small"},{default:t(()=>[e(o(y),null,{default:t(()=>[e(o(C),{type:"text",modelValue:a.commission_rate,"onUpdate:modelValue":s[4]||(s[4]=m=>a.commission_rate=m)},null,8,["modelValue"]),e(o(y).Text,null,{default:t(()=>[c("%")]),_:1})]),_:1}),e(o($),null,{default:t(()=>[c("\u6BCF\u780D\u4E00\u6B21\u780D\u6389\u7684\u4F63\u91D1\u767E\u5206\u6BD4")]),_:1})]),_:1})],64)):(E(),j(Y,{key:1},[e(d,{label:"\u6700\u5C0F\u91D1\u989D",content:"",layout:"small"},{default:t(()=>[e(o(y),null,{default:t(()=>[e(o(C),{type:"text",modelValue:a.money1,"onUpdate:modelValue":s[5]||(s[5]=m=>a.money1=m)},null,8,["modelValue"]),e(o(y).Text,null,{default:t(()=>[c("\u5143")]),_:1})]),_:1}),e(o($),null,{default:t(()=>[c("\u6BCF\u780D\u4E00\u6B21\u780D\u6389\u7684\u6700\u5C0F\u91D1\u989D")]),_:1})]),_:1}),e(d,{label:"\u6700\u5927\u91D1\u989D",content:"",layout:"small"},{default:t(()=>[e(o(y),null,{default:t(()=>[e(o(C),{type:"text",modelValue:a.money2,"onUpdate:modelValue":s[6]||(s[6]=m=>a.money2=m)},null,8,["modelValue"]),e(o(y).Text,null,{default:t(()=>[c("\u5143")]),_:1})]),_:1}),e(o($),null,{default:t(()=>[c("\u6BCF\u780D\u4E00\u6B21\u780D\u6389\u7684\u6700\u5927\u91D1\u989D")]),_:1})]),_:1})],64))]),_:1})]),_:1},8,["visible","confirm-loading"])}}}),fe=I(ce,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/market/kanjia/data.vue"]]),_e=L({__name:"kanjia",emits:["ok"],setup(O,{expose:k,emit:x}){const a=V({item_id:"",commission_rate:0,members:0,start_time:"",end_time:""}),h={},i=V({visible:!1,confirmLoading:!1}),w=()=>{i.visible=!1},_=W(h,G(a)),b=u=>{i.visible=!0,H(()=>{const n=ee(u,["item_id","commission_rate","members"]);Object.assign(a,n),a.start_time=R(u.start_time),a.end_time=R(u.end_time)})},D=()=>{if(i.confirmLoading=!0,_.value.$touch(),_.value.$invalid)_.value.$errors,i.confirmLoading=!1;else{let u=o(a);u.start_time&&(u=Object.assign(u,{start_time:q(u.start_time)})),u.end_time&&(u=Object.assign(u,{end_time:q(u.end_time)})),re(Object.assign(u,{market_code:"kanjia"})).then(n=>{const{code:p}=n||{};p===0?M.success("\u4FDD\u5B58\u6210\u529F"):M.error(n.message),i.confirmLoading=!1,x("ok",u),i.visible=!1})}};return k({edit:b}),(u,n)=>{const p=r("Alert"),s=r("FormInput"),d=r("h-form-item"),l=r("Litepicker"),f=r("h-form"),m=r("h-spin"),v=r("LoadingIcon"),P=r("h-modal");return E(),S(P,{title:"\u53D1\u5E03\u5546\u54C1",size:"lg",visible:i.visible,"confirm-loading":i.confirmLoading,onCancel:w},{footer:t(()=>[e(o(B),{variant:"primary",class:"mb-2 mr-1 w-24",onClick:n[5]||(n[5]=g=>D())},{default:t(()=>[c(" \u63D0\u4EA4\u53D1\u5E03 "),i.confirmLoading?(E(),S(v,{key:0,icon:"oval",color:"white",class:"ml-2 h-4 w-4"})):ue("v-if",!0)]),_:1})]),default:t(()=>[e(m,{spinning:i.confirmLoading},{default:t(()=>[e(f,{layout:"small"},{default:t(()=>[e(p,{class:"alert-outline-primary mb-2 flex items-center"},{default:t(()=>[e(o(ne),{icon:"AlertCircle",class:"mr-2 h-6 w-6"}),c(" \u6CE8\u610F\u63D0\u793A\uFF1A \u7528\u6237\u83B7\u53D6\u7684\u603B\u780D\u4EF7=\u4F63\u91D1*\u5355\u6B21\u780D\u4EF7\u4F63\u91D1\u6BD4\u4F8B*\u780D\u4EF7\u6B21\u6570 ")]),_:1}),e(d,{label:"\u5546\u54C1id",content:"",layout:"small"},{default:t(()=>[e(s,{type:"text",modelValue:a.item_id,"onUpdate:modelValue":n[0]||(n[0]=g=>a.item_id=g)},null,8,["modelValue"])]),_:1}),e(d,{label:"\u5355\u6B21\u780D\u4EF7\u4F63\u91D1\u6BD4\u4F8B",content:"",layout:"small"},{default:t(()=>[e(s,{type:"text",modelValue:a.commission_rate,"onUpdate:modelValue":n[1]||(n[1]=g=>a.commission_rate=g)},null,8,["modelValue"])]),_:1}),e(d,{label:"\u780D\u4EF7\u4EBA\u6570",content:"",layout:"small"},{default:t(()=>[e(s,{type:"text",modelValue:a.members,"onUpdate:modelValue":n[2]||(n[2]=g=>a.members=g)},null,8,["modelValue"])]),_:1}),e(d,{label:"\u5F00\u59CB\u65F6\u95F4",content:"",layout:"small"},{default:t(()=>[e(l,{modelValue:a.start_time,"onUpdate:modelValue":n[3]||(n[3]=g=>a.start_time=g),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"mx-auto block w-56"},null,8,["modelValue"])]),_:1}),e(d,{label:"\u7ED3\u675F\u65F6\u95F4",content:"",layout:"small"},{default:t(()=>[e(l,{modelValue:a.end_time,"onUpdate:modelValue":n[4]||(n[4]=g=>a.end_time=g),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"mx-auto block w-56"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["spinning"])]),_:1},8,["visible","confirm-loading"])}}}),pe=I(_e,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/market/kanjia/modal/kanjia.vue"]]),ge={class:"mt-2 xl:mt-0"},be=L({__name:"items",emits:["ok"],setup(O,{expose:k,emit:x}){const a=J(),h=K(()=>`${a.urlPrefix}${a.apiUrl}${Z.getItems}`),i=Q({}),w=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"",field:"title",formatter(l){return F(`
          <div class="flex items-center">
            <div class="w-9 h-9 image-fit zoom-in">
              <a target="_blank" href="${l.getData().goods.item_url}">
                <img class="border-white rounded-lg shadow-md" src="${l.getData().goods.pic_url||""}" />
              </a>
            </div>
            <div class="ml-4">
              <div class="font-medium ">
                ${l.getData().d_title||""}
              </div>
              <div class="text-slate-500 text-xs mt-0.5">
                ${l.getData().title||""}
              </div>
            </div>
          </div>
          `)[0]},download:!0},{title:"\u4EF7\u683C",width:120,field:"price",sorter:!0,formatter(l){return F(`
          <div class="flex flex-col items-start">
            <div class="text-slate-500 text-xs whitespace-nowrap mt-0.5">
              \u5238\u540E\u4EF7:${l.getData().coupon_price}
            </div>
            <div class="text-slate-500 text-xs whitespace-nowrap mt-0.5">
              \u798F\u5229\u91D1:${l.getData().rebate_amount}
            </div>
            <div class="text-slate-500 text-xs whitespace-nowrap mt-0.5">
              \u5230\u624B\u4EF7:${(l.getData().coupon_price-l.getData().rebate_amount).toFixed(2)}
            </div>
          </div>
          `)[0]}},{title:"\u6807\u9898",field:"goods.title",formatter(l){return F(`<a target="_blank" href="${l.getData().goods.item_url}">
          ${l.getData().goods.title}
        </a>`)[0]}},{title:"\u4EF7\u683C",field:"goods.price",width:50},{title:"\u56FE\u7247",field:"pic_url",width:100,formatter(l){return F(`<a target="_blank" href="${l.getData().item_url}">
          <img src="${l.getData().goods.pic_url}" />
        </a>`)[0]}},{title:"\u9500\u91CF",field:"goods.volume",width:50},{title:"\u780D\u4EF7\u4EBA\u6570",field:"members",width:80},{title:"\u65F6\u95F4",field:"",width:140,formatter(l){return F(`<p>${N(l.getData().start_time)}</p>
        <p>${N(l.getData().end_time)}</p>`)[0]}},{title:"\u64CD\u4F5C",field:"action",width:120,formatter(l){const f=F('<a class="flex items-center" href="javascript:;">\u7F16\u8F91</a>');return F(f).on("click",function(m){p(l.getData())}),f[0]}}],_=V({market_code:"kanjia",rangePicker:"",name:"",status:0,startTime:"",endTime:""}),b=V({visible:!1,confirmLoading:!1}),D=A(),u=A(),n=()=>{D.value.reload(!0)},p=l=>{u.value.edit(l)},s=()=>{b.visible=!1,x("ok",{})};return k({show:()=>{b.visible=!0}}),(l,f)=>{const m=r("FormInput"),v=r("h-form-item"),P=r("Litepicker"),g=r("h-form"),te=X,ae=r("h-drawer");return E(),j(Y,null,[e(ae,{title:"\u4E13\u4EAB\u4EA7\u54C1",size:"xl",visible:b.visible,"confirm-loading":b.confirmLoading,onCancel:s},{header:t(()=>[e(o(B),{variant:"primary",class:"mr-2 shadow-md",onClick:f[0]||(f[0]=U=>u.value.edit({}))},{default:t(()=>[c("\u53D1\u5E03\u780D\u4EF7\u5546\u54C1 ")]),_:1})]),default:t(()=>[e(te,{ref_key:"tableRef",ref:D,columns:w,ajaxUrl:o(h),config:o(i),queryParam:_},{search:t(()=>[e(g,{layout:"inline"},{default:t(()=>[e(v,{label:"\u7528\u6237\u540D",content:"",layout:"inline"},{default:t(()=>[e(m,{type:"text",modelValue:_.name,"onUpdate:modelValue":f[1]||(f[1]=U=>_.name=U),class:"mt-2 sm:mt-0 sm:w-40 2xl:w-full"},null,8,["modelValue"])]),_:1}),e(v,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:t(()=>[e(P,{modelValue:_.rangePicker,"onUpdate:modelValue":f[2]||(f[2]=U=>_.rangePicker=U),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"mt-2 sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),T("div",ge,[e(o(B),{variant:"primary",type:"button",class:"w-full sm:w-16",onClick:n},{default:t(()=>[c(" \u67E5\u8BE2 ")]),_:1})])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1},8,["visible","confirm-loading"]),e(pe,{ref_key:"modal",ref:u,onOk:n},null,512)],64)}}}),we=I(be,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/market/kanjia/items.vue"]]),De={class:"mt-2 xl:mt-0"},ve=L({__name:"kanjia",setup(O){const k=J(),x=K(()=>`${k.urlPrefix}${k.apiUrl}${Z.shares}`),a=Q({}),h=[{formatter:"responsiveCollapse",width:40,minWidth:30,hozAlign:"center",resizable:!0,headerSort:!1},{title:"\u6807\u9898",field:"goods.title",formatter(u){return F(`<a target="_blank" href="${u.getData().goods.item_url}">
          ${u.getData().goods.title}
        </a>`)[0]}},{title:"\u4EF7\u683C",field:"goods.price",width:100},{title:"\u56FE\u7247",field:"pic_url",width:100,formatter(u){return F(`<a target="_blank" href="${u.getData().item_url}">
          <img src="${u.getData().goods.pic_url}" />
        </a>`)[0]}},{title:"\u5206\u4EAB\u4EBA",field:"member.nick_name",width:100},{title:"\u53C2\u4E0E\u4EBA\u6B21",field:"invites",width:100},{title:"\u65F6\u95F4",field:"created_at",formatter(u){return N(u.getData().created_at,"YY-MM-DD HH:mm")},width:140}],i=V({market_code:"kanjia",rangePicker:"",name:"",status:0,startTime:"",endTime:""}),w=A(),_=A(),b=A(),D=()=>{w.value.reload(!0)};return(u,n)=>{const p=r("FormInput"),s=r("h-form-item"),d=r("Litepicker"),l=r("h-form"),f=X,m=r("h-card");return E(),j(Y,null,[e(m,{bordered:!1,title:"\u4E13\u9898"},{header:t(()=>[e(o(B),{variant:"primary",class:"mr-2 shadow-md",onClick:n[0]||(n[0]=v=>b.value.show({}))},{default:t(()=>[c("\u63A8\u8350\u4EA7\u54C1 ")]),_:1}),e(o(B),{variant:"primary",class:"mr-2 shadow-md",onClick:n[1]||(n[1]=v=>_.value.edit({}))},{default:t(()=>[c("\u8BBE\u7F6E ")]),_:1})]),default:t(()=>[e(f,{ref_key:"tableRef",ref:w,columns:h,ajaxUrl:o(x),config:o(a),queryParam:i},{search:t(()=>[e(l,{layout:"inline"},{default:t(()=>[e(s,{label:"\u7528\u6237\u540D",content:"",layout:"inline"},{default:t(()=>[e(p,{type:"text",modelValue:i.name,"onUpdate:modelValue":n[2]||(n[2]=v=>i.name=v),class:"mt-2 sm:mt-0 sm:w-40 2xl:w-full"},null,8,["modelValue"])]),_:1}),e(s,{label:"\u521B\u5EFA\u65F6\u95F4",content:"",layout:"inline"},{default:t(()=>[e(d,{modelValue:i.rangePicker,"onUpdate:modelValue":n[3]||(n[3]=v=>i.rangePicker=v),options:{autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"mt-2 sm:mt-0 sm:w-56 2xl:w-full"},null,8,["modelValue"])]),_:1}),T("div",De,[e(o(B),{variant:"primary",type:"button",class:"w-full sm:w-16",onClick:D},{default:t(()=>[c(" \u67E5\u8BE2 ")]),_:1})])]),_:1})]),_:1},8,["ajaxUrl","config","queryParam"])]),_:1}),e(fe,{ref_key:"dataModal",ref:_,onOk:D},null,512),e(we,{ref_key:"itemsModal",ref:b,onOk:D},null,512)],64)}}}),xe=I(ve,[["__file","/Users/wu./Documents/os/web/www/web/src/views/user/market/kanjia.vue"]]);export{xe as default};
